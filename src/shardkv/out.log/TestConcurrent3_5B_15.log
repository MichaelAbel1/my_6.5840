Test (5B): concurrent configuration change and restart...
2025/01/07 12:55:49 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:49 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:49 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1527280109206775440: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=0)
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[100:[server-100-0 server-100-1 server-100-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[100:[server-100-0 server-100-1 server-100-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):2
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 0, OpType:Join applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[100:[server-100-0 server-100-1 server-100-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[100:[server-100-0 server-100-1 server-100-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):2
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[100:[server-100-0 server-100-1 server-100-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[100:[server-100-0 server-100-1 server-100-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):2
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S100-2 CN: 0 is reconfiguring to config (RCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:50 ShardKV.installConfig: S100-1 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S100-1 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S100-2 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S100-2 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S100-0 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S100-0 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1527280109206775440: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 0, value: C, client ID: 1573153705190402160, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 0 Put 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 0, value: C, client ID: 1573153705190402160, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 0, value: C, client ID: 1573153705190402160, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 0 Put 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 0 Put 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 0 Put 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 0, value: C, client ID: 1573153705190402160, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 1, value: j, client ID: 1573153705190402160, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 1 Put 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 1, value: j, client ID: 1573153705190402160, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 1, value: j, client ID: 1573153705190402160, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 1 Put 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S101-1 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S101-1 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S101-1 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 0 Put 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S101-2 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S101-2 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S101-2 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S101-0 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S101-0 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S101-0 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S102-2 CN: 0 is reconfiguring to config (RCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 1 Put 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 1, value: j, client ID: 1573153705190402160, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 2, value: H, client ID: 1573153705190402160, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 2 Put 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 2, value: H, client ID: 1573153705190402160, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 2, value: H, client ID: 1573153705190402160, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 2 Put 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 1 Put 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 1 Put 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 0 , RCN: 1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 0 , RCN: 1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S102-0 CN: 0 is reconfiguring to config (RCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S102-1 CN: 0 is reconfiguring to config (RCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 2 Put 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 2, value: H, client ID: 1573153705190402160, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 3, value: l, client ID: 1573153705190402160, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 3 Put 3 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 3, value: l, client ID: 1573153705190402160, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 3, value: l, client ID: 1573153705190402160, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 3 Put 3 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 2 Put 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 2 Put 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 3 Put 3 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 3, value: l, client ID: 1573153705190402160, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 4, value: f, client ID: 1573153705190402160, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 4 Put 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 4, value: f, client ID: 1573153705190402160, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 4, value: f, client ID: 1573153705190402160, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 4 Put 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 3 Put 3 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 3 Put 3 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 4 Put 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 4, value: f, client ID: 1573153705190402160, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 5, value: i, client ID: 1573153705190402160, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 5 Put 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 5, value: i, client ID: 1573153705190402160, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 5, value: i, client ID: 1573153705190402160, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 5 Put 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 4 Put 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 4 Put 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 5 Put 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 5, value: i, client ID: 1573153705190402160, sequence num: 5, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 6, value: 4, client ID: 1573153705190402160, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 6 Put 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 6, value: 4, client ID: 1573153705190402160, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 6, value: 4, client ID: 1573153705190402160, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 6 Put 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 0 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 MemoryConfigStateMachine.Query: len(cf.Configs):2
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 5 Put 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S102-0 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S102-0 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S102-0 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 5 Put 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S102-1 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S102-1 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S102-1 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.installConfig: S102-2 reconfigure done (CN=1)
2025/01/07 12:55:50 ShardKV.maybeApplyAdminOp: S102-2 installed config (OCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S102-2 applies admin opType:InstallConfig, opConfig:{Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:1,Shards:[100 100 100 100 100 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2]]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 6 Put 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 6, value: 4, client ID: 1573153705190402160, sequence num: 6, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 7, value: r, client ID: 1573153705190402160, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 7 Put 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 7, value: r, client ID: 1573153705190402160, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 6 Put 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 6 Put 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 7, value: r, client ID: 1573153705190402160, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 7 Put 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 7 Put 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 7, value: r, client ID: 1573153705190402160, sequence num: 7, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 8, value: r, client ID: 1573153705190402160, sequence num: 8
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 8 Put 8 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 8, value: r, client ID: 1573153705190402160, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 8, value: r, client ID: 1573153705190402160, sequence num: 8
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 8 Put 8 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 7 Put 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 7 Put 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 8 Put 8 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 8 Put 8 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 8, value: r, client ID: 1573153705190402160, sequence num: 8, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put request: key: 9, value: i, client ID: 1573153705190402160, sequence num: 9
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1573153705190402160 9 Put 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Put reply: key: 9, value: i, client ID: 1573153705190402160, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put request: key: 9, value: i, client ID: 1573153705190402160, sequence num: 9
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1573153705190402160 9 Put 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 8 Put 8 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1573153705190402160 9 Put 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Put reply: key: 9, value: i, client ID: 1573153705190402160, sequence num: 9, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1573153705190402160 9 Put 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1573153705190402160 9 Put 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 709616447909096656: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: D, client ID: 2199136536800998598, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 0 Append 0 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: D, client ID: 2199136536800998598, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: D, client ID: 2199136536800998598, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 0 Append 0 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 0 Append 0 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 0 Append 0 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 0 Append 0 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: D, client ID: 2199136536800998598, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 1 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 1 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: H, client ID: 3507021557023121440, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 0 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: H, client ID: 3507021557023121440, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: H, client ID: 3507021557023121440, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 0 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 1 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 0 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: H, client ID: 3507021557023121440, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 1 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 1 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 0 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 0 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: G, client ID: 2199136536800998598, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 2 Append 0 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: G, client ID: 2199136536800998598, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: G, client ID: 2199136536800998598, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 2 Append 0 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 1 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 1 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 0 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 0 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 2 Append 0 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 1 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: j, client ID: 3507021557023121440, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 2 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: j, client ID: 3507021557023121440, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: G, client ID: 2199136536800998598, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 3 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 2 Append 0 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 1 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 3 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 2 Append 0 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 1 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 0 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 0 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: j, client ID: 3507021557023121440, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 2 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 0 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: j, client ID: 3106988376836154902, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 1 Append 2 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: j, client ID: 3106988376836154902, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: j, client ID: 3106988376836154902, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 1 Append 2 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: e, client ID: 3929044425438857535, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 0 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: e, client ID: 3929044425438857535, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: e, client ID: 3929044425438857535, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 0 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 3 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 2 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: j, client ID: 3507021557023121440, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 3 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 3 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 3 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 2 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 3 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 2 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 1 Append 2 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 0 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 1 Append 2 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 0 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: e, client ID: 3929044425438857535, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: j, client ID: 3106988376836154902, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 1 Append 2 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: q, client ID: 2199136536800998598, sequence num: 4
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 1
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: _, client ID: 3106988376836154902, sequence num: 2
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 0 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 4 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: q, client ID: 2199136536800998598, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 0 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 1 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 0 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 2 Append 2 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: _, client ID: 3106988376836154902, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 1 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: _, client ID: 3106988376836154902, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 2 Append 2 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: q, client ID: 2199136536800998598, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 4 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 3 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 0 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: t, client ID: 3507021557023121440, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 4 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: t, client ID: 3507021557023121440, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 3 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 0 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 1 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 2 Append 2 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 4 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 1 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 3 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 0 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 1 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 2 Append 2 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 2 Append 2 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 1
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 129717324913002534: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 1 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 4 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: _, client ID: 3106988376836154902, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: t, client ID: 3507021557023121440, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 4 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 3 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 1 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 3 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 0
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 4 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 0 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 2 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: q, client ID: 2199136536800998598, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 0 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 2 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 5 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 5 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 4 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 1 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 2 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 4 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 2 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: t, client ID: 3507021557023121440, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 4 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 1 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 5
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 3 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 1 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1769720748839593670 0 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 3 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1769720748839593670 0 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 2 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 2 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 5 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 3 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1769720748839593670 0 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 2 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 5 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 5 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 5, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 5 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 4 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 6 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 1 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 6 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 1 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 4 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 5 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: W, client ID: 3929044425438857535, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 3 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: W, client ID: 3929044425438857535, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: W, client ID: 3929044425438857535, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 3 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 0 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 0 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 2 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 6 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 6, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 2 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 7 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 6 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 7 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: x, client ID: 4217985405542925169, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 3 Append 4 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: x, client ID: 4217985405542925169, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: x, client ID: 4217985405542925169, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 3 Append 4 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 2 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1769720748839593670 1 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 6 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1769720748839593670 1 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 4 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1769720748839593670 1 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 4 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 4 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 5 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 5 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 3 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1347532576216071615 0 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 5, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 3 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 5 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 3 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1347532576216071615 0 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: W, client ID: 3929044425438857535, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1347532576216071615 0 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 4 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 4 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 2 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 6, value: -, client ID: 1347532576216071615, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 1 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 6, value: -, client ID: 1347532576216071615, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 2 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 6 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 7, value: r, client ID: 3166596512325037039, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 0 Append 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 7, value: r, client ID: 3166596512325037039, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: e, client ID: 3106988376836154902, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 5 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: e, client ID: 3106988376836154902, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 6, value: -, client ID: 1347532576216071615, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 1 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 6 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 7, value: r, client ID: 3166596512325037039, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 0 Append 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: e, client ID: 3106988376836154902, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 5 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 7 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 3 Append 4 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: x, client ID: 4217985405542925169, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 7, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 7 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 3 Append 4 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 8
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 8 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 4 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 8
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 8 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 4
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 4 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 7 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 4 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 3 Append 4 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1769720748839593670 2 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 4 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1769720748839593670 2 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1347532576216071615 1 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1347532576216071615 1 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 6 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 6 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 0 Append 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 0 Append 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 5 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 4 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 309167909479931851: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 188446263330064059: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 851717987639597555: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 5 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1769720748839593670 2 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1347532576216071615 1 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 6 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 6, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 6, value: -, client ID: 1347532576216071615, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 0 Append 7 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 5 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: e, client ID: 3106988376836154902, sequence num: 5, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 7, value: r, client ID: 3166596512325037039, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S102-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 8, value: E, client ID: 1418637628418551783, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 0 Append 8 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 8, value: E, client ID: 1418637628418551783, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 3 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 8, value: E, client ID: 1418637628418551783, sequence num: 0
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 0 Append 8 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 3
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 3 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 6, value: N, client ID: 1347532576216071615, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 2 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 6, value: N, client ID: 1347532576216071615, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 7, value: h, client ID: 3166596512325037039, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 1 Append 7 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 7, value: h, client ID: 3166596512325037039, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: z, client ID: 3106988376836154902, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 6 Append 2 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: z, client ID: 3106988376836154902, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 6, value: N, client ID: 1347532576216071615, sequence num: 2
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 2 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 7, value: h, client ID: 3166596512325037039, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 1 Append 7 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 2, value: z, client ID: 3106988376836154902, sequence num: 6
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 6 Append 2 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 8 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: S, client ID: 3929044425438857535, sequence num: 5
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 8 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 4 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 0 Append 8 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 5 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: S, client ID: 3929044425438857535, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 4 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 0 Append 8 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 7 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 8, value: E, client ID: 1418637628418551783, sequence num: 0, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 8, value: O, client ID: 1418637628418551783, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 1 Append 8 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 8, value: O, client ID: 1418637628418551783, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 8 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 4 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 8, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 0 Append 8 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 9
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 9 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 7
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 7 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 9
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 9 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 3, value: S, client ID: 3929044425438857535, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 5 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 4, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 8, value: O, client ID: 1418637628418551783, sequence num: 1
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 1 Append 8 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: U, client ID: 4217985405542925169, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 5 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 4, value: U, client ID: 4217985405542925169, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 4, value: U, client ID: 4217985405542925169, sequence num: 5
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 5 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1769720748839593670 3 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1769720748839593670 3 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1347532576216071615 2 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1347532576216071615 2 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 1 Append 7 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 6, value: N, client ID: 1347532576216071615, sequence num: 2, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3106988376836154902 6 Append 2 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1769720748839593670 3 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{1347532576216071615 2 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 3, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 1 Append 7 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.ticker(): S102-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3106988376836154902 6 Append 2 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 2, value: z, client ID: 3106988376836154902, sequence num: 6, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 7, value: h, client ID: 3166596512325037039, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 567745738604484317: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:50 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=1)
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):3
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 1, OpType:Join applied !!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):3
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 7 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 9 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 9, err: OK
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:50 MemoryConfigStateMachine.Join: len(cf.Configs):3
2025/01/07 12:55:50 *****************************************
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 7, err: OK
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{3929044425438857535 5 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 7, value: f, client ID: 3166596512325037039, sequence num: 2
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 0
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 10
2025/01/07 12:55:50 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 10 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 1 Append 8 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 7 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 8, value: O, client ID: 1418637628418551783, sequence num: 1, err: OK
2025/01/07 12:55:50 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 10, err: ErrWrongLeader
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 9 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 1 Append 7 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-0 applies client op: &{3106988376836154902 6 Append 2 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{3929044425438857535 5 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 1 Append 8 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.engineStart(): S100-2 applies client op: &{4217985405542925169 5 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:50 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:50 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:50 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 7 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 9 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 4 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 8
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 8, value: f, client ID: 1418637628418551783, sequence num: 2
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 7 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 2 Append 7 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 0 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 3 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3929044425438857535 5 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 3, value: S, client ID: 3929044425438857535, sequence num: 5, err: OK
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: len(cf.Configs):4
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 2, OpType:Join applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 1 Append 8 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{4217985405542925169 5 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: len(cf.Configs):4
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:51 MemoryConfigStateMachine.Join: len(cf.Configs):4
2025/01/07 12:55:51 *****************************************
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:1 Append reply: key: 4, value: U, client ID: 4217985405542925169, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:1 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 10 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 CN: 1 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 10 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S100-1 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-1 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 10 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S100-2 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-2 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{4217985405542925169 5 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 7, value: f, client ID: 3166596512325037039, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 8 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 2 Append 8 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 0, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 1 , RCN: -1 is going to reconfigure to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=2)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 6
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append request: key: 0, value: K, client ID: 2199136536800998598, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 11 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 0, value: K, client ID: 2199136536800998598, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: K, client ID: 2199136536800998598, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 11 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 0
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 0 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-1 SN:4 CN:2 rejects Op due to state=MovingOut (C=1347532576216071615 Id=3) MovingIn: from group: 0, MovingOut: to group 102
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-1 SN:0 CN:2 rejects Op due to state=MovingOut (C=3106988376836154902 Id=7) MovingIn: from group: 0, MovingOut: to group 102
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 10 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 6 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:1 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.installConfig: S100-0 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-0 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: f, client ID: 1418637628418551783, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:2 CN:2 rejects Op due to state=MovingOut (C=4217985405542925169 Id=6) MovingIn: from group: 0, MovingOut: to group 102
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 6, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-1 SN:3 CN:2 rejects Op due to state=MovingOut (C=1769720748839593670 Id=4) MovingIn: from group: 0, MovingOut: to group 102
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: f, client ID: 3166596512325037039, sequence num: 2
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-1 SN:1 CN:2 rejects Op due to state=MovingOut (C=3929044425438857535 Id=6) MovingIn: from group: 0, MovingOut: to group 102
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 2 Append 7 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-0 reconfigure done (CN=2)
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-0 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-0 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-2 reconfigure done (CN=2)
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-2 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-2 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-1 reconfigure done (CN=2)
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-1 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-1 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: f, client ID: 1418637628418551783, sequence num: 2
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 2 Append 8 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 8 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 CN: 1 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.installConfig: S102-0 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-0 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S102-1 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-1 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 11 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 0 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 11 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 0 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 2 Append 7 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 2 Append 8 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 8 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 11 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 0 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 2 Append 7 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 2 Append 8 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 8 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 2 Append 7 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: f, client ID: 3166596512325037039, sequence num: 2, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: G, client ID: 3166596512325037039, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 3 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: G, client ID: 3166596512325037039, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: G, client ID: 3166596512325037039, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 3 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: K, client ID: 2199136536800998598, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 12 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 12 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 2 Append 8 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 8 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 9 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 9 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 0, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 1
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 1 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 1, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 1
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 1 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: f, client ID: 1418637628418551783, sequence num: 2, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: -, client ID: 1418637628418551783, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 3 Append 8 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: -, client ID: 1418637628418551783, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: -, client ID: 1418637628418551783, sequence num: 3
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:2 RCN:2 need receive shard (SN=0) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:2 RCN:2 need receive shard (SN=1) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:2 RCN:2 need receive shard (SN=2) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:2 RCN:2 need receive shard (SN=3) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:2 RCN:2 need receive shard (SN=4) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 3 Append 8 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:55:51 ShardKV.migrator() S102-1 CN:2 RCN:2 need receive shard (SN=0) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-1 CN:2 RCN:2 need receive shard (SN=1) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-1 CN:2 RCN:2 need receive shard (SN=2) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-1 CN:2 RCN:2 need receive shard (SN=3) from G100
2025/01/07 12:55:51 ShardKV.migrator() S102-1 CN:2 RCN:2 need receive shard (SN=4) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 3 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 12 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 3 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 12 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 9 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 1 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:51 ShardKV.installConfig: S102-2 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-2 installed config (OCN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 3 Append 8 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallConfig, opConfig:{Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:2,Shards:[102 102 102 102 102 100 100 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: G, client ID: 3166596512325037039, sequence num: 3, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 9 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 1 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 1, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 2
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 2 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 2, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 2
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 2 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 10 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 10, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 10 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 3 Append 8 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: -, client ID: 1418637628418551783, sequence num: 3, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: x, client ID: 1418637628418551783, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 4 Append 8 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: x, client ID: 1418637628418551783, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: x, client ID: 1418637628418551783, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 4 Append 8 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: Z, client ID: 3166596512325037039, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 4 Append 7 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: Z, client ID: 3166596512325037039, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 3 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 12 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 13 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 9 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 1 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 3 Append 8 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: Z, client ID: 3166596512325037039, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 4 Append 7 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 13 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 2 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 2 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 10 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 4 Append 8 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 4 Append 7 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 13 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 10 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 2, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 3 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 3, err: ErrWrongLeader
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 11 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 4 Append 8 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 4 Append 7 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: x, client ID: 1418637628418551783, sequence num: 4, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 2 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 10 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 4 Append 8 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 4 Append 7 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 13 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 11 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 13 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 14 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 3
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 3 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 14 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: Z, client ID: 3166596512325037039, sequence num: 4, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: c, client ID: 3166596512325037039, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 5 Append 7 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: c, client ID: 3166596512325037039, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: c, client ID: 3166596512325037039, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 5 Append 7 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: R, client ID: 1418637628418551783, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 5 Append 8 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: R, client ID: 1418637628418551783, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: R, client ID: 1418637628418551783, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 5 Append 8 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-0 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-0 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-0 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-2 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-2 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-2 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S101-1 waiting to take over shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S101-1 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-1 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 11 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 11 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 3 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 14 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 5 Append 7 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 5 Append 8 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 11 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 3 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 14 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 5 Append 7 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 5 Append 8 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 3 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 3, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 14 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 12 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 5 Append 7 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 12 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 5 Append 8 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: 6, client ID: 2199136536800998598, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 15 Append 0 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: 6, client ID: 2199136536800998598, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: i, client ID: 501921243248122353, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 4 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: i, client ID: 501921243248122353, sequence num: 4, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: 6, client ID: 2199136536800998598, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 15 Append 0 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: R, client ID: 1418637628418551783, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: c, client ID: 3166596512325037039, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: 3, client ID: 1418637628418551783, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 6 Append 8 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: 3, client ID: 1418637628418551783, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: i, client ID: 3166596512325037039, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 6 Append 7 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: i, client ID: 3166596512325037039, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: 3, client ID: 1418637628418551783, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 6 Append 8 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: i, client ID: 3166596512325037039, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 6 Append 7 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: i, client ID: 501921243248122353, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 4 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 12 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 15 Append 0 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: F, client ID: 3507021557023121440, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 13 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: F, client ID: 3507021557023121440, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 6 Append 8 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 6 Append 7 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 12 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: F, client ID: 3507021557023121440, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 13 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: 3, client ID: 1418637628418551783, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 4 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 15 Append 0 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 6 Append 8 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 6 Append 7 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 4 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 12 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: i, client ID: 501921243248122353, sequence num: 4, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 15 Append 0 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 6 Append 8 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 6 Append 7 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: i, client ID: 3166596512325037039, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 4 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: B, client ID: 1418637628418551783, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 7 Append 8 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: B, client ID: 1418637628418551783, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: 6, client ID: 2199136536800998598, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: I, client ID: 3166596512325037039, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 7 Append 7 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: I, client ID: 3166596512325037039, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: 8, client ID: 501921243248122353, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 5 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: 8, client ID: 501921243248122353, sequence num: 5, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=0) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=0) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=1) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=1) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=2) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=2) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=3) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=3) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=4) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-2 CN:2 RCN:2 sends shard (SN=4) to G102
2025/01/07 12:55:51 ShardKV.migrator(): S100-2 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: B, client ID: 1418637628418551783, sequence num: 7
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 16 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 7 Append 8 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: 8, client ID: 501921243248122353, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 5 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=0)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: I, client ID: 3166596512325037039, sequence num: 7
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 7 Append 7 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=4)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 16 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=2)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=0) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=0) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=1) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=1) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=2) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=2) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=3) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=3) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=4) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-0 CN:2 RCN:2 sends shard (SN=4) to G102
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=4)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=2)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 13 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 7 Append 8 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 13 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 7 Append 8 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: F, client ID: 3507021557023121440, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 14
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 5 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 5 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 7 Append 7 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 7 Append 7 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 16 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: B, client ID: 1418637628418551783, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 14 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=0)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 14 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 16 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 13 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: 8, client ID: 501921243248122353, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 7 Append 8 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 5 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: I, client ID: 3166596512325037039, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 7 Append 7 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 16 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 6 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 6, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: K, client ID: 3166596512325037039, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 8 Append 7 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: K, client ID: 3166596512325037039, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 6 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: r, client ID: 2199136536800998598, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 17 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: r, client ID: 2199136536800998598, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: K, client ID: 3166596512325037039, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 8 Append 7 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: r, client ID: 2199136536800998598, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 17 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: 1, client ID: 1418637628418551783, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 8 Append 8 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: 1, client ID: 1418637628418551783, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=0) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=0) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=1) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=1) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=2) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=2) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=3) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=3) to G102
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=4) to G102 Servers([server-102-0 server-102-1 server-102-2])
2025/01/07 12:55:51 ShardKV.migrator() S100-1 CN:2 RCN:2 sends shard (SN=4) to G102
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: 1, client ID: 1418637628418551783, sequence num: 8
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 8 Append 8 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=0)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=2)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=4)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S102-0 accepts InstallShard (RCN=2 SN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-0 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-0 starts serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-2 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-0 starts serving shard (SN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-2 starts serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-1 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-2 starts serving shard (SN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-2 starts serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-2 starts serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.installShard: S102-1 starts serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-1 starts serving shard (SN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-0 starts serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.installShard: S102-0 starts serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-1 starts serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S102-1 starts serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 14 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 14 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 6 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 6 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 8 Append 7 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 8 Append 7 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 14 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 6 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: K, client ID: 3166596512325037039, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 8 Append 7 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 17 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 8 Append 8 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 17 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 17 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 8 Append 8 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 8 Append 8 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-1 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-2 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: 1, client ID: 1418637628418551783, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: r, client ID: 2199136536800998598, sequence num: 17, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: z, client ID: 501921243248122353, sequence num: 7
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: D, client ID: 3166596512325037039, sequence num: 9
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-1 starts not serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-1 starts not serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-2 starts not serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-1 starts not serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-1 starts not serving shard (SN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 15
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-0 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 7 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 9 Append 7 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: q, client ID: 2199136536800998598, sequence num: 18
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.deleteShard: S100-2 starts not serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 15 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:4 1347532576216071615:2 1418637628418551783:6 1573153705190402160:9 1769720748839593670:3 2199136536800998598:15 3106988376836154902:6 3166596512325037039:6 3507021557023121440:12 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-2 starts not serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[3:leEdWdS] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-0 starts not serving shard (SN=1)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-2 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-2 starts not serving shard (SN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:1, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 1 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 0 map[2:Hqj_mUez] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 15
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-0 starts not serving shard (SN=2)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 15 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:2, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 2 map[4:f7AgxXU] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: z, client ID: 501921243248122353, sequence num: 7, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: D, client ID: 3166596512325037039, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 18 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 9 Append 8 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[6:4H-N] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 9 Append 8 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[5:iv3x_] map[501921243248122353:5 1347532576216071615:2 1418637628418551783:7 1573153705190402160:9 1769720748839593670:3 2199136536800998598:16 3106988376836154902:6 3166596512325037039:7 3507021557023121440:13 3929044425438857535:5 4217985405542925169:5]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: q, client ID: 2199136536800998598, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: z, client ID: 501921243248122353, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 7 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-0 starts not serving shard (SN=4)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:4, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 4 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: q, client ID: 2199136536800998598, sequence num: 18
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G100-0 kv.reconfigureToConfigNum=2, args.reconfigureToConfigNum=2, kv.config.Num=2, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S100-0 starts not serving shard (SN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:3, opShard:2, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 2 3 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 18 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: D, client ID: 3166596512325037039, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 9 Append 7 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 15 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 9 Append 8 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 15 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 7 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: 9, client ID: 1418637628418551783, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 10 Append 8 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: 9, client ID: 1418637628418551783, sequence num: 10, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 9 Append 8 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 15 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 9 Append 8 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 16 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 18 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: q, client ID: 2199136536800998598, sequence num: 18, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 16 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 7 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 19 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 18 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 19 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 9 Append 7 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: z, client ID: 501921243248122353, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 7 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 18 Append 0 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 9 Append 7 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 8 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 8, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: D, client ID: 3166596512325037039, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 8
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: W, client ID: 3166596512325037039, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 8 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 10 Append 7 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: W, client ID: 3166596512325037039, sequence num: 10, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: 9, client ID: 1418637628418551783, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 10 Append 8 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 9 Append 7 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: W, client ID: 3166596512325037039, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 10 Append 7 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 16 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 19 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 19, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 7 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 16 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 19 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 8 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 10 Append 8 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 20 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 3 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 10 Append 7 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 17 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 16 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 17 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 19 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 20 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 8 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 10 Append 8 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 8 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 10 Append 7 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 10 Append 8 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 10 Append 7 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: W, client ID: 3166596512325037039, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: 9, client ID: 1418637628418551783, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 9 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 9, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: m, client ID: 3166596512325037039, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 11 Append 7 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: m, client ID: 3166596512325037039, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: u, client ID: 1418637628418551783, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 11 Append 8 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: u, client ID: 1418637628418551783, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 9
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 9 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: m, client ID: 3166596512325037039, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 11 Append 7 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: u, client ID: 1418637628418551783, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 11 Append 8 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3106988376836154902 7 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 3 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3106988376836154902 7 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3106988376836154902 7 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 3 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 3 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 3, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 8 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 6, value: G, client ID: 1347532576216071615, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 4 Append 6 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 17 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 20 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 9 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 17 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 129717324913002534: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 6 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 20 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 9 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 11 Append 7 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 11 Append 8 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 4 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 11 Append 7 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: m, client ID: 3166596512325037039, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: 7, client ID: 3166596512325037039, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 12 Append 7 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: 7, client ID: 3166596512325037039, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: 7, client ID: 3166596512325037039, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 12 Append 7 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 17, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 18
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 18 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 18
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 17 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 18 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 11 Append 8 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 20 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 9, err: OK
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 6
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 9 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 11 Append 7 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 11 Append 8 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 6 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: u, client ID: 1418637628418551783, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: s, client ID: 1418637628418551783, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 12 Append 8 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: s, client ID: 1418637628418551783, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: s, client ID: 1418637628418551783, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 12 Append 8 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 20, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 21 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 21 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 10 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 10, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 10 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 12 Append 7 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 18 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 18, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 19 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 19 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3106988376836154902 8 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 4 Append 6 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3106988376836154902 8 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 4 Append 6 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 6, value: G, client ID: 1347532576216071615, sequence num: 4, err: OK
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 6, value: d, client ID: 1347532576216071615, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 5 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3106988376836154902 8 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: 7, client ID: 3166596512325037039, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 4 Append 6 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 6 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: X, client ID: 3166596512325037039, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 13 Append 7 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: X, client ID: 3166596512325037039, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 4 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 6 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: X, client ID: 3166596512325037039, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 13 Append 7 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 12 Append 7 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 2, value: O, client ID: 3106988376836154902, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 9 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 6 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 4 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 6 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 6 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 4 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 4, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 18 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 5, value: 2, client ID: 1769720748839593670, sequence num: 5
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 5 Append 5 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 12 Append 8 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 21 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 12 Append 8 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 21 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 21, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 22
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 22 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 6 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 7 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: s, client ID: 1418637628418551783, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 10 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 4, value: 4, client ID: 4217985405542925169, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 7 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 10 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 2 , RCN: 2 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: 4, client ID: 1418637628418551783, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 13 Append 8 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: 4, client ID: 1418637628418551783, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: 4, client ID: 1418637628418551783, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 13 Append 8 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 22
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 22 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: m, client ID: 501921243248122353, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 11 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: m, client ID: 501921243248122353, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 12 Append 7 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 18 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: m, client ID: 501921243248122353, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 11 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 12 Append 8 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 21 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 10 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 19 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 13 Append 7 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 5 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: X, client ID: 3166596512325037039, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3106988376836154902 9 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 2, value: O, client ID: 3106988376836154902, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 5 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3106988376836154902 9 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 5 Append 5 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 7 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 6, value: d, client ID: 1347532576216071615, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 6, value: y, client ID: 1347532576216071615, sequence num: 6
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 6 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 5 Append 5 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 19 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 7 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 13 Append 7 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 13 Append 8 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 19, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 22 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 13 Append 8 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 11 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: B, client ID: 3166596512325037039, sequence num: 14
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 7 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 10 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:2 Append reply: key: 5, value: 2, client ID: 1769720748839593670, sequence num: 5, err: OK
2025/01/07 12:55:51 ShardKV.installConfig: S102-2 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-2 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 5 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3106988376836154902 9 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 5 Append 5 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 7 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S102-0 starts handing off shards
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 14 Append 7 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: B, client ID: 3166596512325037039, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 7 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 7 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S102-1 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-1 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S102-0 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 22 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 11 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: 4, client ID: 4217985405542925169, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: m, client ID: 501921243248122353, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 19 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 13 Append 7 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 22, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 12 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: 4, client ID: 1418637628418551783, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 23
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 23 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: t, client ID: 4217985405542925169, sequence num: 8
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 6
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 8 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 8 Append 4 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 6 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: B, client ID: 3166596512325037039, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 14 Append 7 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: 5, client ID: 1418637628418551783, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 14 Append 8 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 12 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: 5, client ID: 1418637628418551783, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 23
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 23 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 13 Append 8 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: 5, client ID: 1418637628418551783, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 14 Append 8 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 22 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 11 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 20 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 20 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 6 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3106988376836154902 10 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10, err: ErrNotApplied
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 8 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 6 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3106988376836154902 10 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 8 Append 4 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 8 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 6 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 8 Append 4 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 6 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S100-2 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S102-1 SN:0 CN:3 rejects Op due to state=MovingOut (C=3106988376836154902 Id=10) MovingIn: from group: 100, MovingOut: to group 101
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 14 Append 7 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 12 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 14 Append 7 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: y, client ID: 1347532576216071615, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 7 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 6, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: B, client ID: 1769720748839593670, sequence num: 7
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 7 Append 5 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 14 Append 7 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 12 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 6 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3106988376836154902 10 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 8 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 9 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 12 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: t, client ID: 4217985405542925169, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 9 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 23 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 14 Append 8 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 20 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 8 Append 4 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 6 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 23 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 23 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 14 Append 8 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 14 Append 8 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 20 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: 5, client ID: 1418637628418551783, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: B, client ID: 3166596512325037039, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: F, client ID: 1418637628418551783, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 15 Append 8 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: F, client ID: 1418637628418551783, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 20 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 20, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 21 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 21 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: F, client ID: 1418637628418551783, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 15 Append 8 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: g, client ID: 3166596512325037039, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 15 Append 7 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: g, client ID: 3166596512325037039, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 23, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 24
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 24 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: h, client ID: 501921243248122353, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 13 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: h, client ID: 501921243248122353, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 24
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 24 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: h, client ID: 501921243248122353, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 13 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 7 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 7 Append 5 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: B, client ID: 1769720748839593670, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 7, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 9 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 9 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: _, client ID: 1347532576216071615, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 8 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 8
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 8 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: B, client ID: 3929044425438857535, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 10 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: B, client ID: 4217985405542925169, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 10 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 7 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 7 Append 5 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 9 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 9 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 7 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 7 Append 5 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 9 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 9 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: g, client ID: 3166596512325037039, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 15 Append 7 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 21 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 15 Append 8 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: F, client ID: 1418637628418551783, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: U, client ID: 1418637628418551783, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 16 Append 8 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: U, client ID: 1418637628418551783, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: U, client ID: 1418637628418551783, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 16 Append 8 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 21, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: q, client ID: 3507021557023121440, sequence num: 22
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 22 Append 1 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: q, client ID: 3507021557023121440, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: q, client ID: 3507021557023121440, sequence num: 22
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 22 Append 1 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 24 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 13 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: h, client ID: 501921243248122353, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 14 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 14 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 24, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: U, client ID: 2199136536800998598, sequence num: 25
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 25 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: U, client ID: 2199136536800998598, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: U, client ID: 2199136536800998598, sequence num: 25
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 25 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 CN: 2 is reconfiguring to config (RCN=2)
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 21 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 21 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 15 Append 8 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 15 Append 8 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 24 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 13 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 24 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 13 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 8 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 8 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: H, client ID: 1769720748839593670, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 9 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 8 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 8 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 10 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 10 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: _, client ID: 1347532576216071615, sequence num: 8, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: K, client ID: 1347532576216071615, sequence num: 9
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 9 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 10 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 10 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: B, client ID: 4217985405542925169, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 11 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 8 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 8 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 10 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 10 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: B, client ID: 3929044425438857535, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 15 Append 7 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 16 Append 8 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: M, client ID: 3929044425438857535, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 11 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: U, client ID: 1418637628418551783, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: b, client ID: 1418637628418551783, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 17 Append 8 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: g, client ID: 3166596512325037039, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 22 Append 1 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 14 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: b, client ID: 1418637628418551783, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: G, client ID: 3166596512325037039, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 16 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: G, client ID: 3166596512325037039, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: q, client ID: 3507021557023121440, sequence num: 22, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 15 Append 7 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 16 Append 8 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 22 Append 1 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 14 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 25 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 25 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: U, client ID: 2199136536800998598, sequence num: 25, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: G, client ID: 501921243248122353, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 15 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: G, client ID: 501921243248122353, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: G, client ID: 501921243248122353, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 15 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: b, client ID: 1418637628418551783, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 17 Append 8 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: G, client ID: 3166596512325037039, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 16 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 23
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 23 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 23
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 23 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 26
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 26 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 15 Append 7 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 26
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 26 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 16 Append 8 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 22 Append 1 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=0) from G102
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-2 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:3 RCN:3 sends shard (SN=0) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:51 ShardKV.migrator() S102-0 CN:3 RCN:3 sends shard (SN=0) to G101
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.InstallShard(): S101-0 accepts InstallShard (RCN=3 SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 14 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 25 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 15 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 17 Append 8 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: b, client ID: 1418637628418551783, sequence num: 17, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 8, value: Z, client ID: 1418637628418551783, sequence num: 18
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1418637628418551783 18 Append 8 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 8, value: Z, client ID: 1418637628418551783, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 8, value: Z, client ID: 1418637628418551783, sequence num: 18
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1418637628418551783 18 Append 8 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 15 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: G, client ID: 501921243248122353, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 9 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 9 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: K, client ID: 1347532576216071615, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 16 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 16 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 23 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 10
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 15 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 9 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 17 Append 8 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 16 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 9 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 17 Append 8 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 23 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 16 Append 7 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 26 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 9 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 23 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 26 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 23, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 11 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 9 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 11 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 11 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 11 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 24
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 24 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-2 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S102-2 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 16 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 10 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-1 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S102-1 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: H, client ID: 1769720748839593670, sequence num: 9, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 7, value: G, client ID: 3166596512325037039, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 24
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 24 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 11 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3166596512325037039 17 Append 7 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 11 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: M, client ID: 3929044425438857535, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3166596512325037039 17 Append 7 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G102-0 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.deleteShard: S102-0 starts not serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies admin opType:DeleteShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 DeleteShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 26 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 26, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 2 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: S, client ID: 3929044425438857535, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 12 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: 4, client ID: 4217985405542925169, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 12 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 27
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 27 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 10 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 27
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 27 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{1418637628418551783 18 Append 8 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 16 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append request: key: 9, value: b, client ID: 501921243248122353, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 17 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:2 Append reply: key: 9, value: b, client ID: 501921243248122353, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append request: key: 9, value: b, client ID: 501921243248122353, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 17 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S101-0 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-0 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[2:Hqj_mUezcuOP] map[501921243248122353:4 1347532576216071615:8 1418637628418551783:6 1573153705190402160:9 1769720748839593670:8 2199136536800998598:15 3106988376836154902:10 3166596512325037039:6 3507021557023121440:12 3929044425438857535:10 4217985405542925169:10]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S101-2 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-2 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[2:Hqj_mUezcuOP] map[501921243248122353:4 1347532576216071615:8 1418637628418551783:6 1573153705190402160:9 1769720748839593670:8 2199136536800998598:15 3106988376836154902:10 3166596512325037039:6 3507021557023121440:12 3929044425438857535:10 4217985405542925169:10]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{1418637628418551783 18 Append 8 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 10 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 16 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: z, client ID: 1347532576216071615, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 11 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:2 Append reply: key: 8, value: Z, client ID: 1418637628418551783, sequence num: 18, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{1418637628418551783 18 Append 8 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=3, args.reconfigureToConfigNum=3, kv.config.Num=3, isEligibleToUpdateShard=true
2025/01/07 12:55:51 ShardKV.installShard: S101-1 starts serving shard (SN=0)
2025/01/07 12:55:51 ShardKV.engineStart(): S101-1 applies admin opType:InstallShard, opConfig:{Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]}, op.RCN:0, opShard:3, op: &{0 0 InstallShard   {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 3 0 map[2:Hqj_mUezcuOP] map[501921243248122353:4 1347532576216071615:8 1418637628418551783:6 1573153705190402160:9 1769720748839593670:8 2199136536800998598:15 3106988376836154902:10 3166596512325037039:6 3507021557023121440:12 3929044425438857535:10 4217985405542925169:10]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 24 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 24 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3166596512325037039 17 Append 7 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3166596512325037039 17 Append 7 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 10 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S100-1 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-1 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 12 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S100-2 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-2 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 12 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 27 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 12 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 16 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 10 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 12 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 24 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 12 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: 4, client ID: 4217985405542925169, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3166596512325037039 17 Append 7 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 12 Append 4 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.installConfig: S100-0 starts handing off shards
2025/01/07 12:55:51 ShardKV.maybeApplyAdminOp: S100-0 installed config (OCN=3)
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 10 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: v, client ID: 4217985405542925169, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 13 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 10 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies admin opType:InstallConfig, opConfig:{Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:3,Shards:[101 102 102 102 102 101 101 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 101:[server-101-0 server-101-1 server-101-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: S, client ID: 3929044425438857535, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 27 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 24, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 10 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 13 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 27 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 27, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 25
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: J, client ID: 1769720748839593670, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 25 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 11 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrNotApplied
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 25
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 25 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 28
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 28 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-2 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 28
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 28 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 17 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 25 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 25, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 26
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 26 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: b, client ID: 501921243248122353, sequence num: 17, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 26
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 26 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 11 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 13 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 11 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 13 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 13 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 11 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 11 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: z, client ID: 1347532576216071615, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 13 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 13 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 12 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 11 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 17 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 13 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 25 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 11 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 28 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: J, client ID: 1769720748839593670, sequence num: 11, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 12
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 12 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 18
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 18 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: c, client ID: 3929044425438857535, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 14 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: v, client ID: 4217985405542925169, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 17 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 25 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 14 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 28 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 28 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 18
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 18 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 28, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: z, client ID: 2199136536800998598, sequence num: 29
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 29 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: z, client ID: 2199136536800998598, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: z, client ID: 2199136536800998598, sequence num: 29
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 29 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 12 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 12 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 12 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 12 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 14 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 12 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 14 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 12 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 14 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 14 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 14 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 26 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 18 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 26, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 26 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 18 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 29 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 26 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 18 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 29 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 12, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 27
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 27 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 18, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: c, client ID: 3929044425438857535, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 13
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 13 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 15 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 14 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 29 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 3, client ID: 501921243248122353, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 19 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 15 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: J, client ID: 1769720748839593670, sequence num: 13
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 3, client ID: 501921243248122353, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 13 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 27
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 27 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: z, client ID: 2199136536800998598, sequence num: 29, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 3, client ID: 501921243248122353, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 19 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 30
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 30 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 30
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 30 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 13 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 15 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 15 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 13 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 13 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 15 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 13 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 15 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 15 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 13 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: J, client ID: 1769720748839593670, sequence num: 13, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 14 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 15, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 14
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 14 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 15 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: k, client ID: 4217985405542925169, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 16 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 13 Append 5 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: K, client ID: 3929044425438857535, sequence num: 16
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 16 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 27 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 19 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 27 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 3, client ID: 501921243248122353, sequence num: 19, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 19 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 30 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: M, client ID: 501921243248122353, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: M, client ID: 501921243248122353, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 27, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 27 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 30 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 30, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 19 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: M, client ID: 501921243248122353, sequence num: 20
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 30 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 31
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 31 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 31
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 31 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1289925332673859288: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1540660307417884270: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 567745738604484317: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 851717987639597555: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-0 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4271116681769036332: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 188446263330064059: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2713393722716724827: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1790364956057404909: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=5) from G100
2025/01/07 12:55:51 ShardKV.migrator() S101-1 CN:3 RCN:3 need receive shard (SN=6) from G100
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=3)
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 14 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 14 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 14, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 16 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 16 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: K, client ID: 3929044425438857535, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28, err: OK
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 31 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: k, client ID: 4217985405542925169, sequence num: 16, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: M, client ID: 501921243248122353, sequence num: 20, err: OK
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 31 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 31, err: OK
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2049763217740737214: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: 3 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:51 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:51 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 14 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 14 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 14 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:51 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:51 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:51 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:51 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:51 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:51 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 16 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 14 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:51 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:51 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:51 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:51 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:51 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 10 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 10, err: OK
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:51 ShardKV.ticker(): S102-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 780461901789720824: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 309167909479931851: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 709616447909096656: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:51 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:51 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:51 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:51 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:51 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 129717324913002534: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-2 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 709616447909096656: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 20 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 28 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 31 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 129717324913002534: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 14 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 16 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 16 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 16 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 16 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 21
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 15 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: W, client ID: 1769720748839593670, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 16 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: W, client ID: 1769720748839593670, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: W, client ID: 1769720748839593670, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 16 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 16 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: i, client ID: 3929044425438857535, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 18 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: i, client ID: 3929044425438857535, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 17 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 17 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 16 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 16 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 11 Append 2 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 15 Append 6 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: U, client ID: 3106988376836154902, sequence num: 11, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: N, client ID: 3106988376836154902, sequence num: 12
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 12 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: N, client ID: 3106988376836154902, sequence num: 12, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: W, client ID: 1769720748839593670, sequence num: 16, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: N, client ID: 3106988376836154902, sequence num: 12
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: i, client ID: 3929044425438857535, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 12 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 18 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: l, client ID: 1347532576216071615, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 16 Append 6 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: l, client ID: 1347532576216071615, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: l, client ID: 1347532576216071615, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 16 Append 6 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 17 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 17 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 18 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 18 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 29 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 21 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 30 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 22 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 30 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 22 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 18 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 16 Append 6 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: l, client ID: 1347532576216071615, sequence num: 16, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 17 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: i, client ID: 3929044425438857535, sequence num: 18, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 17 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 19 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 17 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 18 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 19
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 18 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 16 Append 6 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 17 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 18 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 19 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 17, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: F, client ID: 1769720748839593670, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 18 Append 5 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: F, client ID: 1769720748839593670, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 18 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: F, client ID: 1769720748839593670, sequence num: 18
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 16 Append 6 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 18 Append 5 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 17 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 18 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 18, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 19 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 19 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 12 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 12 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: N, client ID: 3106988376836154902, sequence num: 12, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 12 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: l, client ID: 3106988376836154902, sequence num: 13
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 13 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: l, client ID: 3106988376836154902, sequence num: 13, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: l, client ID: 3106988376836154902, sequence num: 13
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 13 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 30 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 22 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 30 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 22 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 31 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 23 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 31 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 23 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 709616447909096656: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 30 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 22 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 17 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 19 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 19, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 18 Append 5 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 19 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 20 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 17 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 19 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 18 Append 5 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 17, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 17 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 19 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 18 Append 5 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 19 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: F, client ID: 1769720748839593670, sequence num: 18, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 19 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 20 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 19, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: A, client ID: 1347532576216071615, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 18 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: A, client ID: 1347532576216071615, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: E, client ID: 1769720748839593670, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 19 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: E, client ID: 1769720748839593670, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: F, client ID: 4217985405542925169, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 20 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: F, client ID: 4217985405542925169, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: A, client ID: 1347532576216071615, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 18 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: E, client ID: 1769720748839593670, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 19 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: F, client ID: 4217985405542925169, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 20 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 13 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: l, client ID: 3106988376836154902, sequence num: 13, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 13 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 14
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 14 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 14, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 14
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 14 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 13 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 31 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 23 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 24 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 31 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 23 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 24 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: J, client ID: 2199136536800998598, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 31 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 23 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 32 Append 0 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 32
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 33 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 32 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 33 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 32 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 14 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 14 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 14, err: OK
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 14 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 20 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: I, client ID: 3106988376836154902, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 15 Append 2 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: I, client ID: 3106988376836154902, sequence num: 15, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 18 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: I, client ID: 3106988376836154902, sequence num: 15
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 15 Append 2 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 20 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: A, client ID: 1347532576216071615, sequence num: 18, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 18 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 19 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 20, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 19 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 20 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 20 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 20 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: F, client ID: 4217985405542925169, sequence num: 20, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: E, client ID: 1769720748839593670, sequence num: 19, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 18 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: I, client ID: 1347532576216071615, sequence num: 19
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: L, client ID: 3929044425438857535, sequence num: 21
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 20 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 19 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 20
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 20 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 20 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 19 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: I, client ID: 1347532576216071615, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: I, client ID: 1347532576216071615, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 19 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 24 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 33 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: B, client ID: 4217985405542925169, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 21 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: B, client ID: 4217985405542925169, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 32 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 24 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: B, client ID: 4217985405542925169, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 21 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 24 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 33 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 33 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 33 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 20 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 19 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 21 Append 3 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: L, client ID: 3929044425438857535, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: I, client ID: 1347532576216071615, sequence num: 19, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: L, client ID: 3929044425438857535, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 21 Append 3 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 20 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 33 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 19 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 32 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 20, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: R, client ID: 1347532576216071615, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 20 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: R, client ID: 1347532576216071615, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 34
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 34 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: R, client ID: 1347532576216071615, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 20 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 21 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 34 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 8, client ID: 501921243248122353, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 25 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 8, client ID: 501921243248122353, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 21
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 21 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 32 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 20 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 19 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=3)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 8, client ID: 501921243248122353, sequence num: 25
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 15 Append 2 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 25 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: I, client ID: 3106988376836154902, sequence num: 15, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 15 Append 2 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 16 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 16, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 16
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 16 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 15 Append 2 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 33 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 33 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 34 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 34 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 25 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 8, client ID: 501921243248122353, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 34
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 26 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 33 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 35 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 34 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 34 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 25 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 25 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 34 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 309167909479931851: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):5
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 3, OpType:Leave applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 21 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 26 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 21 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 21 Append 3 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 35
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 20 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 35 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 21 Append 3 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 21 Append 4 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 20 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 21 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 21 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):4
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):5
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):5
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 21 Append 3 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: L, client ID: 3929044425438857535, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: b, client ID: 3929044425438857535, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 22 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: b, client ID: 3929044425438857535, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: B, client ID: 4217985405542925169, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 22 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 22 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 20 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 21 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 22 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 22 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: R, client ID: 1347532576216071615, sequence num: 20, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 21 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: b, client ID: 3929044425438857535, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 22 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 21 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 16 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 16, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 16 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 16 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 17 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 17, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 17
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 17 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 34 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 26 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 35 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 34 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 26 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 34 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 26 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 35 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: m, client ID: 501921243248122353, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 27 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: m, client ID: 501921243248122353, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):6
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 4, OpType:Leave applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 35 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 35 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 35 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: m, client ID: 501921243248122353, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 27 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 35, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: h, client ID: 2199136536800998598, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 36 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: h, client ID: 2199136536800998598, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: h, client ID: 2199136536800998598, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 36 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):6
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Leave: len(cf.Configs):6
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 22 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 22 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 23 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 23 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 23 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 23 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 22 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 21 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 22 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 22 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: b, client ID: 3929044425438857535, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 17 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 22 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 22 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: E, client ID: 1347532576216071615, sequence num: 15, err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 17 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 17, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 23 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 23 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 22 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 21 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 22 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 22 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 22 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 21 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 18 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 18, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 18
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 18 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 17 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 35 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 27 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: m, client ID: 501921243248122353, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 35 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 35 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 27 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 27 Append 9 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 35, err: OK
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S100-2 ignored install config (OCN=4) due to RCN: -1 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 36 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S100-0 ignored install config (OCN=4) due to RCN: -1 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S100-1 ignored install config (OCN=4) due to RCN: 4 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 36 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 36 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: P, client ID: 501921243248122353, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 28 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: P, client ID: 501921243248122353, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: P, client ID: 501921243248122353, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 28 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 36 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 36 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: h, client ID: 2199136536800998598, sequence num: 36, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 37
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 37 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 37
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):6
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 18 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S101-1 ignored install config (OCN=4) due to RCN: 4 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 18, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 17, err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 37 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 28 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 36 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 36, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 17, err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 23 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 23 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 24 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 24 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 23 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 23 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 22 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 15, err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 18 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 23 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: P, client ID: 501921243248122353, sequence num: 28, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):7
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 5, OpType:Join applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 28 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 36 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S101-0 ignored install config (OCN=4) due to RCN: 4 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: G, client ID: 3106988376836154902, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 19 Append 2 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: G, client ID: 3106988376836154902, sequence num: 19, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 5, value: j, client ID: 1769720748839593670, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 24 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 5, value: j, client ID: 1769720748839593670, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: G, client ID: 3106988376836154902, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 19 Append 2 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 5, value: j, client ID: 1769720748839593670, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 24 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 22 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 23 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 23 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 28 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):7
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 18 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S101-2 ignored install config (OCN=4) due to RCN: 4 OCN:4 CN:3 kv.isMigrating():true
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 23 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 22 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 23 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 36 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):7
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):7
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: m, client ID: 3507021557023121440, sequence num: 37
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 24 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 29 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 37 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: m, client ID: 3507021557023121440, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: m, client ID: 3507021557023121440, sequence num: 37
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 37 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 23 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:3 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 24 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 23 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 19 Append 2 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: G, client ID: 3106988376836154902, sequence num: 19, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 20 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 19 Append 2 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 20, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 19 Append 2 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 20
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 20 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 29 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 37 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 37 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 37, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 38
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 38 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 37 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 38
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 38 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 37 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 37 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 29 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 37 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 29 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 29 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: d, client ID: 501921243248122353, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 30 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: d, client ID: 501921243248122353, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):8
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 6, OpType:Join applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):8
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: m, client ID: 3507021557023121440, sequence num: 37, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:52 MemoryConfigStateMachine.Join: len(cf.Configs):8
2025/01/07 12:55:52 *****************************************
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: d, client ID: 501921243248122353, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 30 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: m, client ID: 3507021557023121440, sequence num: 38
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 38 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: m, client ID: 3507021557023121440, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: m, client ID: 3507021557023121440, sequence num: 38
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 38 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 24 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 24 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 24 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 24 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.installConfig: S102-2 waiting to take over shards
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S102-2 installed config (OCN=4)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 24 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 23 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 24 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 24 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:3 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.installConfig: S102-1 waiting to take over shards
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S102-1 installed config (OCN=4)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 24 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 23 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: j, client ID: 1769720748839593670, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.installConfig: S102-0 waiting to take over shards
2025/01/07 12:55:52 ShardKV.maybeApplyAdminOp: S102-0 installed config (OCN=4)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies admin opType:InstallConfig, opConfig:{Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]}, op.RCN:0, opShard:0, op: &{0 0 InstallConfig   {Num:4,Shards:[100 102 102 102 102 100 102 100 100 100],Groups:map[100:[server-100-0 server-100-1 server-100-2] 102:[server-102-0 server-102-1 server-102-2]]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 25
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: h, client ID: 1347532576216071615, sequence num: 24
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 25 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 25 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 25 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 25 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 24 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 23 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 24 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: h, client ID: 1347532576216071615, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: h, client ID: 1347532576216071615, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 24 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 25 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 25 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 20 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 38 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 20 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 20, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: a, client ID: 3106988376836154902, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 21 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: a, client ID: 3106988376836154902, sequence num: 21, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: a, client ID: 3106988376836154902, sequence num: 21
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 21 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 25 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 25 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: F, client ID: 4217985405542925169, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 26 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: F, client ID: 4217985405542925169, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: F, client ID: 4217985405542925169, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 26 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 25 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 25 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 38 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 24 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 25 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 30 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 38 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 30 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: d, client ID: 501921243248122353, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 31 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 31 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 38, err: OK
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 25 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 25 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 20 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 38 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 39 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 39 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 24 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 24 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 25 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 25 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 30 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 26 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 38 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: h, client ID: 1347532576216071615, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 25 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 38 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 25 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: m, client ID: 3507021557023121440, sequence num: 38, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: G, client ID: 1769720748839593670, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 26 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: G, client ID: 1769720748839593670, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: G, client ID: 1769720748839593670, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 26 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 39 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 26 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 39 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 21 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: a, client ID: 3106988376836154902, sequence num: 21, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: x, client ID: 3106988376836154902, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 22 Append 2 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: x, client ID: 3106988376836154902, sequence num: 22, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: x, client ID: 3106988376836154902, sequence num: 22
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 22 Append 2 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 31 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 39 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 39, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 40 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 21 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 21 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 31 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 39 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 39 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 32 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 32 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 39 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 39, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: E, client ID: 3507021557023121440, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 40 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: E, client ID: 3507021557023121440, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: E, client ID: 3507021557023121440, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 40 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 31 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 39 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 39 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 40 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 26 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 25 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 26 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 25 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: h, client ID: 1347532576216071615, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 26 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: h, client ID: 1347532576216071615, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 26 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 25 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 26 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 26 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: F, client ID: 4217985405542925169, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 26 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 26 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 26 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 26 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: G, client ID: 1769720748839593670, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 27 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 27 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 27 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 27 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 27 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 27 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: h, client ID: 1347532576216071615, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 26 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 22 Append 2 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 32 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 40 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: E, client ID: 3507021557023121440, sequence num: 40, err: OK
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 22 Append 2 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 32 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 40 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 40 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 33 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 33 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 40 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 40, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: l, client ID: 2199136536800998598, sequence num: 41
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 41 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: l, client ID: 2199136536800998598, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: l, client ID: 2199136536800998598, sequence num: 41
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 41 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 22 Append 2 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 27 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 27 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: x, client ID: 3106988376836154902, sequence num: 22, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 23 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 23, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 23
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 23 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 28 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 28 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 27 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 26 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 27 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 27 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 27 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 26 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 28 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: h, client ID: 1347532576216071615, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: v, client ID: 1347532576216071615, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 27 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: v, client ID: 1347532576216071615, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 27 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: v, client ID: 1347532576216071615, sequence num: 27
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 27 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 27 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 27 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 26 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 28 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 28 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 28 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 41
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 41 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 32 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 40 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 40 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 23 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 23, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 5, client ID: 3106988376836154902, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 24 Append 2 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 5, client ID: 3106988376836154902, sequence num: 24, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: 5, client ID: 3106988376836154902, sequence num: 24
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 24 Append 2 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 23 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 23 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 41
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 41 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 33 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 41 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 41 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 33 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 33 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 41 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: l, client ID: 2199136536800998598, sequence num: 41, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 41 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 41 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: N, client ID: 2199136536800998598, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 42 Append 0 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: N, client ID: 2199136536800998598, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: N, client ID: 2199136536800998598, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 42 Append 0 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 41 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: d, client ID: 501921243248122353, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 34 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: d, client ID: 501921243248122353, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 41, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: d, client ID: 501921243248122353, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 34 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 42 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 42 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 28 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 27 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: v, client ID: 1347532576216071615, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 28 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 28 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 28 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 27 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 28 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 28 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 29 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 29 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 28 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 28 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: j, client ID: 3929044425438857535, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 29 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: j, client ID: 3929044425438857535, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: h, client ID: 1769720748839593670, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 29 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: h, client ID: 1769720748839593670, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: h, client ID: 1769720748839593670, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 29 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 28 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 27 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 28 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 28 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S102-1 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:52 ShardKV.migrator() S102-2 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:52 ShardKV.migrator() S102-0 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 24 Append 2 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: 5, client ID: 3106988376836154902, sequence num: 24, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 25 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 25, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 25
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 25 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 24 Append 2 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 24 Append 2 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 42 Append 0 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 34 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: d, client ID: 501921243248122353, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 35 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 35 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 42 Append 0 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 42 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: N, client ID: 2199136536800998598, sequence num: 42, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 42, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 43 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 43 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 43 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 43 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 42 Append 0 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 34 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 42 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 28 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 29 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 30 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 25 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 25, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 26 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 26, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 26
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 26 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 25 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 25 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 34 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 42 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 28 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 29 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 29 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 29 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: h, client ID: 1769720748839593670, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 30 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: j, client ID: 3929044425438857535, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 29 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 30 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 29 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: j, client ID: 3929044425438857535, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 30 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 30 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 30 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 29 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 28 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 26 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 26, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: W, client ID: 3106988376836154902, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 27 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: W, client ID: 3106988376836154902, sequence num: 27, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: W, client ID: 3106988376836154902, sequence num: 27
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 27 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 26 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 26 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 35 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 43 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 43, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 44
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 44 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 44
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 44 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 35 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 43 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 43 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 29 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 29 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 30 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 29 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 31 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 35, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 43 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 31 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 30 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 31 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 31 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 30 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 30 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 36 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 43, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 36 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 29 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 29 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: i, client ID: 2199136536800998598, sequence num: 44
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 44 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: i, client ID: 2199136536800998598, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: i, client ID: 2199136536800998598, sequence num: 44
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 44 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 35 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 43 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 43 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 27 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: W, client ID: 3106988376836154902, sequence num: 27, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 28 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 28, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 28
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 28 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 27 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 27 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 44 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 36 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 36, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 44 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 36 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 44 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 44, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 44 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 36 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 44 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 37
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 37 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: k, client ID: 1769720748839593670, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 30 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: k, client ID: 1769720748839593670, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: k, client ID: 1769720748839593670, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 30 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 45
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 45 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 28 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 28, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 29 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 28 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 29, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 29
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 29 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 28 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 31 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 31 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 31 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 32 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 32 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 31 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 31 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 29 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 30 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 31, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 44 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: i, client ID: 2199136536800998598, sequence num: 44, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 32 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 45
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 45 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 32 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 31 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 29 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 30 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 29 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 30 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: k, client ID: 1769720748839593670, sequence num: 30, err: OK
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 37
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 37 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 31 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 32 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 32 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 32 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 32 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 29 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: v, client ID: 3106988376836154902, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 30 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: v, client ID: 3106988376836154902, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: v, client ID: 3106988376836154902, sequence num: 30
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 30 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 29 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 29 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 37 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 37 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 29, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 32 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 45
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: f, client ID: 1347532576216071615, sequence num: 30
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 32 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 30 Append 6 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: f, client ID: 1347532576216071615, sequence num: 30, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 45 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 37 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 45
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 45 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 37, err: OK
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: z, client ID: 501921243248122353, sequence num: 38
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 38 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: z, client ID: 501921243248122353, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: m, client ID: 4217985405542925169, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 33 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: m, client ID: 4217985405542925169, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: m, client ID: 4217985405542925169, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 33 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: h, client ID: 3929044425438857535, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 33 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: h, client ID: 3929044425438857535, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: h, client ID: 3929044425438857535, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 33 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 31
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 309167909479931851: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: z, client ID: 501921243248122353, sequence num: 38
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 38 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 31 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 45 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 45 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 45, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 46
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 46 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 46
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 46 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 45 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 45 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 38 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: f, client ID: 1347532576216071615, sequence num: 30
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 45, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 46
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 46 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 46
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 46 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 38 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: z, client ID: 501921243248122353, sequence num: 38, err: OK
2025/01/07 12:55:52 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 30 Append 6 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 33 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 33 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 30 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 33 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 33 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 30 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:52 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 45 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 45 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 31 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 38 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 39 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 39
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 39 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 33 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 31 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.migrator() S102-2 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 33 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 31 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:52 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 30 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: v, client ID: 3106988376836154902, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 31 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 31
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 31 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:52 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:52 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.migrator() S102-0 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 46 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 46 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 46, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 47
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 47 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 47
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 47 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 46, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 30 Append 6 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 47
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 47 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 47
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 47 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 39 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 46 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 46 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 39 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.migrator() S102-1 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:52 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 39, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 46 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 46 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 40 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: c, client ID: 501921243248122353, sequence num: 40
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 40 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 39 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 30 Append 6 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: f, client ID: 1347532576216071615, sequence num: 30, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 32 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 32 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 30 Append 6 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: m, client ID: 4217985405542925169, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: a, client ID: 4217985405542925169, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 34 Append 4 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: a, client ID: 4217985405542925169, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: h, client ID: 3929044425438857535, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: a, client ID: 4217985405542925169, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 34 Append 4 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 34 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 31 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 32 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 32 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 32 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 33 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 33 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 32 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 34 Append 4 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 34 Append 4 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 32 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 34 Append 4 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: a, client ID: 4217985405542925169, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: x, client ID: 1347532576216071615, sequence num: 31
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 47 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 47 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 47, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 47 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 47 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 40 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 47 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 47 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 48
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 48 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 47, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: M, client ID: 2199136536800998598, sequence num: 48
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 48 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 48
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 48 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 31 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 40 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 34 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 40 Append 9 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: c, client ID: 501921243248122353, sequence num: 40, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 41
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: x, client ID: 1347532576216071615, sequence num: 31, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: h, client ID: 4217985405542925169, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 41 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 48
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 48 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 32 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 41
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 41 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: x, client ID: 1347532576216071615, sequence num: 31
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 32, err: OK
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 31 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 35 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: h, client ID: 4217985405542925169, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 31 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 32 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: h, client ID: 4217985405542925169, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 35 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 31 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 32 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 48 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 48 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 41 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 48 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 48 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 41 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: L, client ID: 3106988376836154902, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 33 Append 2 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: L, client ID: 3106988376836154902, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 33 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: L, client ID: 3106988376836154902, sequence num: 33
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 33 Append 2 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 34 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: V, client ID: 3929044425438857535, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 35 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: V, client ID: 3929044425438857535, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: V, client ID: 3929044425438857535, sequence num: 35
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 35 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 33 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 34 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 31 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 35 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 33 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 31 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 780461901789720824: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S102-2 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 33 Append 2 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: L, client ID: 3106988376836154902, sequence num: 33, err: OK
2025/01/07 12:55:52 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: R, client ID: 3106988376836154902, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 34 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: R, client ID: 3106988376836154902, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 48 Append 0 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: R, client ID: 3106988376836154902, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 34 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 48 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 33 Append 2 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: M, client ID: 2199136536800998598, sequence num: 48, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 33 Append 2 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 48, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: v, client ID: 3507021557023121440, sequence num: 49
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 49 Append 1 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: v, client ID: 3507021557023121440, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: v, client ID: 3507021557023121440, sequence num: 49
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 49 Append 1 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 34 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 35 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: h, client ID: 4217985405542925169, sequence num: 35, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: -, client ID: 4217985405542925169, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 36 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: X, client ID: 1769720748839593670, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 34 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: X, client ID: 1769720748839593670, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 31 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 35 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S102-0 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 41 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 41, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 49
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 49 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 49
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 49 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: i, client ID: 501921243248122353, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 42 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: i, client ID: 501921243248122353, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: i, client ID: 501921243248122353, sequence num: 42
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 42 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: -, client ID: 4217985405542925169, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: x, client ID: 1347532576216071615, sequence num: 31, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 32 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 32, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 32
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 32 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 35 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: X, client ID: 1769720748839593670, sequence num: 34
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 34 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 35 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: -, client ID: 4217985405542925169, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 36 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 49 Append 1 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 49 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 49, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 49 Append 1 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 49 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 42 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 35 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 49 Append 1 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: V, client ID: 3929044425438857535, sequence num: 35, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 49 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 42 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 36 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: v, client ID: 3507021557023121440, sequence num: 49, err: OK
2025/01/07 12:55:52 ShardKV.ticker(): S102-1 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 50
2025/01/07 12:55:52 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 42 Append 9 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 50 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 50
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 50 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: i, client ID: 501921243248122353, sequence num: 42, err: OK
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 43 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 43
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 43 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:52 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 36
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 36 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: E, client ID: 2199136536800998598, sequence num: 50
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 50 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: E, client ID: 2199136536800998598, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:52 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: E, client ID: 2199136536800998598, sequence num: 50
2025/01/07 12:55:52 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 50 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 34 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 34 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: R, client ID: 3106988376836154902, sequence num: 34, err: OK
2025/01/07 12:55:52 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 34 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:52 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 32 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 34 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: X, client ID: 1769720748839593670, sequence num: 34, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 32 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 35 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 34 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 36 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 32 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 36 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 35 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 34 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 32, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 36 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 36 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 36 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 36 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 33
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 33 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 33, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 36, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 37 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 37 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: -, client ID: 4217985405542925169, sequence num: 36, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 33
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 33 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 37 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 37 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 35 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 35 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 50 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 43 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 43, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: P, client ID: 501921243248122353, sequence num: 44
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 44 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: P, client ID: 501921243248122353, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: P, client ID: 501921243248122353, sequence num: 44
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 44 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 50, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 50 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 50 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 51
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 51 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 43 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 50 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: E, client ID: 2199136536800998598, sequence num: 50, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 51
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 51 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 50 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 43 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 51
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 51 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 50 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 51
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 51 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 35 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 35, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 36 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 36 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 35 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 35 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 35 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 37 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 33 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 35 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 37 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 37, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 37 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 35 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 33 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 35, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 37, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 37 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 37 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 38 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 33 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 36 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 38
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 37 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 33, err: OK
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 38 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 38 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 38 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: p, client ID: 1347532576216071615, sequence num: 34
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 36 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 34 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: p, client ID: 1347532576216071615, sequence num: 34, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: p, client ID: 1347532576216071615, sequence num: 34
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 34 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 44 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 51 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 51, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 52
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 52 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 52
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 52 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 44 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: P, client ID: 501921243248122353, sequence num: 44, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 51 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 51 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 45
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 45 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 51 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 51, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 52
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 52 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 52
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 52 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 45
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 45 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 44 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 51 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 51 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 36 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 36, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 36 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: V, client ID: 3106988376836154902, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 37 Append 2 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: V, client ID: 3106988376836154902, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 is leader: true !
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: V, client ID: 3106988376836154902, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 37 Append 2 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 36 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 38 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 38 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 38, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 36 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 38 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 34 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: p, client ID: 1347532576216071615, sequence num: 34, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 38 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 38 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 38 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 36 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 36 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 34 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 34 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 39 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: r, client ID: 1347532576216071615, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 35 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: r, client ID: 1347532576216071615, sequence num: 35, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 36, err: OK
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 37 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 38, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 39 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 39 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 39 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: r, client ID: 1347532576216071615, sequence num: 35
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 35 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 37 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 780461901789720824: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 52 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 52 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 52 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 52 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 52, err: OK
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 45 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 52 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 53
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 53 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 52 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 45 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 53
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 53 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 52, err: OK
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 53
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 53 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 45 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 45, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 53
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 53 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator() S102-2 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:53 ShardKV.migrator() S102-0 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 1, client ID: 501921243248122353, sequence num: 46
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 46 Append 9 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 1, client ID: 501921243248122353, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 1, client ID: 501921243248122353, sequence num: 46
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 46 Append 9 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 39 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 37 Append 2 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 39 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 39 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 37 Append 2 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 39 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 35 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: V, client ID: 3106988376836154902, sequence num: 37, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 37 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 39, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 39 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 39 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 35 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 37 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 39, err: OK
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 40 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S102-1 CN:4 RCN:4 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 1, client ID: 3106988376836154902, sequence num: 38
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 53 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 53 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 46 Append 9 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 38 Append 2 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 37 Append 2 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 53 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 40 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 53 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 46 Append 9 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 35 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 37 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 37, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 40 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: r, client ID: 1347532576216071615, sequence num: 35, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 38 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 36 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 36, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 38 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 36
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 36 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 1, client ID: 3106988376836154902, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: 1, client ID: 3106988376836154902, sequence num: 38
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 38 Append 2 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4545197026714791853: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4447440809070877790: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 40 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 53 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 53 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 53, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 54
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 54 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 54
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 54 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 53, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: E, client ID: 2199136536800998598, sequence num: 54
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 54 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: E, client ID: 2199136536800998598, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: E, client ID: 2199136536800998598, sequence num: 54
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 54 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 46 Append 9 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 1, client ID: 501921243248122353, sequence num: 46, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 47
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 47 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 47
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 47 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 38 Append 2 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: 1, client ID: 3106988376836154902, sequence num: 38, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 40 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 38 Append 2 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 39
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 40
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 39 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 40 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 38 Append 2 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 40, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 39 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 38 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 36 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 54 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 36, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 54 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: E, client ID: 2199136536800998598, sequence num: 54, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 38 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 36 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 40 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 54 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
labgob warning: Decoding into a non-default variable/field Num may not work
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 54 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 54 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 47 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 54 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 54, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 47 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 40 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 47 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 38, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 40 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 47, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 40, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 309167909479931851: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1208542690502454367: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 39 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3051090068772906098: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2716772545021229717: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 780461901789720824: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1686121861951020314: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1921583127525252033: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1783607437341311733: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: 4 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 39, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 39 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 39 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:53 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:53 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:53 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:53 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:53 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:53 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:53 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41, err: OK
2025/01/07 12:55:53 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:53 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:53 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:53 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:53 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:53 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrNotApplied
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1926676554315921080: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1056795416362984111: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 537778679009426780: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 956947209207926240: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1193238206083686377: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4520829055932904657: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 912203648258215366: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4032771472503138969: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2559445275346654893: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=40) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrWrongGroup
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1926676554315921080: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 709616447909096656: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 537778679009426780: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 956947209207926240: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1056795416362984111: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1193238206083686377: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4520829055932904657: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2559445275346654893: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 41 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 41, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 129717324913002534: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4032771472503138969: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 912203648258215366: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):9
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 7, OpType:Leave applied !!!
2025/01/07 12:55:53 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):9
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):8
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):9
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):10
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 8, OpType:Leave applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:1 CN:3 rejects Op due to state=NotServing (C=3929044425438857535 Id=41) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):10
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1926676554315921080: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 309167909479931851: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:53 MemoryConfigStateMachine.Leave: len(cf.Configs):10
2025/01/07 12:55:53 *****************************************
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4520829055932904657: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1193238206083686377: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2559445275346654893: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1056795416362984111: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 956947209207926240: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 709616447909096656: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4032771472503138969: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 912203648258215366: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 537778679009426780: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 129717324913002534: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:3 CN:3 rejects Op due to state=NotServing (C=1769720748839593670 Id=39) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:4 CN:3 rejects Op due to state=NotServing (C=1347532576216071615 Id=37) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 48
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:2 CN:3 rejects Op due to state=NotServing (C=4217985405542925169 Id=42) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 55 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 55, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 48, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: z, client ID: 501921243248122353, sequence num: 49
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 49 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 55, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 56
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 56 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: K, client ID: 3507021557023121440, sequence num: 56
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 56 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 55 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 48 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1926676554315921080: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4520829055932904657: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 49 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 56 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 56 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 56, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 49 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: K, client ID: 3507021557023121440, sequence num: 56, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: z, client ID: 501921243248122353, sequence num: 49, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 56 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 49 Append 9 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 56 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 56 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: R, client ID: 2199136536800998598, sequence num: 57
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 57 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 50
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 50 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 57
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 57 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 56 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1193238206083686377: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1056795416362984111: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 57 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 2559445275346654893: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 50 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 57 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 50 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 57 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: R, client ID: 2199136536800998598, sequence num: 57, err: OK
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:53 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 57 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 50 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 57 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 57 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 956947209207926240: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:53 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:55:53 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 50, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 51
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 51 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 57, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 58
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 58 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 58
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 58 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 4032771472503138969: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=40) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrWrongGroup
2025/01/07 12:55:53 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 537778679009426780: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 MemoryConfigStateMachine.Query: len(cf.Configs):10
2025/01/07 12:55:53 ShardCtrler.applier: clerkid 912203648258215366: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:53 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:53 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:53 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:53 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 51 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 58 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 51, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: d, client ID: 501921243248122353, sequence num: 52
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 52 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 58 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 58, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 58, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 59
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 59 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 52 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: k, client ID: 3507021557023121440, sequence num: 59
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 59 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: d, client ID: 501921243248122353, sequence num: 52, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 9, client ID: 501921243248122353, sequence num: 53
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 53 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 51 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 58 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 58 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 52 Append 9 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 59 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 59 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 59 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 59 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: k, client ID: 3507021557023121440, sequence num: 59, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 59, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 53 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 9, client ID: 501921243248122353, sequence num: 53, err: OK
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 53 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 60
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 60 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: e, client ID: 2199136536800998598, sequence num: 60
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 60 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 8, client ID: 501921243248122353, sequence num: 54
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 54 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 60 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 60 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: e, client ID: 2199136536800998598, sequence num: 60, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: l, client ID: 2199136536800998598, sequence num: 61
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 61 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 60 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 60, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 61
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 61 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 54 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 61 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 60 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 54 Append 9 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 61 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: l, client ID: 2199136536800998598, sequence num: 61, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: e, client ID: 2199136536800998598, sequence num: 62
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 62 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 8, client ID: 501921243248122353, sequence num: 54, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: e, client ID: 501921243248122353, sequence num: 55
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 55 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 61 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 61, err: OK
2025/01/07 12:55:53 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: y, client ID: 3507021557023121440, sequence num: 62
2025/01/07 12:55:53 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 62 Append 1 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 61 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:53 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:53 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:55:53 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 62 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 55 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: e, client ID: 501921243248122353, sequence num: 55, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 62 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 55 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 62 Append 1 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: e, client ID: 2199136536800998598, sequence num: 62, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 62 Append 1 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: y, client ID: 3507021557023121440, sequence num: 62, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 63
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 63 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 62 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 55 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 62 Append 1 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 56
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 56 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):11
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:53 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 63 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 56 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 56, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: b, client ID: 501921243248122353, sequence num: 57
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 57 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 63, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):11
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 63 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 56 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 63 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 56 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: t, client ID: 3507021557023121440, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 64 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):11
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 9, OpType:Join applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1926676554315921080: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: r, client ID: 2199136536800998598, sequence num: 63
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 63 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4520829055932904657: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1193238206083686377: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 956947209207926240: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 537778679009426780: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1056795416362984111: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4032771472503138969: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 912203648258215366: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2559445275346654893: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 129717324913002534: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 309167909479931851: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 57 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 64 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: t, client ID: 3507021557023121440, sequence num: 64, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 57 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 64 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 63 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: b, client ID: 501921243248122353, sequence num: 57, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):12
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 10, OpType:Join applied !!!
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 63 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: r, client ID: 2199136536800998598, sequence num: 63, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 57 Append 9 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 64 Append 1 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 63 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 37, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:54 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:54 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:54 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:54 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:54 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:54 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:54 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:54 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):12
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: ErrNotApplied
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):11
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):12
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:54 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:54 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:54 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:54 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:0 CN:4 rejects Op due to state=NotServing (C=3106988376836154902 Id=40) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: ErrWrongGroup
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 129717324913002534: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: S, client ID: 1769720748839593670, sequence num: 39, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 709616447909096656: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 129717324913002534: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 309167909479931851: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 709616447909096656: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 40 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 40, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 129717324913002534: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:1 CN:3 rejects Op due to state=NotServing (C=3929044425438857535 Id=41) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:2 CN:3 rejects Op due to state=NotServing (C=4217985405542925169 Id=42) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 64, err: OK
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:3 CN:3 rejects Op due to state=NotServing (C=1769720748839593670 Id=40) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 66
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 66 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 39 Append 5 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 37 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 38, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 38 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 58 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: J, client ID: 501921243248122353, sequence num: 59
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: R, client ID: 3106988376836154902, sequence num: 41, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 41 Append 2 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 64 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 59 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 65 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 66 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 66 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 65 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 66 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 66, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 67
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 67 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 39 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 39, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 39
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 39 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 59 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 65 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 65, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 39 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 39, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 65, err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: J, client ID: 501921243248122353, sequence num: 59, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: h, client ID: 501921243248122353, sequence num: 60
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 60 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 39 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 40 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 40 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 67 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 39 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 67, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 68
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 68 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):13
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 59 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 65 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 67 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):13
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 40 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 40, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 40 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 40 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 41 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 41 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:54 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 42 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 42, err: OK
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 60 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 59 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 65 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 67 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 60 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 68 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 11, OpType:Leave applied !!!
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 68 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):12
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):13
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 60 Append 9 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 68 Append 1 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 3, client ID: 3507021557023121440, sequence num: 68, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 66
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 66 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: h, client ID: 501921243248122353, sequence num: 60, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: e, client ID: 501921243248122353, sequence num: 61
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 61 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: d, client ID: 3507021557023121440, sequence num: 69
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 69 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 58, err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 41 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 41 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 41, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 41 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: x, client ID: 1347532576216071615, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 42 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: x, client ID: 1347532576216071615, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: x, client ID: 1347532576216071615, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 42 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):14
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 12, OpType:Leave applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):13
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):14
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 66 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 61 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 66 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 61 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 69 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 66, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Leave: len(cf.Configs):14
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 8, client ID: 2199136536800998598, sequence num: 67
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 67 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 43, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 69 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: e, client ID: 501921243248122353, sequence num: 61, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 43 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: S, client ID: 501921243248122353, sequence num: 62
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 62 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: d, client ID: 3507021557023121440, sequence num: 69, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: s, client ID: 3507021557023121440, sequence num: 70
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 70 Append 1 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 66 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 61 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 69 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 42 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 42 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: x, client ID: 1347532576216071615, sequence num: 42, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 42 Append 6 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: R, client ID: 1347532576216071615, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 43 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: R, client ID: 1347532576216071615, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: R, client ID: 1347532576216071615, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 43 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 67 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 62 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: S, client ID: 501921243248122353, sequence num: 62, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: o, client ID: 501921243248122353, sequence num: 63
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 63 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 8, client ID: 2199136536800998598, sequence num: 67, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 68
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 68 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 70 Append 1 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: s, client ID: 3507021557023121440, sequence num: 70, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: m, client ID: 3507021557023121440, sequence num: 71
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 71 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 67 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 62 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 70 Append 1 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 67 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 62 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 70 Append 1 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: b, client ID: 3106988376836154902, sequence num: 44, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 44 Append 2 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 43 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 43 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: R, client ID: 1347532576216071615, sequence num: 43, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 43 Append 6 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 44 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 44 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 63 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 68 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 71 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 63 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 68 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 68, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: B, client ID: 2199136536800998598, sequence num: 69
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 69 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 63 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 68 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 71 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: o, client ID: 501921243248122353, sequence num: 63, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 64
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 64 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 71 Append 1 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: m, client ID: 3507021557023121440, sequence num: 71, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 72
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 72 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: D, client ID: 3106988376836154902, sequence num: 45, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 46 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 46 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 44 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 44, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: k, client ID: 1347532576216071615, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 45 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: k, client ID: 1347532576216071615, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: k, client ID: 1347532576216071615, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 45 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 69 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 44 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 64 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 72 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 44 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 69 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 64 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 64, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: x, client ID: 501921243248122353, sequence num: 65
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 65 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 46 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: B, client ID: 2199136536800998598, sequence num: 69, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 72 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 72, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 69 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 64 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 72 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 45 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 73
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 73 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 70
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 70 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 65 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 73 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 73, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 74
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 74 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 65 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: x, client ID: 501921243248122353, sequence num: 65, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 73 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 46 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 70 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 74 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 70 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 74 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 74, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 75
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 75 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 70, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 65 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 73 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 70 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 74 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 71
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 71 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: j, client ID: 501921243248122353, sequence num: 66
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 66 Append 9 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: A, client ID: 3106988376836154902, sequence num: 46, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 46 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 45 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: k, client ID: 1347532576216071615, sequence num: 45, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 46
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 46 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 46
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 46 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 45 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 45 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 42 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 42, err: OK
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 46 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:54 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 46 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:54 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 46 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 46, err: OK
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:54 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 75 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 71 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 71, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 72
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 72 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 75, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 76
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 76 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 66 Append 9 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 43 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 43
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 43 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 47
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 47 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 47
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 47 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: j, client ID: 501921243248122353, sequence num: 66, err: OK
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 9, client ID: 501921243248122353, sequence num: 67
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 67 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:54 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:54 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 129717324913002534: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 309167909479931851: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 75 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 71 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 75 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 71 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 47, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):14
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 66 Append 9 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 48 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 48 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 48 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 43 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 47 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 43, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 44 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 44
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 44 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: n, client ID: 1769720748839593670, sequence num: 40, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 47, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: _, client ID: 1347532576216071615, sequence num: 48
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 48 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: _, client ID: 1347532576216071615, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: _, client ID: 1347532576216071615, sequence num: 48
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 48 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 72 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 76 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 47 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 76, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 43 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 47 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 48 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 48, err: OK
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):15
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 48 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 66 Append 9 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 72, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 72 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 76 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 73
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 73 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 67 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 67 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 77
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 77 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 9, client ID: 501921243248122353, sequence num: 67, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: o, client ID: 501921243248122353, sequence num: 68
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 68 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 72 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 76 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 67 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 41, err: OK
2025/01/07 12:55:54 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 42 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:54 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:54 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):15
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 13, OpType:Join applied !!!
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 6, client ID: 1769720748839593670, sequence num: 41
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 42
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 42 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:54 MemoryConfigStateMachine.Join: len(cf.Configs):15
2025/01/07 12:55:54 *****************************************
2025/01/07 12:55:54 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 41 Append 5 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 44 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 48 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 44 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 48 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: _, client ID: 1347532576216071615, sequence num: 48, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 44, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 49, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 49 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 43 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 47 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 73 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 77 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 77, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 78
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 78 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 73 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 41 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 77 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 40 Append 5 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 68 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 73, err: OK
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 44 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 48 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 73 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 74
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 74 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 77 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 68 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 68 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: o, client ID: 501921243248122353, sequence num: 68, err: OK
2025/01/07 12:55:54 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 69
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 69 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 6, client ID: 1769720748839593670, sequence num: 41, err: ErrWrongLeader
2025/01/07 12:55:54 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 6, client ID: 1769720748839593670, sequence num: 41
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 41 Append 5 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:54 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: h, client ID: 4217985405542925169, sequence num: 45
2025/01/07 12:55:54 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 45 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: h, client ID: 4217985405542925169, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 49 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 49 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: len(cf.Configs):16
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 14, OpType:Join applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: len(cf.Configs):16
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 42 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 41 Append 5 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 6, client ID: 1769720748839593670, sequence num: 41, err: OK
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 42 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 50 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 42 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 50, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 78 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 74 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 74, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: h, client ID: 2199136536800998598, sequence num: 75
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 75 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 78, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: x, client ID: 3507021557023121440, sequence num: 79
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 79 Append 1 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 78 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 69 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 69, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: o, client ID: 501921243248122353, sequence num: 70
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 70 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 41 Append 5 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 49 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: h, client ID: 4217985405542925169, sequence num: 45
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 45 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 42, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 41 Append 5 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: m, client ID: 3929044425438857535, sequence num: 43
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 43 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: m, client ID: 3929044425438857535, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 49 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 74 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 69 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: m, client ID: 3929044425438857535, sequence num: 43
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 43 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 42
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 42 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 42, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 49 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 42
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 42 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 49, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 50 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 50 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 78 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 74 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 69 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):15
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 51, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 51 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 75 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 79 Append 1 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: x, client ID: 3507021557023121440, sequence num: 79, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 75 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 80
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 80 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 79 Append 1 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 70 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 75 Append 0 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 79 Append 1 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: h, client ID: 2199136536800998598, sequence num: 75, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 76
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 76 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 70 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: o, client ID: 501921243248122353, sequence num: 70, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 71
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 71 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 45 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 45 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 43 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 42 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 50 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 70 Append 9 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 43 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 45 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 43 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 42 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: len(cf.Configs):16
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 50 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: m, client ID: 3929044425438857535, sequence num: 43, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 42 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 42, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: h, client ID: 4217985405542925169, sequence num: 45, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: x, client ID: 3929044425438857535, sequence num: 44
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 44 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: x, client ID: 3929044425438857535, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 50 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 46
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 46 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 50, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 43
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 43 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 43, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: r, client ID: 1347532576216071615, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 51 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: r, client ID: 1347532576216071615, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 43
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 43 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: r, client ID: 1347532576216071615, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 51 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: t, client ID: 3106988376836154902, sequence num: 52, err: OK
2025/01/07 12:55:55 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 80 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 76 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 76, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 46
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 46 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: x, client ID: 3929044425438857535, sequence num: 44
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 44 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 80 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 76 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 71 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 0, client ID: 3507021557023121440, sequence num: 80, err: OK
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 71 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 77
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 77 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 71, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 72
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 72 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 52 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: S, client ID: 3106988376836154902, sequence num: 53, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 53 Append 2 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 80 Append 1 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 76 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 71 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 81
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 81 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 54, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 43 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 51 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 43 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 51 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 46 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 44 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 43 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 51 Append 6 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 46 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 44 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 77 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 72 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 72, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: J, client ID: 501921243248122353, sequence num: 73
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 73 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 77 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: r, client ID: 1347532576216071615, sequence num: 51, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 72 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 81 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 77, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 46 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 54 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: N, client ID: 1347532576216071615, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 52 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: N, client ID: 1347532576216071615, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 81 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 73 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: J, client ID: 501921243248122353, sequence num: 73, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 77 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 72 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 81 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 73 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 81, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 82
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 82 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: k, client ID: 501921243248122353, sequence num: 74
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 74 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 44 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 73 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: x, client ID: 3929044425438857535, sequence num: 44, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 43, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: N, client ID: 1347532576216071615, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 52 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 44
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 44 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 44, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 78
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 78 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 46, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: m, client ID: 4217985405542925169, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 47 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: m, client ID: 4217985405542925169, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: m, client ID: 4217985405542925169, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 47 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 44
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 44 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 82 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 74 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 52 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 45
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 45 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: W, client ID: 3106988376836154902, sequence num: 55, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 55 Append 2 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 82, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 83
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 83 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: k, client ID: 501921243248122353, sequence num: 74, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 75
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 75 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 82 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 78 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 74 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 83 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 78 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 83, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 78, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 47 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 83 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: m, client ID: 4217985405542925169, sequence num: 47, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 82 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 74 Append 9 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 78 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 83 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: N, client ID: 1347532576216071615, sequence num: 52, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 53 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 53 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 44 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 84
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 84 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 52 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 47 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 44 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 48 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: i, client ID: 2199136536800998598, sequence num: 79
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 79 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 48 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 45
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 45 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 44, err: OK
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 45
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 45 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 45, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 45
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 45 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 75 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 84 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 53 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 48 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 48, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 53, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 45 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 45, err: OK
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 45 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 52 Append 6 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 47 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 44 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 53 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 48 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 45 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 45 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 56 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 75 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 84 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 79 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 53 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 48 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 45 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 45 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 79 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 56, err: OK
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 45, err: OK
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 75 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 84 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 49
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 54
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: j, client ID: 3929044425438857535, sequence num: 46
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 46
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 46 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 79 Append 0 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: i, client ID: 2199136536800998598, sequence num: 79, err: OK
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 80
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 80 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 46
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 84, err: OK
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 46 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 75, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: r, client ID: 3507021557023121440, sequence num: 85
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 85 Append 1 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: G, client ID: 501921243248122353, sequence num: 76
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 76 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 49 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 54 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 49 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 54 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 46 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: j, client ID: 3929044425438857535, sequence num: 46, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: j, client ID: 3929044425438857535, sequence num: 46
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 46 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:55 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 309167909479931851: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 80 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 85 Append 1 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: r, client ID: 3507021557023121440, sequence num: 85, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 86
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 86 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 80, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 81
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 81 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 76 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: G, client ID: 501921243248122353, sequence num: 76, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: g, client ID: 501921243248122353, sequence num: 77
2025/01/07 12:55:55 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 80 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 85 Append 1 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 76 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 80 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 85 Append 1 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 76 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: w, client ID: 3106988376836154902, sequence num: 57, err: OK
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 77 Append 9 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 46 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 49 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 49, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: n, client ID: 4217985405542925169, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 50 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: n, client ID: 4217985405542925169, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: n, client ID: 4217985405542925169, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 50 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 46, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: i, client ID: 1769720748839593670, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 47 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: i, client ID: 1769720748839593670, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: i, client ID: 1769720748839593670, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 47 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 54 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 46 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: j, client ID: 3929044425438857535, sequence num: 46, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 47 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 47, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 47
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 47 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 46 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 49 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 54 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 46 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 46 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 49 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 54 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 46 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 54, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 55 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 55 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 57 Append 2 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 86 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 81 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 81, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: E, client ID: 2199136536800998598, sequence num: 82
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 82 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 86 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 81 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 77 Append 9 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 86, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 87
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 87 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 77 Append 9 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: g, client ID: 501921243248122353, sequence num: 77, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 78
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 78 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 86 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 81 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 77 Append 9 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: -, client ID: 3106988376836154902, sequence num: 58, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 58 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 50 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 47 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: i, client ID: 1769720748839593670, sequence num: 47, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: y, client ID: 1769720748839593670, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 48 Append 5 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: y, client ID: 1769720748839593670, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: y, client ID: 1769720748839593670, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 48 Append 5 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 50 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 47 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 47 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 55 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: n, client ID: 4217985405542925169, sequence num: 50, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 51 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 51 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 47 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 55 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 55, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 6, client ID: 3929044425438857535, sequence num: 47, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: u, client ID: 3106988376836154902, sequence num: 59, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 59 Append 2 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 50 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 47 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 47 Append 3 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 55 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: b, client ID: 1347532576216071615, sequence num: 56
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 56 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: b, client ID: 1347532576216071615, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: b, client ID: 1347532576216071615, sequence num: 56
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 56 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 48 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 48, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 48
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 48 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 82 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 87 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 87, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 88
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 88 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: E, client ID: 2199136536800998598, sequence num: 82, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 82 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 83
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 83 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 78 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 87 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 78, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 78 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 82 Append 0 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 87 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 79
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 78 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 79 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 48 Append 5 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 51 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 51, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 52 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 48 Append 5 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 51 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 52 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 48 Append 5 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: y, client ID: 1769720748839593670, sequence num: 48, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 51 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 56 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 48 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 56 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 48 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 56 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 48 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 49 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 49 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 48, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 49 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 49, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 49
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 49 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: b, client ID: 1347532576216071615, sequence num: 56, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 57
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 57 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 57
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 57 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 88 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 83 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 83, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: K, client ID: 2199136536800998598, sequence num: 84
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 84 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 88 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 83 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 79 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 88, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 89
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 89 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 79 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 79, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 80
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 80 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 88 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 83 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 79 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 60, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 60 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 52 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 49 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 49, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 50 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 50 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 52 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 49 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 49 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 57 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 52, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: O, client ID: 4217985405542925169, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 53 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: O, client ID: 4217985405542925169, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: O, client ID: 4217985405542925169, sequence num: 53
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 53 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 49 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 57 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 57, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 58
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 58 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 58
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 58 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 52 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 49 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 49 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 57 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 49, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 50 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 50, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 84 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 89 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 89, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 90
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 90 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: K, client ID: 2199136536800998598, sequence num: 84, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 85
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 85 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 80 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 80, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: J, client ID: 501921243248122353, sequence num: 81
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 81 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 84 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 89 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 80 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 61, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 61 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 84 Append 0 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 89 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 80 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 50
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 50 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 50 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 53 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: O, client ID: 4217985405542925169, sequence num: 53, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 54 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 54
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 54 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 90 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 85 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 50 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 53 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 58 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 50 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 50 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 53 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 58 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 50 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 90 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 85 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 85, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 86
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 86 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 90, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 91
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 91 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 81 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: J, client ID: 501921243248122353, sequence num: 81, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Q, client ID: 501921243248122353, sequence num: 82
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 82 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 81 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 50, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 51 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 51 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 90 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 58 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 50 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 50, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 51 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 51, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 51
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 51 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 58, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 59
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 59 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: n, client ID: 3106988376836154902, sequence num: 62, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:55 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1640615046882794776: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:55 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 85 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 81 Append 9 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 59
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 59 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 62 Append 2 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1701277395400767294: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2836192090095897865: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2935826867476078031: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1816246725101837127: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2158195914899974508: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1315250114173298169: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 4475035593896372204: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 54 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 51 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 51, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 54, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 51 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 59 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 59, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 51, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 54 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 51 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 51 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 59 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 86 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 91 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 91, err: OK
2025/01/07 12:55:55 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 86, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 82 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Q, client ID: 501921243248122353, sequence num: 82, err: OK
2025/01/07 12:55:55 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: T, client ID: 3106988376836154902, sequence num: 63, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: G, client ID: 501921243248122353, sequence num: 83
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 83 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 92
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 92 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:55 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:55 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 86 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 83 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 92 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 92, err: OK
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 82 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: G, client ID: 501921243248122353, sequence num: 83, err: OK
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 83 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 92 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 54 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 51 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 51 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 59 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 63 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:55 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:55 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:55 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:55 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:55 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:55 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:55 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:55 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:55 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60, err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrNotApplied
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:55 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:55 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrNotApplied
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1190608830565050288: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 617033193357959312: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 73589017628862234: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrNotApplied
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrNotApplied
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:55 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):17
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):17
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):16
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 309167909479931851: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):17
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 15, OpType:Leave applied !!!
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:55 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:55 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=64) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:55 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrWrongGroup
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):18
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:55 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:55 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):18
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 16, OpType:Leave applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:55 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):17
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:55 MemoryConfigStateMachine.Leave: len(cf.Configs):18
2025/01/07 12:55:55 *****************************************
2025/01/07 12:55:55 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:4 CN:3 rejects Op due to state=NotServing (C=1347532576216071615 Id=60) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60, err: ErrWrongGroup
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 617033193357959312: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 73589017628862234: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 709616447909096656: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 129717324913002534: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:56 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 73589017628862234: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 55, err: OK
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 55 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 84
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 709616447909096656: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 8, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 129717324913002534: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 52 Append 5 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 3, client ID: 1769720748839593670, sequence num: 52, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 56 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 309167909479931851: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 56 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 60 Append 6 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: W, client ID: 1347532576216071615, sequence num: 60, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 61
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 61 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 617033193357959312: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 52 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 52, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 53
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 53 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 86 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 91 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 53
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 53 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 53, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 82 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 83 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 61
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 61 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 53
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 53 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 92 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 84 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: Z, client ID: 2199136536800998598, sequence num: 87, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 84, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: e, client ID: 501921243248122353, sequence num: 85
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: e, client ID: 501921243248122353, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: e, client ID: 501921243248122353, sequence num: 85
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: e, client ID: 501921243248122353, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: e, client ID: 501921243248122353, sequence num: 85
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: S, client ID: 3507021557023121440, sequence num: 93, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 56 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 61 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 53
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 53 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=64) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrWrongGroup
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 87 Append 0 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 56 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 61 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 61, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: p, client ID: 1347532576216071615, sequence num: 62
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 62 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: p, client ID: 1347532576216071615, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: p, client ID: 1347532576216071615, sequence num: 62
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 62 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 93 Append 1 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 56, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: N, client ID: 4217985405542925169, sequence num: 57
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 57 Append 4 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: N, client ID: 4217985405542925169, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: N, client ID: 4217985405542925169, sequence num: 57
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 57 Append 4 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 56 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 61 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 53 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 53 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 53, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 94, err: OK
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 53 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 53 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: e, client ID: 501921243248122353, sequence num: 85, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 53, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 86
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 54
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 54 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 86
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 54
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 54 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 86
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 62 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 57 Append 4 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: N, client ID: 4217985405542925169, sequence num: 57, err: OK
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 58
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 58 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 86, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 58
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 58 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 87
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: p, client ID: 1347532576216071615, sequence num: 62, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: B, client ID: 1347532576216071615, sequence num: 63
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 63 Append 6 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: B, client ID: 1347532576216071615, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 54
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 54 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 54, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: A, client ID: 1769720748839593670, sequence num: 54
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 54 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 88, err: OK
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 88 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 85 Append 9 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 94 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 86 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 73589017628862234: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 53 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 53 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 62 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 57 Append 4 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 62 Append 6 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 57 Append 4 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:56 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:56 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:56 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: B, client ID: 1347532576216071615, sequence num: 63
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 63 Append 6 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 54 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 58 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 54 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 58 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 54 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 54, err: OK
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 54 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 87, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 58, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: E, client ID: 501921243248122353, sequence num: 88
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 59
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 59 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 59
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 59 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: A, client ID: 1769720748839593670, sequence num: 54, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 55 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 55 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: E, client ID: 501921243248122353, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 54 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 58 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 54 Append 5 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 87 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: E, client ID: 501921243248122353, sequence num: 88
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: E, client ID: 501921243248122353, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: E, client ID: 501921243248122353, sequence num: 88
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: E, client ID: 501921243248122353, sequence num: 88, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: O, client ID: 3929044425438857535, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 55 Append 3 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: O, client ID: 3929044425438857535, sequence num: 55, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: O, client ID: 3929044425438857535, sequence num: 55
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 55 Append 3 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 89, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: I, client ID: 3507021557023121440, sequence num: 95, err: OK
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 89
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 89 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 95 Append 1 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 88 Append 9 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: len(cf.Configs):19
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 17, OpType:Join applied !!!
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 89 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 63 Append 6 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 59 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 55 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 55 Append 3 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 89, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 90
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: len(cf.Configs):19
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 63 Append 6 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 59 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 55 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 55 Append 3 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 59, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 60
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 60 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 60
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 60 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: O, client ID: 3929044425438857535, sequence num: 55, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 56 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 56 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 55, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 56 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 56, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 56
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 56 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: B, client ID: 1347532576216071615, sequence num: 63, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 64
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 64 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 64
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 64 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 90, err: OK
2025/01/07 12:55:56 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 96, err: OK
2025/01/07 12:55:56 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 90, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 617033193357959312: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 309167909479931851: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 96 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 90 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 73589017628862234: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: len(cf.Configs):20
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 18, OpType:Join applied !!!
2025/01/07 12:55:56 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 90 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:0 CN:4 rejects Op due to state=NotServing (C=3106988376836154902 Id=64) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: ErrWrongGroup
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 60 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 56 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 56, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 57
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 57 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 57
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 57 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 60 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 56 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 56 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 64 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 60, err: OK
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 61
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 61 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 61
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 61 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 56 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: F, client ID: 501921243248122353, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: F, client ID: 501921243248122353, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: F, client ID: 501921243248122353, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: F, client ID: 501921243248122353, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:56 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:56 MemoryConfigStateMachine.Join: len(cf.Configs):20
2025/01/07 12:55:56 *****************************************
2025/01/07 12:55:56 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: F, client ID: 501921243248122353, sequence num: 91
2025/01/07 12:55:56 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 60 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 56 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 56 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 64 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:56 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:56 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:56 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:56 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:56 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:56 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:56 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 64 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 91 Append 0 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: F, client ID: 501921243248122353, sequence num: 91, err: OK
2025/01/07 12:55:57 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 97, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: R, client ID: 2199136536800998598, sequence num: 91, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 97 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 91 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):18
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:57 *****************************************
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: len(cf.Configs):19
2025/01/07 12:55:57 *****************************************
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):19
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:57 *****************************************
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:57 MemoryConfigStateMachine.Join: len(cf.Configs):20
2025/01/07 12:55:57 *****************************************
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 57 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 61 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 61, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 62
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 92
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 62 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 56, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 62
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 62 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 92
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 92
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 64, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 65 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 65 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 57 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 61 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: Y, client ID: 3929044425438857535, sequence num: 57, err: OK
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 57 Append 3 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 62 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 65 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 65, err: OK
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 62 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 61 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 62 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 65 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: H, client ID: 1769720748839593670, sequence num: 57
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 57 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: H, client ID: 1769720748839593670, sequence num: 57, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: K, client ID: 3929044425438857535, sequence num: 58
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 58 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: K, client ID: 3929044425438857535, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: o, client ID: 1347532576216071615, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 66 Append 6 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: o, client ID: 1347532576216071615, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 62, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 98 Append 1 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 65 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 63 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 92 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 63 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: H, client ID: 1769720748839593670, sequence num: 57
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: K, client ID: 3929044425438857535, sequence num: 58
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: o, client ID: 1347532576216071615, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 66 Append 6 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 57 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: j, client ID: 3507021557023121440, sequence num: 98, err: OK
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 58 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 92, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 63 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 66 Append 6 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: o, client ID: 1347532576216071615, sequence num: 66, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: j, client ID: 1347532576216071615, sequence num: 67
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 67 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: j, client ID: 1347532576216071615, sequence num: 67, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: j, client ID: 1347532576216071615, sequence num: 67
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 67 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 63, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 63 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 64 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 66 Append 6 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 57 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 58 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 57 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 58 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: H, client ID: 1769720748839593670, sequence num: 57, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: K, client ID: 3929044425438857535, sequence num: 58, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 59
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 59 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 59
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 59 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 64
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 64 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 63 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: L, client ID: 3507021557023121440, sequence num: 99, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 92 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 66 Append 6 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 99 Append 1 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 57 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 58 Append 3 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 92, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 67 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 59 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 59, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: j, client ID: 1347532576216071615, sequence num: 67, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 64 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 67 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 59 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 64 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 64, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 93 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: H, client ID: 1769720748839593670, sequence num: 58
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 58 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: H, client ID: 1769720748839593670, sequence num: 58, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: H, client ID: 1769720748839593670, sequence num: 58
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 58 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 93, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 94
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 60
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 60 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 60
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 60 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 68
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 68 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 68, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 68
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 68 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 73589017628862234: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 67 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 59 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 64 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 94 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 65 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 94
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 94 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 58 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 60 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 60, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 61
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 61 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 61
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 61 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 58 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 60 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 68 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: H, client ID: 1769720748839593670, sequence num: 58, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: E, client ID: 1769720748839593670, sequence num: 59
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 59 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: E, client ID: 1769720748839593670, sequence num: 59, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: E, client ID: 1769720748839593670, sequence num: 59
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 59 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 68 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 68, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 69
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 69 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 69, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 69
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 69 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 58 Append 5 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 60 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 68 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 65 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 94
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 94 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 100, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 93, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 61 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 59 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: E, client ID: 1769720748839593670, sequence num: 59, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: f, client ID: 1769720748839593670, sequence num: 60
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 60 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: f, client ID: 1769720748839593670, sequence num: 60, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: f, client ID: 1769720748839593670, sequence num: 60
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 60 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 61, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 69 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 94 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 94, err: OK
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 94 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 62
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 62 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 65 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: Z, client ID: 4217985405542925169, sequence num: 65, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 66 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 66 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 60 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: f, client ID: 1769720748839593670, sequence num: 60, err: OK
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 617033193357959312: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 69, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 62
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 62 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 61
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 61 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 66 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 62 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 62, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 66, err: OK
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 61 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 61 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 63 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 63 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 70
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 70 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 70, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 70
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 70 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 309167909479931851: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 61, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:57 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 100 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 93 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 59 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 69 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 59 Append 5 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 65 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 69 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 60 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 66 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 61
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 61 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 62 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 63 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 70 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 70, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 63, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 63 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 70 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 65 Append 4 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 67
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: -, client ID: 1347532576216071615, sequence num: 71
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: S, client ID: 3929044425438857535, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 64 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: S, client ID: 3929044425438857535, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 60 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 66 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 62 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 63 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 70 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 67 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 67, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 71 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: -, client ID: 1347532576216071615, sequence num: 71, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 73589017628862234: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 95, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: _, client ID: 501921243248122353, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 95 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 61 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 61 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 61 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 61, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 62
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 62 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 62, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 62
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 62 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: S, client ID: 3929044425438857535, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 64 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: -, client ID: 1347532576216071615, sequence num: 71
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 71 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 67
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 67 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: _, client ID: 501921243248122353, sequence num: 96, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 64 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 62 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 62 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 64, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 96 Append 9 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 62 Append 5 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 64 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 71 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 67 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 64 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 71 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: -, client ID: 1347532576216071615, sequence num: 71, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: e, client ID: 1347532576216071615, sequence num: 72
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: e, client ID: 1347532576216071615, sequence num: 72, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: e, client ID: 1347532576216071615, sequence num: 72
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: Z, client ID: 1769720748839593670, sequence num: 62, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 63 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 63, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 63
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 63 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: S, client ID: 3929044425438857535, sequence num: 64, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 67 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 64 Append 3 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 71 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 67 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 65
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 65 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 65 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 65
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 65 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 67, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 68
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 68 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 68, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 68
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 68 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 101, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 94, err: OK
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: Y, client ID: 501921243248122353, sequence num: 97, err: OK
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 94 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 101 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 97 Append 9 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 98
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1901742611217616870: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 617033193357959312: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 4303071160654505955: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3221811481162482379: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3772254174042560840: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3155435859784829604: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2215488243507208326: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 1601405723411606176: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 63 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 73589017628862234: commandid: 7, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 65 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 65, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: e, client ID: 1347532576216071615, sequence num: 72, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 63, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 68 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 68, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 65 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 95, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 65 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 65, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 102 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 95 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 102, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 98 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 98, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:57 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:57 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:57 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 65 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 63 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 65 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 68 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:57 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:57 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:57 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:57 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:57 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:57 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:57 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:57 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:57 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103, err: OK
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:57 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:57 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrNotApplied
2025/01/07 12:55:57 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66, err: OK
2025/01/07 12:55:57 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:57 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:57 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96, err: OK
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:57 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73, err: OK
2025/01/07 12:55:57 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 73, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 883226758327578073: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 962354641614023038: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 309167909479931851: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:57 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:57 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:57 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:57 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64, err: ErrNotApplied
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 9, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 103 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 103, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 709616447909096656: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 96 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 96, err: OK
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:57 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:57 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:57 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:57 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:57 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:1 CN:3 rejects Op due to state=NotServing (C=3929044425438857535 Id=66) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66, err: ErrWrongGroup
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:2 CN:3 rejects Op due to state=NotServing (C=4217985405542925169 Id=69) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69, err: ErrWrongGroup
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=66) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrWrongGroup
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 129717324913002534: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:3 CN:3 rejects Op due to state=NotServing (C=1769720748839593670 Id=64) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64, err: ErrWrongGroup
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 883226758327578073: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 962354641614023038: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 10, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 709616447909096656: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 104, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 72 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 63 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 65 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 68 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 73 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 104 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 97 Append 0 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 99 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 99, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 100
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: b, client ID: 2199136536800998598, sequence num: 97, err: OK
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 100
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 100
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 105, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: f, client ID: 2199136536800998598, sequence num: 98, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 98 Append 0 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 100, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 105 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 100 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 962354641614023038: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 883226758327578073: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 309167909479931851: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 101, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 106, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 106 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 99, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 101 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 99 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: i, client ID: 1347532576216071615, sequence num: 74, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 75
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 75 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 100, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 75
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 102 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 107, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 100 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 74 Append 6 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 107 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 75 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 102, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 103
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 103
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: D, client ID: 501921243248122353, sequence num: 103
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 75 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 75, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 75 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 75 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 101 Append 0 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 108 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 108, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: Q, client ID: 2199136536800998598, sequence num: 101, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 103 Append 9 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: D, client ID: 501921243248122353, sequence num: 103, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 76
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 76 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 76, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 76
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 76 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 66 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 66, err: OK
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 67
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 67 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 67, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 67
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 67 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 69 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 69, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 70
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 70 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 70, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 70
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 70 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 76 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 67 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 70 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: Z, client ID: 501921243248122353, sequence num: 104, err: OK
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 109, err: OK
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: a, client ID: 2199136536800998598, sequence num: 102, err: OK
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 76 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 67 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 70 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 76 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 67 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 76, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 67, err: OK
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 70 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 70, err: OK
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 77
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 109 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 102 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 104 Append 9 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 77 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 77, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 68
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 68 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 105
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 68, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 71
2025/01/07 12:55:58 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 71 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 71, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 77
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 77 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: v, client ID: 3929044425438857535, sequence num: 68
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 68 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 71
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 71 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 65 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 77 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 77, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 68 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 71 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 77 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 68 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 71, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 71 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 78
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 78 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 78
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 78 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: p, client ID: 4217985405542925169, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 72 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: p, client ID: 4217985405542925169, sequence num: 72, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: p, client ID: 4217985405542925169, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 72 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: v, client ID: 3929044425438857535, sequence num: 68, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 77 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: x, client ID: 3929044425438857535, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 69 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: x, client ID: 3929044425438857535, sequence num: 69, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 68 Append 3 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 71 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: x, client ID: 3929044425438857535, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 69 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 103, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 103 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 105, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 110 Append 1 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 105 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: P, client ID: 3507021557023121440, sequence num: 110, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 106
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 962354641614023038: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 106
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 129717324913002534: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:58 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 883226758327578073: commandid: 3, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 64 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 64, err: OK
2025/01/07 12:55:58 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: f, client ID: 1769720748839593670, sequence num: 65
2025/01/07 12:55:58 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 65 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: f, client ID: 1769720748839593670, sequence num: 65, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: f, client ID: 1769720748839593670, sequence num: 65
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 65 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: o, client ID: 3507021557023121440, sequence num: 111, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 104, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 104 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 106, err: OK
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):21
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 19, OpType:Leave applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):21
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 14, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 78 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 72 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):21
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):21
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 78 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 72 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 69 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 65 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 69 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 65 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: f, client ID: 1769720748839593670, sequence num: 65, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 66
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 66 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 66, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 66
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 66 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 78, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 79
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 79 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 79, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 79
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 79 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 78 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 72 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 69 Append 3 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 65 Append 5 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 111 Append 1 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 106 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=66) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrWrongGroup
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: p, client ID: 4217985405542925169, sequence num: 72, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: x, client ID: 3929044425438857535, sequence num: 69, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 66 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 73
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 73 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 73, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 66 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 66 Append 5 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 79 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 79 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):22
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 20, OpType:Leave applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 962354641614023038: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 70
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 70 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 70, err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 5, client ID: 1769720748839593670, sequence num: 66, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: k, client ID: 1769720748839593670, sequence num: 67
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 67 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: k, client ID: 1769720748839593670, sequence num: 67, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: k, client ID: 1769720748839593670, sequence num: 67
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 67 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrNotApplied
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):20
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):21
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):21
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):22
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 112, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 105, err: OK
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 105 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 107, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 112 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 107 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 73
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 73 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 79 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 70
2025/01/07 12:55:58 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 67 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 73 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 67 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 73 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 70 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 79, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: k, client ID: 1347532576216071615, sequence num: 80
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 80 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: k, client ID: 1347532576216071615, sequence num: 80, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: k, client ID: 1347532576216071615, sequence num: 80
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 80 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 67 Append 5 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: k, client ID: 1769720748839593670, sequence num: 67, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: t, client ID: 1769720748839593670, sequence num: 68
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 68 Append 5 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: t, client ID: 1769720748839593670, sequence num: 68, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: t, client ID: 1769720748839593670, sequence num: 68
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 68 Append 5 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 73 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 73, err: OK
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Leave: len(cf.Configs):22
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 74 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 74 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 113, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 70 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 70 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 80 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: k, client ID: 1347532576216071615, sequence num: 80, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 70, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 71
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 71 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 71, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 71
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 71 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 68 Append 5 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 74 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 74, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 113 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 108 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 81
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 81 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 81, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 81
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 81 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 106 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: t, client ID: 1769720748839593670, sequence num: 68, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 106, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 108, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: V, client ID: 501921243248122353, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: V, client ID: 501921243248122353, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: V, client ID: 501921243248122353, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: V, client ID: 501921243248122353, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: V, client ID: 501921243248122353, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 80 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 68 Append 5 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 74 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 70 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 80 Append 6 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 68 Append 5 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 75
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 75 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 75
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 75 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 74 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 8, client ID: 1769720748839593670, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 69 Append 5 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 8, client ID: 1769720748839593670, sequence num: 69, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 8, client ID: 1769720748839593670, sequence num: 69
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 69 Append 5 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 71 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 81 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 71 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 81 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 75 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: I, client ID: 2199136536800998598, sequence num: 107, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 75 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 16, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 71 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 81 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: V, client ID: 501921243248122353, sequence num: 109, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 81, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 110
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 82
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 82 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 114, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 82
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 82 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 309167909479931851: commandid: 16, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 71, err: OK
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 72 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 72, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 75 Append 4 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 72 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: Y, client ID: 4217985405542925169, sequence num: 75, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 76
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 76 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 76, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 76
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 76 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 109 Append 9 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 107 Append 0 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 883226758327578073: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 4, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 962354641614023038: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:58 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 69 Append 5 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 82 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 2, client ID: 1347532576216071615, sequence num: 82, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 83
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 83 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 83, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 8, client ID: 1769720748839593670, sequence num: 69, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 114 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 69 Append 5 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 82 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 72 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 76 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 69 Append 5 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 82 Append 6 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 72 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 76 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):22
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 70
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 70 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 70, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 72 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 76 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 76, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: u, client ID: 4217985405542925169, sequence num: 77
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 77 Append 4 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: u, client ID: 4217985405542925169, sequence num: 77, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 72, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: u, client ID: 4217985405542925169, sequence num: 77
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 77 Append 4 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: B, client ID: 3929044425438857535, sequence num: 73
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 73 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: B, client ID: 3929044425438857535, sequence num: 73, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 83
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 83 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: B, client ID: 3929044425438857535, sequence num: 73
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 73 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 108 Append 0 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 110 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 110, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: len(cf.Configs):23
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 21, OpType:Join applied !!!
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: H, client ID: 3507021557023121440, sequence num: 115, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: c, client ID: 2199136536800998598, sequence num: 108, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 70
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 70 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 115 Append 1 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 111
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: len(cf.Configs):23
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: len(cf.Configs):23
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:58 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 116, err: OK
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 77 Append 4 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 83 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 83, err: OK
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:58 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:58 ShardKV.migrator(): S101-2 is leader: true !
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: u, client ID: 4217985405542925169, sequence num: 77, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 73 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: B, client ID: 3929044425438857535, sequence num: 73, err: OK
2025/01/07 12:55:58 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:58 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:58 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.isEligibleToUpdateShard: G101-2 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:58 ShardKV.InstallShard(): S101-2 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrNotApplied
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 84
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 84 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 77 Append 4 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 83 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 73 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 70 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 70, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 71
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 71 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 71, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 71
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 71 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 77 Append 4 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 83 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 73 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 70 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 70 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 74 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 74
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 74 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):23
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: len(cf.Configs):24
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 116 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: L, client ID: 4217985405542925169, sequence num: 78
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 78 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: L, client ID: 4217985405542925169, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: L, client ID: 4217985405542925169, sequence num: 78
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 78 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 71 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 71 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 111 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 111, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 74 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 3, client ID: 3929044425438857535, sequence num: 74, err: OK
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: l, client ID: 501921243248122353, sequence num: 112
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 71 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 74 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 78 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 117 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: O, client ID: 2199136536800998598, sequence num: 109, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 71, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 72 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 72, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 72
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 72 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 75
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 75 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 117, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 75
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 75 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 78 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: L, client ID: 4217985405542925169, sequence num: 78, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: D, client ID: 4217985405542925169, sequence num: 79
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 79 Append 4 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: D, client ID: 4217985405542925169, sequence num: 79, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: D, client ID: 4217985405542925169, sequence num: 79
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 79 Append 4 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: l, client ID: 501921243248122353, sequence num: 112, err: OK
2025/01/07 12:55:58 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: w, client ID: 1347532576216071615, sequence num: 84
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 84 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 109 Append 0 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 112 Append 9 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:58 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 113
2025/01/07 12:55:58 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 74 Append 3 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 78 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):23
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: len(cf.Configs):24
2025/01/07 12:55:58 *****************************************
2025/01/07 12:55:58 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 22, OpType:Join applied !!!
2025/01/07 12:55:58 MemoryConfigStateMachine.Query: len(cf.Configs):23
2025/01/07 12:55:58 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:55:59 *****************************************
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:55:59 MemoryConfigStateMachine.Join: len(cf.Configs):24
2025/01/07 12:55:59 *****************************************
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:0 CN:4 rejects Op due to state=NotServing (C=3106988376836154902 Id=66) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: ErrWrongGroup
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2186462120080169384: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3847357014073023245: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 118, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 110, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 72 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 75 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 75, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: c, client ID: 3929044425438857535, sequence num: 76
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 76 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: c, client ID: 3929044425438857535, sequence num: 76, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 113, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 110 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 118 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 113 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 962354641614023038: commandid: 6, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 4584626083758321571: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3491850522193473076: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2401011828226297295: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3578593688984384413: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 883226758327578073: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3746758550781822909: commandid: 5, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 72, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 73
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 73 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 73, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 73
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 73 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 79 Append 4 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 84 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: w, client ID: 1347532576216071615, sequence num: 84, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 85
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 85 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 72 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 75 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 85
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 85 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: D, client ID: 4217985405542925169, sequence num: 79, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 79 Append 4 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 84 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 80 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 80, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: c, client ID: 3929044425438857535, sequence num: 76
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 76 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 80 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 72 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 75 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 79 Append 4 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 84 Append 6 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 73 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 85 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 85, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: q, client ID: 1347532576216071615, sequence num: 86
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 86 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: q, client ID: 1347532576216071615, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 73 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 85 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: q, client ID: 1347532576216071615, sequence num: 86
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 86 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 73 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 85 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 76 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 80 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 76 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 73, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 76 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 80 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 80, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: c, client ID: 3929044425438857535, sequence num: 76, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 80 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 74
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 74 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 74, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 6, client ID: 4217985405542925169, sequence num: 81
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 81 Append 4 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 6, client ID: 4217985405542925169, sequence num: 81, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 6, client ID: 4217985405542925169, sequence num: 81
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 81 Append 4 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 114, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 74
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 74 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 77
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 77 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 77, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: E, client ID: 3507021557023121440, sequence num: 119, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 111, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 77
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 77 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 119 Append 1 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 114 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 111 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 86 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 81 Append 4 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 74 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 77 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 77, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 86 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 81 Append 4 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 74 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 77 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 4, client ID: 1769720748839593670, sequence num: 74, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 86 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: q, client ID: 1347532576216071615, sequence num: 86, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 81 Append 4 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 74 Append 5 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 77 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 17, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 309167909479931851: commandid: 17, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 6, client ID: 4217985405542925169, sequence num: 81, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.Kill() S100-0 is killed
2025/01/07 12:55:59 ShardKV.Kill() S100-1 is killed
2025/01/07 12:55:59 ShardKV.Kill() S100-2 is killed
2025/01/07 12:55:59 ShardKV.Kill() S101-0 is killed
2025/01/07 12:55:59 ShardKV.Kill() S101-1 is killed
2025/01/07 12:55:59 ShardKV.Kill() S101-2 is killed
2025/01/07 12:55:59 ShardKV.Kill() S102-0 is killed
2025/01/07 12:55:59 ShardKV.Kill() S102-1 is killed
2025/01/07 12:55:59 ShardKV.Kill() S102-2 is killed
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 167849970557182693: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 358320666584976769: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2746090158562821350: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3341899303947043787: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2085257199252501113: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 0, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87, err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 11, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 709616447909096656: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78, err: ErrNotApplied
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:4 CN:3 rejects Op due to state=NotServing (C=1347532576216071615 Id=87) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87, err: ErrWrongGroup
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: ErrNotApplied
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75, err: ErrNotApplied
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 129717324913002534: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 167849970557182693: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 16, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 15, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 358320666584976769: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2746090158562821350: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3341899303947043787: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2085257199252501113: commandid: 1, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 18, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 309167909479931851: commandid: 18, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: q, client ID: 3106988376836154902, sequence num: 66, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: p, client ID: 3106988376836154902, sequence num: 67
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 67 Append 2 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 66 Append 2 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 12, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 709616447909096656: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 75, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: M, client ID: 1769720748839593670, sequence num: 76
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 76 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: M, client ID: 1769720748839593670, sequence num: 76, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: M, client ID: 1769720748839593670, sequence num: 76
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 76 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: I, client ID: 3929044425438857535, sequence num: 78, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: i, client ID: 3929044425438857535, sequence num: 79
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 79 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: i, client ID: 3929044425438857535, sequence num: 79, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: i, client ID: 3929044425438857535, sequence num: 79
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 79 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 75 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 78 Append 3 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 16, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 82 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 82, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 83
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 83 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 83, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 83
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 83 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 67 Append 2 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: p, client ID: 3106988376836154902, sequence num: 67, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: -, client ID: 3106988376836154902, sequence num: 68
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 68 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 76 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 76 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 79 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 83 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 76 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 79 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 83 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 79 Append 3 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: i, client ID: 3929044425438857535, sequence num: 79, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 83 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 67 Append 2 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 68 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: -, client ID: 3106988376836154902, sequence num: 68, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: T, client ID: 3106988376836154902, sequence num: 69
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 69 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: M, client ID: 1769720748839593670, sequence num: 76, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: W, client ID: 1769720748839593670, sequence num: 77
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 77 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: W, client ID: 1769720748839593670, sequence num: 77, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: W, client ID: 1769720748839593670, sequence num: 77
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 77 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 167849970557182693: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 68 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 69 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: T, client ID: 3106988376836154902, sequence num: 69, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: Y, client ID: 3106988376836154902, sequence num: 70
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 70 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 69 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 83, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 84
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 84 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 77 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: W, client ID: 1769720748839593670, sequence num: 77, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: M, client ID: 1769720748839593670, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 78 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: M, client ID: 1769720748839593670, sequence num: 78, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: M, client ID: 1769720748839593670, sequence num: 78
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 78 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 77 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 77 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 78 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 78 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 78 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: M, client ID: 1769720748839593670, sequence num: 78, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: O, client ID: 1769720748839593670, sequence num: 79
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 79 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: O, client ID: 1769720748839593670, sequence num: 79, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: O, client ID: 1769720748839593670, sequence num: 79
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 79 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 80 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 80, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 80 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 67 Append 2 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 68 Append 2 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 69 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 112, err: OK
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 112 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 120 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 79 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 80 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 80, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 81
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 81 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 81, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 81
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 81 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 79 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 80 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: O, client ID: 1769720748839593670, sequence num: 79, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: z, client ID: 1769720748839593670, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 80 Append 5 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 120, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 70 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 70 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: Y, client ID: 3106988376836154902, sequence num: 70, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 71
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 71 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 70 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 84
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 84 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 71 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 71, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 8, client ID: 3106988376836154902, sequence num: 72
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 72 Append 2 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 71 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 71 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: z, client ID: 1769720748839593670, sequence num: 80, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: z, client ID: 1769720748839593670, sequence num: 80
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 80 Append 5 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 79 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 80 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 81 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 84 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 84, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: o, client ID: 4217985405542925169, sequence num: 85
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 85 Append 4 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: o, client ID: 4217985405542925169, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 81, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: o, client ID: 4217985405542925169, sequence num: 85
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 81 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 85 Append 4 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 121 Append 1 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 113 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 82 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 113, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 84 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 72 Append 2 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 8, client ID: 3106988376836154902, sequence num: 72, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 73
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 73 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 72 Append 2 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 1, client ID: 3507021557023121440, sequence num: 121, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 72 Append 2 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 73 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: Z, client ID: 3106988376836154902, sequence num: 73, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 80 Append 5 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 85 Append 4 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: o, client ID: 4217985405542925169, sequence num: 85, err: OK
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 73 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 73 Append 2 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 80 Append 5 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 85 Append 4 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: z, client ID: 1769720748839593670, sequence num: 80, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: f, client ID: 3106988376836154902, sequence num: 74
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 74 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 81 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 86
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 86 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 86
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 86 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 82
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 82 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 84 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 80 Append 5 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 85 Append 4 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 74 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: f, client ID: 3106988376836154902, sequence num: 74, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: h, client ID: 3106988376836154902, sequence num: 75
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 75 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 74 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 114, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 122, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 74 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 86 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:55:59 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 75 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 86 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 75 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 82 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 75 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: h, client ID: 3106988376836154902, sequence num: 75, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: f, client ID: 3106988376836154902, sequence num: 76
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 76 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 3341899303947043787: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 358320666584976769: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2085257199252501113: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 13, OpType:Query applied !!!
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardCtrler.applier: clerkid 2746090158562821350: commandid: 2, OpType:Query applied !!!
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: X, client ID: 1769720748839593670, sequence num: 81
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 81 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: X, client ID: 1769720748839593670, sequence num: 81, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 86 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 82 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:55:59 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 122 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 114 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:55:59 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:55:59 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:55:59 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 115 Append 0 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: W, client ID: 2199136536800998598, sequence num: 115, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:55:59 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 82 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 82, err: OK
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: M, client ID: 3929044425438857535, sequence num: 83
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 83 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: M, client ID: 3929044425438857535, sequence num: 83, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: M, client ID: 3929044425438857535, sequence num: 83
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 83 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:55:59 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116
2025/01/07 12:55:59 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:55:59 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 76 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 116, err: OK
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 76 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: f, client ID: 3106988376836154902, sequence num: 76, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: r, client ID: 3106988376836154902, sequence num: 77
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 77 Append 2 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 86, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 87 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: T, client ID: 4217985405542925169, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 87 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 76 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 115
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 115 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 115, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 116
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 116
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 77 Append 2 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: r, client ID: 3106988376836154902, sequence num: 77, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: y, client ID: 3106988376836154902, sequence num: 78
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 78 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 77 Append 2 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 77 Append 2 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):25
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 23, OpType:Leave applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 87 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 87, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 88 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 88 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: X, client ID: 1769720748839593670, sequence num: 81
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 81 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 78 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 78 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):24
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):25
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: k, client ID: 3507021557023121440, sequence num: 123, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 83 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: M, client ID: 3929044425438857535, sequence num: 83, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 84
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 84 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 84
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 84 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 83 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 87 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 88 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 81 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 78 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 87 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 88 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 88, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 89 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 89 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: y, client ID: 3106988376836154902, sequence num: 78, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 116
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 79
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 79 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: T, client ID: 4217985405542925169, sequence num: 87, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: n, client ID: 4217985405542925169, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 88 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: n, client ID: 4217985405542925169, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: n, client ID: 4217985405542925169, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 88 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 81 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 84 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 84, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 85
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 85 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 85
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 85 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: X, client ID: 1769720748839593670, sequence num: 81, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 82
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 82 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 82, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 82
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 82 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 89 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 89, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 90
2025/01/07 12:56:00 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 90 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 123 Append 1 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 116 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 90
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 90 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):25
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 83 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 87 Append 4 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 88 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 81 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 167849970557182693: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 309167909479931851: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):26
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 84 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 89 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 88 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 85 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 82 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 90 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 88 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 85 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 85, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 86
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 86 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 86
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 86 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 84 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: n, client ID: 4217985405542925169, sequence num: 88, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 82 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):26
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 24, OpType:Leave applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 124 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 89 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 88 Append 4 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 85 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 116 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 90 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 117 Append 0 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: L, client ID: 2199136536800998598, sequence num: 117, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 4, client ID: 1347532576216071615, sequence num: 90, err: OK
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):25
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 82, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 89 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 82 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 90 Append 6 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 116, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: L, client ID: 501921243248122353, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: L, client ID: 501921243248122353, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: L, client ID: 501921243248122353, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: L, client ID: 501921243248122353, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: L, client ID: 501921243248122353, sequence num: 117
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 124, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Leave: len(cf.Configs):26
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 83
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 83 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 79 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 83, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: K, client ID: 4217985405542925169, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 89 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 79 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 79 Append 2 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 86 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: S, client ID: 2199136536800998598, sequence num: 118, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 7, client ID: 1347532576216071615, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 91 Append 6 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 7, client ID: 1347532576216071615, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 7, client ID: 1347532576216071615, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 91 Append 6 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 125, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 118 Append 0 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 117 Append 9 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 125 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 86 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 89 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 91 Append 6 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 9, client ID: 3106988376836154902, sequence num: 79, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: t, client ID: 3106988376836154902, sequence num: 80
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 80 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3341899303947043787: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2746090158562821350: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 358320666584976769: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 86 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 86, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: R, client ID: 3929044425438857535, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 87 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: R, client ID: 3929044425438857535, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: R, client ID: 3929044425438857535, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 87 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 83
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 83 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 89 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 91 Append 6 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 7, client ID: 1347532576216071615, sequence num: 91, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: q, client ID: 1347532576216071615, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 92 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: q, client ID: 1347532576216071615, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: q, client ID: 1347532576216071615, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 92 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 89 Append 4 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 91 Append 6 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: L, client ID: 501921243248122353, sequence num: 117, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: K, client ID: 4217985405542925169, sequence num: 89, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 90
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 90 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 90
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 90 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 87 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 83 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: R, client ID: 3929044425438857535, sequence num: 87, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 92 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 90 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 90, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 83, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: X, client ID: 3929044425438857535, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 88 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: X, client ID: 3929044425438857535, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 91 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2085257199252501113: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 167849970557182693: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 80 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: t, client ID: 3106988376836154902, sequence num: 80, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: y, client ID: 3106988376836154902, sequence num: 81
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 81 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 80 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: O, client ID: 3507021557023121440, sequence num: 126, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 87 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 83 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 92 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 90 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 80 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: q, client ID: 1347532576216071615, sequence num: 92, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 118
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 118
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 118, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 118
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 91 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 119 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 119, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 126 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 87 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 83 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: X, client ID: 3929044425438857535, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 88 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 92 Append 6 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 93
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 84
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 84 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 84, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 90 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 93 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 84
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 84 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 81 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: y, client ID: 3106988376836154902, sequence num: 81, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: N, client ID: 3106988376836154902, sequence num: 82
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 82 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 81 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 81 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 91 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 88 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: X, client ID: 3929044425438857535, sequence num: 88, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 89 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 89 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 91, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 92 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 91 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 88 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 84 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 118, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 119, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 119
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 127, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 84 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 84, err: OK
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 93 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 127 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 118 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 120 Append 0 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 89 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 89 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: j, client ID: 2199136536800998598, sequence num: 120, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 91 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 88 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 84 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 89 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 85
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 85 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 85, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 89, err: OK
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 90
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 92 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 119 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 85
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 85 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 119, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 82 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: N, client ID: 3106988376836154902, sequence num: 82, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 3, client ID: 3106988376836154902, sequence num: 83
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 83 Append 2 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 90 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 82 Append 2 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 90
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 90 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 83 Append 2 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 3, client ID: 3106988376836154902, sequence num: 83, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 0, client ID: 3106988376836154902, sequence num: 84
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 84 Append 2 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 83 Append 2 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 83 Append 2 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 93 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 92 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 92, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 5, client ID: 1347532576216071615, sequence num: 93, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 85 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 85, err: OK
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 121 Append 0 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 128 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: z, client ID: 2199136536800998598, sequence num: 121, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 128, err: OK
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):26
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 93 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 93 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: F, client ID: 1347532576216071615, sequence num: 94
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 94 Append 6 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: F, client ID: 1347532576216071615, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 7, client ID: 1769720748839593670, sequence num: 86
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 86 Append 5 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 7, client ID: 1769720748839593670, sequence num: 86, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 7, client ID: 1769720748839593670, sequence num: 86
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 86 Append 5 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 90 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 90, err: OK
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):27
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 91 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):27
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 93 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):27
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 92 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 85 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 93 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 86 Append 5 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 84 Append 2 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 0, client ID: 3106988376836154902, sequence num: 84, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: l, client ID: 3106988376836154902, sequence num: 85
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 85 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 84 Append 2 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 84 Append 2 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 93 Append 6 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 92 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 85 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 90 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 93 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 86 Append 5 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 120, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 25, OpType:Join applied !!!
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 93 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 358320666584976769: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2746090158562821350: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 86 Append 5 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 7, client ID: 1769720748839593670, sequence num: 86, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 87 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 87, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 87 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 93, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 94
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 94 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 94
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 94 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: F, client ID: 1347532576216071615, sequence num: 94
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 94 Append 6 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 91
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 91 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 122, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1744896698124024150: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 309167909479931851: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3341899303947043787: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2085257199252501113: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 167849970557182693: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):27
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 85 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: l, client ID: 3106988376836154902, sequence num: 85, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: m, client ID: 3106988376836154902, sequence num: 86
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 86 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 87 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 94 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 94, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 95
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 95 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 95
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 95 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 120 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:00 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 87 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 94 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 94 Append 6 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 91 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 85 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 129, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 87, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: O, client ID: 1769720748839593670, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 88 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 94 Append 6 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 91 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 91, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 85 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: F, client ID: 1347532576216071615, sequence num: 94, err: OK
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 122 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):28
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 26, OpType:Join applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3296233124225668316: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: O, client ID: 1769720748839593670, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 129 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 92 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: P, client ID: 3929044425438857535, sequence num: 92
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 92 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 87 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 94 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 94 Append 6 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 91 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):28
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 4245355925920980692: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: O, client ID: 1769720748839593670, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 88 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 86 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: m, client ID: 3106988376836154902, sequence num: 86, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 86 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: v, client ID: 1347532576216071615, sequence num: 95
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 95 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: v, client ID: 1347532576216071615, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: v, client ID: 1347532576216071615, sequence num: 95
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 95 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 86 Append 2 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: O, client ID: 3106988376836154902, sequence num: 87
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 87 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:00 MemoryConfigStateMachine.Join: len(cf.Configs):28
2025/01/07 12:56:00 *****************************************
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 123, err: OK
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 2, client ID: 501921243248122353, sequence num: 121, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: C, client ID: 501921243248122353, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: C, client ID: 501921243248122353, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: C, client ID: 501921243248122353, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: C, client ID: 501921243248122353, sequence num: 122, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 121 Append 9 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 123 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 130 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 95 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: C, client ID: 501921243248122353, sequence num: 122
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 92 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 130, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 95 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 92 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 88 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 95 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 88 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:00 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 95 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 95 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 92 Append 3 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 88 Append 5 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:00 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 95 Append 6 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 87 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: O, client ID: 3106988376836154902, sequence num: 87, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 87 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 87 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 124 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 122 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: O, client ID: 1769720748839593670, sequence num: 88, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: v, client ID: 1347532576216071615, sequence num: 95, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: P, client ID: 3929044425438857535, sequence num: 92, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 95, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:00 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:00 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 is leader: true !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: C, client ID: 501921243248122353, sequence num: 122, err: OK
2025/01/07 12:56:00 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 131 Append 1 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 124, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: D, client ID: 3507021557023121440, sequence num: 131, err: OK
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 123, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 123
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.Kill() S100-0 is killed
2025/01/07 12:56:00 ShardKV.Kill() S100-1 is killed
2025/01/07 12:56:00 ShardKV.Kill() S100-2 is killed
2025/01/07 12:56:00 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.Kill() S101-0 is killed
2025/01/07 12:56:00 ShardKV.Kill() S101-1 is killed
2025/01/07 12:56:00 ShardKV.Kill() S101-2 is killed
2025/01/07 12:56:00 ShardKV.Kill() S102-0 is killed
2025/01/07 12:56:00 ShardKV.Kill() S102-1 is killed
2025/01/07 12:56:00 ShardKV.Kill() S102-2 is killed
2025/01/07 12:56:00 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: OK
2025/01/07 12:56:00 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:00 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:00 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:00 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:00 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:00 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:00 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:00 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:00 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:00 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrNotApplied
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1534850135434609445: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 358320666584976769: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 212583169902968938: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 648982299758451378: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:00 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:00 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: ErrNotApplied
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 709616447909096656: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:2 CN:3 rejects Op due to state=NotServing (C=4217985405542925169 Id=96) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrWrongGroup
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:00 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:00 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: ErrWrongLeader
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:00 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 123, err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 129717324913002534: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 123
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=88) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: ErrWrongGroup
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 212583169902968938: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 648982299758451378: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 309167909479931851: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:01 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 123, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 124
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 124 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 123 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 709616447909096656: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 93, err: OK
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 89, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: U, client ID: 1347532576216071615, sequence num: 96, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 89 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 93 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 96 Append 6 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 124 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 124 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 132 Append 1 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 125 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 125, err: OK
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 126
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 126 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 124, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: n, client ID: 3507021557023121440, sequence num: 132, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: T, client ID: 3507021557023121440, sequence num: 133
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 133 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: r, client ID: 501921243248122353, sequence num: 125
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 125 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 126 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 126, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: k, client ID: 2199136536800998598, sequence num: 127
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 127 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 126 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 133 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 125 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: r, client ID: 501921243248122353, sequence num: 125, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 126
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 126 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: T, client ID: 3507021557023121440, sequence num: 133, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 133 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 125 Append 9 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 127 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 126 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 127 Append 0 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 126 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 126, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Q, client ID: 501921243248122353, sequence num: 127
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 127 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 134
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 134 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: k, client ID: 2199136536800998598, sequence num: 127, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 127 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 134 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 134, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 135
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 135 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 127 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 134 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 135 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 90, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: J, client ID: 3929044425438857535, sequence num: 94, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: I, client ID: 1347532576216071615, sequence num: 97, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 90 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 94 Append 3 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 97 Append 6 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Q, client ID: 501921243248122353, sequence num: 127, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: M, client ID: 501921243248122353, sequence num: 128
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 128 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 135 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: r, client ID: 2199136536800998598, sequence num: 128
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 128 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 135, err: OK
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: s, client ID: 1769720748839593670, sequence num: 91, err: OK
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 136
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 136 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: e, client ID: 1347532576216071615, sequence num: 98, err: OK
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: b, client ID: 3929044425438857535, sequence num: 95, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 98 Append 6 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 91 Append 5 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 95 Append 3 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 96 Append 4 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 92 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 128 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 92, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 128 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: r, client ID: 2199136536800998598, sequence num: 128, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 8, client ID: 2199136536800998598, sequence num: 129
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 129 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 128 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: G, client ID: 4217985405542925169, sequence num: 96, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 96 Append 3 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: M, client ID: 501921243248122353, sequence num: 128, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: G, client ID: 501921243248122353, sequence num: 129
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 129 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 136 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: a, client ID: 3929044425438857535, sequence num: 96, err: OK
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 135 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 128 Append 9 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 128 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 136 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 128 Append 0 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 136 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 99 Append 6 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 93 Append 5 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 648982299758451378: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 212583169902968938: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:01 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 129 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 129 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 97 Append 4 r {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: r, client ID: 4217985405542925169, sequence num: 97, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: d, client ID: 1769720748839593670, sequence num: 93, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 97 Append 3 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: E, client ID: 3929044425438857535, sequence num: 97, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: 6, client ID: 1347532576216071615, sequence num: 99, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 129 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 8, client ID: 2199136536800998598, sequence num: 129, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 129 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 129 Append 0 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 129 Append 9 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: G, client ID: 501921243248122353, sequence num: 129, err: OK
2025/01/07 12:56:01 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 130
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 130 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 136, err: OK
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 137
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 137 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 130
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 130 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: W, client ID: 3929044425438857535, sequence num: 98, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 94, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: S, client ID: 1347532576216071615, sequence num: 100, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 130 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 130 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 137 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 137 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 130 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 130 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 137, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 5, client ID: 2199136536800998598, sequence num: 130, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 130 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 137 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 130 Append 0 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 94 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 98 Append 3 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 100 Append 6 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:01 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):28
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 130, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Q, client ID: 501921243248122353, sequence num: 131
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 131 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 95, err: OK
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 138
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 138 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 131 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Q, client ID: 501921243248122353, sequence num: 131, err: OK
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 98, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: s, client ID: 2199136536800998598, sequence num: 131
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 131 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 99, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:01 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: x, client ID: 501921243248122353, sequence num: 132
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 132 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 98 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 95 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:01 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 99 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 131 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 131 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 138 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 131 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 138 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 132 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 131 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:01 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:01 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: s, client ID: 2199136536800998598, sequence num: 131, err: OK
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 132
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 132 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:01 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:01 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 138 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 138, err: OK
2025/01/07 12:56:01 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 131 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 132 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:01 *****************************************
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: len(cf.Configs):29
2025/01/07 12:56:01 *****************************************
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:01 *****************************************
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:01 MemoryConfigStateMachine.Leave: len(cf.Configs):29
2025/01/07 12:56:01 *****************************************
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: x, client ID: 501921243248122353, sequence num: 132, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: P, client ID: 501921243248122353, sequence num: 133
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 133 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 139
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 139 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: Q, client ID: 4217985405542925169, sequence num: 99, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 132 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 133 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: A, client ID: 1347532576216071615, sequence num: 101, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: P, client ID: 501921243248122353, sequence num: 133, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 134
2025/01/07 12:56:01 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 134 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 132 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:01 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 132, err: OK
2025/01/07 12:56:01 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 139 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 139, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 133
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 133 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 132 Append 9 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 133 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 139 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 132 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 133 Append 9 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 99 Append 4 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 139 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 101 Append 6 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: O, client ID: 3507021557023121440, sequence num: 140
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 140 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: S, client ID: 4217985405542925169, sequence num: 100, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 134 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 134 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 134 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 100 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 100, err: OK
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: len(cf.Configs):29
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 27, OpType:Leave applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 133 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 133, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 134
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 134 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 133 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 140 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 309167909479931851: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:02 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 133 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 140 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 100 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 134, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 140 Append 1 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:02 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: O, client ID: 3507021557023121440, sequence num: 140, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=88) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 141
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 141 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: S, client ID: 501921243248122353, sequence num: 135
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 135 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 134 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 96 Append 5 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 102 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: J, client ID: 1347532576216071615, sequence num: 102, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 134, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 135
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 135 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: h, client ID: 1769720748839593670, sequence num: 96, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 134 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 141 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 135 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: S, client ID: 501921243248122353, sequence num: 135, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 136
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 136 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 134 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 141 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 135 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 141, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 142
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 142 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 141 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 135 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 212583169902968938: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 648982299758451378: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):29
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: len(cf.Configs):30
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 28, OpType:Leave applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 135 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 136 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 136, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: S, client ID: 501921243248122353, sequence num: 137
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 137 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 142 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 135, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 136
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 136 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 142, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 143
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 143 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 135 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 135 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 101 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 137 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 136 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 142 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 137 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 136 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: len(cf.Configs):30
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 143 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 136 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Leave: len(cf.Configs):30
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 103 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: C, client ID: 1347532576216071615, sequence num: 103, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: k, client ID: 3929044425438857535, sequence num: 101, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 136 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 143 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 142 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 143, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 101 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 101, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 97 Append 5 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: q, client ID: 1769720748839593670, sequence num: 97, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 136, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: S, client ID: 501921243248122353, sequence num: 137, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 137 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 136 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 143 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: I, client ID: 501921243248122353, sequence num: 138
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 138 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: U, client ID: 2199136536800998598, sequence num: 137
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 137 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 104 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 102 Append 3 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: C, client ID: 3929044425438857535, sequence num: 102, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: d, client ID: 1347532576216071615, sequence num: 104, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 102 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 102, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 144
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 144 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 105 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 105 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 105 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 138 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 137 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: U, client ID: 2199136536800998598, sequence num: 137, err: OK
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 105 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: 0, client ID: 1347532576216071615, sequence num: 105, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: D, client ID: 1769720748839593670, sequence num: 98, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 138 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 137 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 144 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 98 Append 5 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: I, client ID: 501921243248122353, sequence num: 138, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 139
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 139 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 144 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 144, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 145
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 145 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: g, client ID: 1347532576216071615, sequence num: 106, err: OK
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: p, client ID: 3929044425438857535, sequence num: 103, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 99, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 138 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 103, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 137 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 144 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 138
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 138 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 105 Append 6 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 103 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 106 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 103 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 99 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: 8, client ID: 1347532576216071615, sequence num: 107, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 100, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 104, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 100 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 107 Append 6 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 104 Append 4 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 104 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 139 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 145 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 145, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 139, err: OK
2025/01/07 12:56:02 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: a, client ID: 3507021557023121440, sequence num: 146
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 146 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: f, client ID: 4217985405542925169, sequence num: 104, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 139 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 145 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 138 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 101 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 212583169902968938: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 648982299758451378: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 309167909479931851: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 101, err: OK
2025/01/07 12:56:02 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 138 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 108, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 146 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 9, client ID: 3929044425438857535, sequence num: 105, err: OK
2025/01/07 12:56:02 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: E, client ID: 4217985405542925169, sequence num: 105, err: OK
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 146 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: a, client ID: 3507021557023121440, sequence num: 146, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 147
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 147 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 138, err: OK
2025/01/07 12:56:02 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: S, client ID: 501921243248122353, sequence num: 140
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 140 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:02 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 139 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 145 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 138 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 146 Append 1 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 105 Append 3 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 108 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 105 Append 4 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:02 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: a, client ID: 2199136536800998598, sequence num: 139
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 139 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 147 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: 0, client ID: 1769720748839593670, sequence num: 102, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: R, client ID: 4217985405542925169, sequence num: 106, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 140 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 147 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 139 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 140 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 139 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 147 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 140 Append 9 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: S, client ID: 501921243248122353, sequence num: 140, err: OK
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 147, err: OK
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 106, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 106 Append 4 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:0 CN:4 rejects Op due to state=NotServing (C=3106988376836154902 Id=88) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: ErrWrongGroup
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 102 Append 5 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 106 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 148
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 148 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 139 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: a, client ID: 2199136536800998598, sequence num: 139, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: U, client ID: 2199136536800998598, sequence num: 140
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 140 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: Q, client ID: 501921243248122353, sequence num: 141
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 141 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 107, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 109 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 107 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 148 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 140 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: U, client ID: 2199136536800998598, sequence num: 140, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 141
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 141 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 148 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 140 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 109, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 103 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 107 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 107, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 148, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 141 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 141 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 148 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 140 Append 0 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 141 Append 9 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: Q, client ID: 501921243248122353, sequence num: 141, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 142
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 142 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 103, err: OK
2025/01/07 12:56:02 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: b, client ID: 4217985405542925169, sequence num: 108, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: d, client ID: 3929044425438857535, sequence num: 108, err: OK
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 141 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 108 Append 4 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 108 Append 3 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 141 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 142 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 141 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 142 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:02 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 142 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 142, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: F, client ID: 501921243248122353, sequence num: 143
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 143 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 149
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 149 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 141, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: B, client ID: 2199136536800998598, sequence num: 142
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 142 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: len(cf.Configs):31
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 29, OpType:Join applied !!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 ShardCtrler.applier: clerkid 212583169902968938: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:02 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:02 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:02 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:02 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: z, client ID: 3929044425438857535, sequence num: 109, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: len(cf.Configs):31
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 143 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 149 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 142 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:02 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 143 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 149 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 149, err: OK
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: e, client ID: 3507021557023121440, sequence num: 150
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 150 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: F, client ID: 501921243248122353, sequence num: 143, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 143 Append 9 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 149 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 142 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: C, client ID: 501921243248122353, sequence num: 144
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 144 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:02 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 150 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 144 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 150 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 144 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 142 Append 0 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 150 Append 1 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 144 Append 9 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: C, client ID: 501921243248122353, sequence num: 144, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 9, client ID: 501921243248122353, sequence num: 145
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 145 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: B, client ID: 2199136536800998598, sequence num: 142, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: X, client ID: 4217985405542925169, sequence num: 109, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: y, client ID: 2199136536800998598, sequence num: 143
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 143 Append 0 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: e, client ID: 3507021557023121440, sequence num: 150, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: c, client ID: 3507021557023121440, sequence num: 151
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 151 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: C, client ID: 1769720748839593670, sequence num: 104, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: j, client ID: 1347532576216071615, sequence num: 110, err: OK
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: t, client ID: 3929044425438857535, sequence num: 110, err: OK
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 109 Append 4 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 109 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 110 Append 6 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 104 Append 5 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105, err: ErrWrongLeader
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):30
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: adds new groups: map[102:[server-102-0 server-102-1 server-102-2]] to the configuration 
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: map[102:[server-102-0 server-102-1 server-102-2]] succuss!!!
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 0 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:02 MemoryConfigStateMachine.Join: len(cf.Configs):31
2025/01/07 12:56:02 *****************************************
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 110 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:02 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111
2025/01/07 12:56:02 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 145 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 143 Append 0 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: y, client ID: 2199136536800998598, sequence num: 143, err: OK
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 648982299758451378: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 144
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 144 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 145 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 143 Append 0 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 151 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 145 Append 9 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 143 Append 0 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 151 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 110, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):31
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 144 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: o, client ID: 1769720748839593670, sequence num: 105, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 144 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: z, client ID: 1347532576216071615, sequence num: 111, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 105 Append 5 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 110 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 111 Append 3 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 111 Append 6 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 5, client ID: 3929044425438857535, sequence num: 111, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: len(cf.Configs):32
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 9, client ID: 501921243248122353, sequence num: 145, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 151 Append 1 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 146
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 146 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: c, client ID: 3507021557023121440, sequence num: 151, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 144 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 144, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: len(cf.Configs):32
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 30, OpType:Join applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 152
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 152 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 145
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 145 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 309167909479931851: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: adds new groups: map[101:[server-101-0 server-101-1 server-101-2]] to the configuration 
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: map[101:[server-101-0 server-101-1 server-101-2]] succuss!!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 0 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 5 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 6 -> GID: 101
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:03 MemoryConfigStateMachine.Join: len(cf.Configs):32
2025/01/07 12:56:03 *****************************************
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 146 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 152 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 2, client ID: 3507021557023121440, sequence num: 152, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 153 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 146 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 152 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 145 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: -, client ID: 4217985405542925169, sequence num: 111, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 112 Append 6 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 212583169902968938: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 106 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 106, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: A, client ID: 3929044425438857535, sequence num: 112, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 88 Append 2 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: J, client ID: 3106988376836154902, sequence num: 88, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: H, client ID: 1347532576216071615, sequence num: 112, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 111 Append 4 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 112 Append 3 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 146 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 152 Append 1 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 145 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 153 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 153 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 145 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 153 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 153, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 146, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 154
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 154 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 145, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: U, client ID: 501921243248122353, sequence num: 147
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 147 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 146
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 146 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:03 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: f, client ID: 3106988376836154902, sequence num: 89
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 89 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: f, client ID: 3106988376836154902, sequence num: 89, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: f, client ID: 3106988376836154902, sequence num: 89
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 89 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 112, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 113, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 107, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: Z, client ID: 3929044425438857535, sequence num: 113, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 113 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 154 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 147 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 8, client ID: 3507021557023121440, sequence num: 154, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 154 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 155
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 155 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 146 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 147 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 146 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 154 Append 1 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 147 Append 9 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 146 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 89 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: U, client ID: 501921243248122353, sequence num: 147, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 146, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 89 Append 2 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: f, client ID: 3106988376836154902, sequence num: 89, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 112 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 113 Append 3 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 107 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 648982299758451378: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: i, client ID: 3106988376836154902, sequence num: 90
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 90 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: i, client ID: 3106988376836154902, sequence num: 90, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: i, client ID: 3106988376836154902, sequence num: 90
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 90 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 147
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 147 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 155 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 147 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 3, client ID: 2199136536800998598, sequence num: 147, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: l, client ID: 2199136536800998598, sequence num: 148
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 148 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 155 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 147 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 90 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: i, client ID: 3106988376836154902, sequence num: 90, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: C, client ID: 3106988376836154902, sequence num: 91
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 91 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 155 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 147 Append 0 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 90 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 155, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 156
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 156 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: C, client ID: 3106988376836154902, sequence num: 91, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: C, client ID: 3106988376836154902, sequence num: 91
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 91 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 90 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 148
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 148 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 113, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 148 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 91 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: C, client ID: 3106988376836154902, sequence num: 91, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 92
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 92 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 92, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 92
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 92 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 156 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 156, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 157
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 157 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 91 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 91 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 148 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 156 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 148 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: l, client ID: 2199136536800998598, sequence num: 148, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 149
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 149 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 148 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 148, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 3, client ID: 501921243248122353, sequence num: 149
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 149 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 148 Append 0 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 156 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 148 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 114, err: OK
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 114 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 113 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 92 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 92 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 92 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 157 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 149 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 149, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 150
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 150 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 7, client ID: 3507021557023121440, sequence num: 157, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 157 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 149 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 149 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 149 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 3, client ID: 501921243248122353, sequence num: 149, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: I, client ID: 501921243248122353, sequence num: 150
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 150 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 114 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 114 Append 4 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 7, client ID: 4217985405542925169, sequence num: 114, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 114, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 157 Append 1 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 92, err: OK
2025/01/07 12:56:03 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 is leader: true !
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 149 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 150 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 150 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115
2025/01/07 12:56:03 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 is leader: true !
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:03 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: h, client ID: 3106988376836154902, sequence num: 93
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 150 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 150 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 108 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 149 Append 9 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 93 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: h, client ID: 3106988376836154902, sequence num: 93, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: h, client ID: 3106988376836154902, sequence num: 93
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 93 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 150 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 150 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: I, client ID: 501921243248122353, sequence num: 150, err: OK
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 is leader: true !
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 158
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 151
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 151 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 150, err: OK
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 108, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 93 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: h, client ID: 3106988376836154902, sequence num: 93, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: K, client ID: 3106988376836154902, sequence num: 94
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 94 Append 2 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: K, client ID: 3106988376836154902, sequence num: 94, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: K, client ID: 3106988376836154902, sequence num: 94
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 94 Append 2 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 93 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 93 Append 2 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 212583169902968938: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 158 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 115 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 115 Append 4 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: j, client ID: 4217985405542925169, sequence num: 115, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 151
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 151 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 151 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 151, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 115 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 151 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 115, err: OK
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 648982299758451378: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 309167909479931851: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 115, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 151 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 158 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3713317916556342252: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3229947287046786038: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 109, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 94 Append 2 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: K, client ID: 3106988376836154902, sequence num: 94, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: e, client ID: 3106988376836154902, sequence num: 95
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 95 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: e, client ID: 3106988376836154902, sequence num: 95, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: e, client ID: 3106988376836154902, sequence num: 95
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 95 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: O, client ID: 4217985405542925169, sequence num: 116, err: OK
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 94 Append 2 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 94 Append 2 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 158 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 95 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: e, client ID: 3106988376836154902, sequence num: 95, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S101-1 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 95 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 95 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 5, client ID: 3507021557023121440, sequence num: 158, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 159
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 159 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 158 Append 1 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 152
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 152 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 151 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 9, client ID: 2199136536800998598, sequence num: 151, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: a, client ID: 2199136536800998598, sequence num: 152
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 152 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 151 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 159 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 159 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 152 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 152, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 152 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 152 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 151 Append 0 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 159 Append 1 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 152 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 152 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Z, client ID: 3507021557023121440, sequence num: 159, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 152 Append 0 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: a, client ID: 2199136536800998598, sequence num: 152, err: OK
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.isEligibleToUpdateShard: G101-1 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 109 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 116 Append 4 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.Kill() S100-0 is killed
2025/01/07 12:56:03 ShardKV.Kill() S100-1 is killed
2025/01/07 12:56:03 ShardKV.Kill() S100-2 is killed
2025/01/07 12:56:03 ShardKV.Kill() S101-0 is killed
2025/01/07 12:56:03 ShardKV.Kill() S101-1 is killed
2025/01/07 12:56:03 ShardKV.Kill() S101-2 is killed
2025/01/07 12:56:03 ShardKV.Kill() S102-0 is killed
2025/01/07 12:56:03 ShardKV.Kill() S102-1 is killed
2025/01/07 12:56:03 ShardKV.Kill() S102-2 is killed
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 110 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.StartServer(): S100-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:03 ShardKV.StartServer(): S100-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2909966720784803698: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.StartServer(): S100-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:03 ShardKV.StartServer(): S101-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrNotApplied
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.StartServer(): S101-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.StartServer(): S101-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.StartServer(): S102-0 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.StartServer(): S102-1 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1312646971709270939: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4288734927304626019: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.StartServer(): S102-2 is started, raft.state:false  !!!!!!
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3363603757311121680: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1702073072015726024: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:03 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116, err: ErrNotApplied
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrNotApplied
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S101-2 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S101-2 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:03 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:03 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 648982299758451378: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 950138385126478438: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardKV.ticker(): S100-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S100-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:03 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:03 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-0 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:03 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:03 ShardKV.migrator(): S101-0 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S100-2 is leader: false !
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S101-0 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S101-0 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S102-2 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.ticker(): S102-2 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.ticker(): S100-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S100-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:03 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:03 ShardKV.ticker(): S101-1 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S101-1 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S102-0 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.ticker(): S102-0 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S102-1 CN: 4 , RCN: -1 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:03 ShardKV.ticker(): S102-1 starts reconfiguring to nextConfig (NCN=5)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.ticker(): S101-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:03 ShardKV.ticker(): S101-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 0, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 709616447909096656: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:03 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:03 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:03 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:03 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:04 ShardKV.ticker(): S100-2 CN: 3 , RCN: -1 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.ticker(): S100-2 starts reconfiguring to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-1 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-1 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-2 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-2 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:1 CN:3 rejects Op due to state=NotServing (C=3929044425438857535 Id=116) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=96) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 129717324913002534: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 309167909479931851: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:3 CN:3 rejects Op due to state=NotServing (C=1769720748839593670 Id=110) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110, err: ErrWrongGroup
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 950138385126478438: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardKV.PutAppend: S101-1 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:04 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 is leader: false !
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):33
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 1, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 3663296650008350801: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:4 CN:3 rejects Op due to state=NotServing (C=1347532576216071615 Id=116) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2929555638292246715: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2034372674881477259: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: q, client ID: 501921243248122353, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 709616447909096656: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):33
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 31, OpType:Leave applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 950138385126478438: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 3794417654494489890: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 309167909479931851: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 129717324913002534: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):32
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [101] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [101] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 102
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):33
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):33
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: q, client ID: 501921243248122353, sequence num: 153, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 6, client ID: 3507021557023121440, sequence num: 160, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:0 CN:3 rejects Op due to state=NotServing (C=3106988376836154902 Id=96) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: F, client ID: 3929044425438857535, sequence num: 116, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 117 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 110 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 9, client ID: 4217985405542925169, sequence num: 117, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 118
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 118 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 160 Append 1 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 153 Append 9 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 117 Append 4 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 116 Append 3 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 154, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 154, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: n, client ID: 501921243248122353, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):34
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2574645115223561469: commandid: 32, OpType:Leave applied !!!
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 117 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 110 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 110, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: G, client ID: 1769720748839593670, sequence num: 111
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 111 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 117 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 110 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 118 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 117, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: G, client ID: 3929044425438857535, sequence num: 118
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 118 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):34
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: n, client ID: 501921243248122353, sequence num: 154, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: v, client ID: 2199136536800998598, sequence num: 153, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 117 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 110 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 118 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 153 Append 0 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 154 Append 9 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: _, client ID: 3507021557023121440, sequence num: 161, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 161 Append 1 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: remove specified groups: [102] from the configuration 
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: [102] succuss!!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 0 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 1 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 2 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 3 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 4 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 5 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 6 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 7 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 8 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Join: SN: 9 -> GID: 100
2025/01/07 12:56:04 MemoryConfigStateMachine.Leave: len(cf.Configs):34
2025/01/07 12:56:04 *****************************************
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 155 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 162 Append 1 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 155, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 156, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 156, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: p, client ID: 501921243248122353, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: i, client ID: 3507021557023121440, sequence num: 162, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154, err: ErrWrongLeader
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 950138385126478438: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 156 Append 9 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 163 Append 1 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: A, client ID: 3507021557023121440, sequence num: 163, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: p, client ID: 501921243248122353, sequence num: 156, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: O, client ID: 501921243248122353, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: O, client ID: 501921243248122353, sequence num: 157, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: O, client ID: 501921243248122353, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: O, client ID: 501921243248122353, sequence num: 157, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: O, client ID: 501921243248122353, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 154, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: O, client ID: 501921243248122353, sequence num: 157, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 154 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 164 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 118 Append 4 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 1, client ID: 4217985405542925169, sequence num: 118, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 157 Append 9 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: L, client ID: 4217985405542925169, sequence num: 119
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 119 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 164, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 111 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 118 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 119 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 111 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 118 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: G, client ID: 3929044425438857535, sequence num: 118, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: -, client ID: 3929044425438857535, sequence num: 119
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 119 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: G, client ID: 1769720748839593670, sequence num: 111, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: I, client ID: 1769720748839593670, sequence num: 112
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 112 Append 5 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 119 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: L, client ID: 4217985405542925169, sequence num: 119, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 120
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 120 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 111 Append 5 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 118 Append 3 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 5, client ID: 501921243248122353, sequence num: 158, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: A, client ID: 501921243248122353, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: A, client ID: 501921243248122353, sequence num: 159, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: A, client ID: 501921243248122353, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: A, client ID: 501921243248122353, sequence num: 159, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: A, client ID: 501921243248122353, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: p, client ID: 2199136536800998598, sequence num: 155, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 165, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 155 Append 0 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 158 Append 9 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 165 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 119 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 112 Append 5 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: I, client ID: 1769720748839593670, sequence num: 112, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 113
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 113 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 119 Append 4 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 119 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 112 Append 5 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: -, client ID: 3929044425438857535, sequence num: 119, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 120 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 120, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 119 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 120 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: _, client ID: 4217985405542925169, sequence num: 121
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 121 Append 4 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 112 Append 5 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 120 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 159 Append 9 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: N, client ID: 3929044425438857535, sequence num: 120
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 120 Append 3 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 113 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 156 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 113, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: W, client ID: 1769720748839593670, sequence num: 114
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 114 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 156, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 113 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 121 Append 4 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 120 Append 3 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: N, client ID: 3929044425438857535, sequence num: 120, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 121
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 121 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 113 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 121 Append 4 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 120 Append 3 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 166, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: _, client ID: 4217985405542925169, sequence num: 121, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 114 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: W, client ID: 1769720748839593670, sequence num: 114, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 121 Append 4 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 120 Append 3 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: A, client ID: 501921243248122353, sequence num: 159, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: U, client ID: 4217985405542925169, sequence num: 122
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 122 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 115
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 115 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 166 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 114 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 121 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 114 Append 5 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 121 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 121 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 121, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: V, client ID: 3929044425438857535, sequence num: 122
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 122 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 122 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 115 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 115, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 116 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 122 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 115 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 122 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: U, client ID: 4217985405542925169, sequence num: 122, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: k, client ID: 4217985405542925169, sequence num: 123
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 123 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 122 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: V, client ID: 3929044425438857535, sequence num: 122, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 123
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 123 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 122 Append 4 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 115 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 122 Append 3 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: U, client ID: 3507021557023121440, sequence num: 167, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 157, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 157 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 116 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 123 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: k, client ID: 4217985405542925169, sequence num: 123, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: H, client ID: 4217985405542925169, sequence num: 124
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 124 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 116, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 123 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 1, client ID: 3929044425438857535, sequence num: 123, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: e, client ID: 3929044425438857535, sequence num: 124
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 124 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 167 Append 1 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 117 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 124 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 124 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: e, client ID: 3929044425438857535, sequence num: 124, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 125
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 125 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: H, client ID: 4217985405542925169, sequence num: 124, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: F, client ID: 4217985405542925169, sequence num: 125
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 125 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 124 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 124 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 117 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 117, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 118
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 118 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 117 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 125 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 125 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 2, client ID: 3929044425438857535, sequence num: 125, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: F, client ID: 4217985405542925169, sequence num: 125, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 125 Append 3 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 125 Append 4 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 118 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 118, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: i, client ID: 1769720748839593670, sequence num: 119
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 119 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 118 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 116 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 123 Append 4 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: d, client ID: 4217985405542925169, sequence num: 126
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 123 Append 3 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 126 Append 4 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:04 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 124 Append 4 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: o, client ID: 3929044425438857535, sequence num: 126
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 126 Append 3 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 124 Append 3 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 119 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 119 Append 5 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 126 Append 4 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 126 Append 3 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 168 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 126 Append 4 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 126 Append 3 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 126 Append 4 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 126 Append 3 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 168, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: d, client ID: 4217985405542925169, sequence num: 126, err: OK
2025/01/07 12:56:04 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:04 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: o, client ID: 3929044425438857535, sequence num: 126, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: g, client ID: 4217985405542925169, sequence num: 127
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 127 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: f, client ID: 3929044425438857535, sequence num: 127
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 127 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: i, client ID: 1769720748839593670, sequence num: 119, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: x, client ID: 1769720748839593670, sequence num: 120
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 120 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 2, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 158 Append 0 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:04 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 950138385126478438: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 160 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 309167909479931851: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2479029951607754657: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:0 CN:4 rejects Op due to state=NotServing (C=3106988376836154902 Id=96) MovingIn: from group: 0, MovingOut: to group 0
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 1, client ID: 2199136536800998598, sequence num: 158, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 127 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 160, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: v, client ID: 501921243248122353, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 127 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 169 Append 1 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:04 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: Y, client ID: 3507021557023121440, sequence num: 169, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: g, client ID: 4217985405542925169, sequence num: 127, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 128
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 128 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 120 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 116, err: OK
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: -, client ID: 1347532576216071615, sequence num: 117
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 117 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 127 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 127 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: f, client ID: 3929044425438857535, sequence num: 127, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 120 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: x, client ID: 1769720748839593670, sequence num: 120, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 127 Append 4 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 127 Append 3 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 120 Append 5 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 116 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: U, client ID: 1769720748839593670, sequence num: 121
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 121 Append 5 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: c, client ID: 3929044425438857535, sequence num: 128
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 128 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: v, client ID: 501921243248122353, sequence num: 161, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: f, client ID: 501921243248122353, sequence num: 162
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 159, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: b, client ID: 3507021557023121440, sequence num: 170, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 159 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 161 Append 9 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 170 Append 1 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 128 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 117 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: -, client ID: 1347532576216071615, sequence num: 117, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 128 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 117 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 121 Append 5 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 128, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 128 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 128 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 129
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 129 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 117 Append 6 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 121 Append 5 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 121 Append 5 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 128 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 128 Append 3 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: c, client ID: 3929044425438857535, sequence num: 128, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: U, client ID: 1769720748839593670, sequence num: 121, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: M, client ID: 3929044425438857535, sequence num: 129
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 129 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: b, client ID: 1347532576216071615, sequence num: 118
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 118 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 122
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 122 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: n, client ID: 2199136536800998598, sequence num: 160, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: f, client ID: 501921243248122353, sequence num: 162, err: OK
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 163
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 171, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 163
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 163
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 162 Append 9 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 160 Append 0 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:04 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 171 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:04 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:04 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 129 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 129 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 129 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 118 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 122 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 129 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 129 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 118 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 122 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 129 Append 3 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: M, client ID: 3929044425438857535, sequence num: 129, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 129, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: v, client ID: 4217985405542925169, sequence num: 130
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 130 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: z, client ID: 3929044425438857535, sequence num: 130
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 130 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 118 Append 6 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 122 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: b, client ID: 1347532576216071615, sequence num: 118, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 119
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 119 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 122, err: OK
2025/01/07 12:56:04 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: V, client ID: 1769720748839593670, sequence num: 123
2025/01/07 12:56:04 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 123 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 161 Append 0 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 163 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 163, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: m, client ID: 2199136536800998598, sequence num: 161, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 172 Append 1 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: w, client ID: 3507021557023121440, sequence num: 172, err: OK
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:05 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 130 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 130 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 119 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 123 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 130 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 130 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: v, client ID: 4217985405542925169, sequence num: 130, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 131
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 131 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: z, client ID: 3929044425438857535, sequence num: 130, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: j, client ID: 3929044425438857535, sequence num: 131
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 131 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 119 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 123 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: V, client ID: 1769720748839593670, sequence num: 123, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: -, client ID: 1769720748839593670, sequence num: 124
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 124 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 119, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 120
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 120 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 130 Append 4 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 130 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 119 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 123 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 162, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: B, client ID: 3507021557023121440, sequence num: 173, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 131 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 2, client ID: 4217985405542925169, sequence num: 131, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: I, client ID: 4217985405542925169, sequence num: 132
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 132 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 131 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 131 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 124 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 120 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 131 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 124 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: -, client ID: 1769720748839593670, sequence num: 124, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: L, client ID: 1769720748839593670, sequence num: 125
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 125 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: j, client ID: 3929044425438857535, sequence num: 131, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 132
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 132 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 120 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 120, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 121
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 121 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 131 Append 4 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 131 Append 3 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 124 Append 5 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 120 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 173 Append 1 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 162 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 132 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 125 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 132 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 125 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 132 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 121 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: N, client ID: 3507021557023121440, sequence num: 174, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 164, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: C, client ID: 2199136536800998598, sequence num: 163, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 163 Append 0 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 164 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 174 Append 1 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 132 Append 4 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 125 Append 5 L {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 132 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 121 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 132 Append 3 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 4, client ID: 3929044425438857535, sequence num: 132, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: B, client ID: 3929044425438857535, sequence num: 133
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 133 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: L, client ID: 1769720748839593670, sequence num: 125, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: K, client ID: 1769720748839593670, sequence num: 126
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 126 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 121 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 121, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Z, client ID: 1347532576216071615, sequence num: 122
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 122 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: I, client ID: 4217985405542925169, sequence num: 132, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 133
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 133 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 3, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 950138385126478438: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 133 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 126 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 122 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 133 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 175 Append 1 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 133 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 164 Append 0 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 133 Append 3 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 126 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: K, client ID: 1769720748839593670, sequence num: 126, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 165, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 165 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 127
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 127 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: w, client ID: 501921243248122353, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: u, client ID: 2199136536800998598, sequence num: 164, err: OK
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 126 Append 5 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 122 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 133 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: B, client ID: 3929044425438857535, sequence num: 133, err: OK
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: R, client ID: 3929044425438857535, sequence num: 134
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 134 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:05 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:05 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: V, client ID: 3507021557023121440, sequence num: 175, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 127 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 134 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 127 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 134 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 122 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 133 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 166 Append 9 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 165 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 165, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Z, client ID: 1347532576216071615, sequence num: 122, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: d, client ID: 1347532576216071615, sequence num: 123
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 123 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 127 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 134 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: R, client ID: 3929044425438857535, sequence num: 134, err: OK
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: w, client ID: 501921243248122353, sequence num: 166, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 133, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 127, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: T, client ID: 1769720748839593670, sequence num: 128
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 128 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 123 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 123 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: d, client ID: 1347532576216071615, sequence num: 123, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 124
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 124 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 123 Append 6 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 128 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 124 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: R, client ID: 3929044425438857535, sequence num: 135
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 135 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 128 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 124 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: c, client ID: 4217985405542925169, sequence num: 134
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 134 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 128 Append 5 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 124 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 124, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 4, client ID: 3507021557023121440, sequence num: 176, err: OK
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: _, client ID: 1347532576216071615, sequence num: 125
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 125 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: T, client ID: 1769720748839593670, sequence num: 128, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 167, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 309167909479931851: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 1694491942776669845: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 950138385126478438: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 4, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 167 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 176 Append 1 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 166 Append 0 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: o, client ID: 3106988376836154902, sequence num: 96, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: F, client ID: 3106988376836154902, sequence num: 97
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 97 Append 2 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: A, client ID: 2199136536800998598, sequence num: 166, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 96 Append 2 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 129
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 129 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 135 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 134 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: c, client ID: 4217985405542925169, sequence num: 134, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 135 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 134 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 125 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 135 Append 3 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 134 Append 4 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 125 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: R, client ID: 3929044425438857535, sequence num: 135, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: -, client ID: 3929044425438857535, sequence num: 136
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 136 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 125 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: _, client ID: 1347532576216071615, sequence num: 125, err: OK
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 129 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 136 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: -, client ID: 3929044425438857535, sequence num: 136, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 137
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 137 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 129 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 129 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 129, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 136 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 97 Append 2 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: F, client ID: 3106988376836154902, sequence num: 97, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: b, client ID: 1769720748839593670, sequence num: 130
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 130 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 136 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: l, client ID: 4217985405542925169, sequence num: 135
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: s, client ID: 3106988376836154902, sequence num: 98
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 98 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 97 Append 2 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 167 Append 0 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 97 Append 2 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 135 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 126
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 126 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 168 Append 9 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: t, client ID: 2199136536800998598, sequence num: 167, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 177 Append 1 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: C, client ID: 3507021557023121440, sequence num: 177, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 4, client ID: 501921243248122353, sequence num: 168, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 169, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: u, client ID: 501921243248122353, sequence num: 170
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 137 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 130 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 137 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 135 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 130 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 126 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 135 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 178, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: u, client ID: 501921243248122353, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 137 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 130 Append 5 b {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: b, client ID: 1769720748839593670, sequence num: 130, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: l, client ID: 1769720748839593670, sequence num: 131
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 131 Append 5 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: P, client ID: 2199136536800998598, sequence num: 168, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: u, client ID: 501921243248122353, sequence num: 170
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: u, client ID: 501921243248122353, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: u, client ID: 501921243248122353, sequence num: 170
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 168 Append 0 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 169 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 178 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 98 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 137, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 135 Append 4 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 126 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 98 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Y, client ID: 1347532576216071615, sequence num: 126, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 126 Append 6 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: l, client ID: 4217985405542925169, sequence num: 135, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 98 Append 2 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: T, client ID: 3929044425438857535, sequence num: 138
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 138 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 136
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 136 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: s, client ID: 3106988376836154902, sequence num: 98, err: OK
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: e, client ID: 3106988376836154902, sequence num: 99
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 99 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: C, client ID: 1347532576216071615, sequence num: 127
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 127 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 99 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: e, client ID: 3106988376836154902, sequence num: 99, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: D, client ID: 3106988376836154902, sequence num: 100
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 100 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 99 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 99 Append 2 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 131 Append 5 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 138 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 136 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 131 Append 5 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 138 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 136 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 127 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 136, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 127 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: C, client ID: 1347532576216071615, sequence num: 127, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 128
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 128 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 131 Append 5 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 138 Append 3 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 136 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 127 Append 6 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: C, client ID: 4217985405542925169, sequence num: 137
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 137 Append 4 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: T, client ID: 3929044425438857535, sequence num: 138, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 139
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 170 Append 9 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 139 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: l, client ID: 1769720748839593670, sequence num: 131, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 169 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 179 Append 1 F {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: N, client ID: 1769720748839593670, sequence num: 132
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 132 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: F, client ID: 3507021557023121440, sequence num: 179, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 169, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 5, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 100 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 100 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 950138385126478438: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 100 Append 2 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: u, client ID: 501921243248122353, sequence num: 170, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: D, client ID: 3106988376836154902, sequence num: 100, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: l, client ID: 3106988376836154902, sequence num: 101
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 128 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 137 Append 4 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: C, client ID: 4217985405542925169, sequence num: 137, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 128 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 138
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 137 Append 4 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 138 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 101 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 139 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 132 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 139 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 132 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: N, client ID: 1769720748839593670, sequence num: 132, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 128, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 8, client ID: 3929044425438857535, sequence num: 139, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 128 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 137 Append 4 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 139 Append 3 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 132 Append 5 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: X, client ID: 3929044425438857535, sequence num: 140
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 140 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: O, client ID: 1347532576216071615, sequence num: 129
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 129 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: M, client ID: 1769720748839593670, sequence num: 133
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 133 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 101 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: l, client ID: 3106988376836154902, sequence num: 101, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: H, client ID: 3106988376836154902, sequence num: 102
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 102 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: o, client ID: 2199136536800998598, sequence num: 170, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 171, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 172
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 172
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 138 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 101 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: -, client ID: 501921243248122353, sequence num: 172
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 140 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 101 Append 2 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 180 Append 1 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: -, client ID: 3507021557023121440, sequence num: 180, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 170 Append 0 o {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 171 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 138 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 138 Append 4 8 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 140 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 140 Append 3 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 129 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 8, client ID: 4217985405542925169, sequence num: 138, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 133 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 129 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 133 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 139
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 139 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 129 Append 6 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 133 Append 5 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: M, client ID: 1769720748839593670, sequence num: 133, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: X, client ID: 3929044425438857535, sequence num: 140, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: j, client ID: 1769720748839593670, sequence num: 134
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 134 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 141
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 141 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: O, client ID: 1347532576216071615, sequence num: 129, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: n, client ID: 1347532576216071615, sequence num: 130
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 130 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 102 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: H, client ID: 3106988376836154902, sequence num: 102, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 103
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 103 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 102 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 102 Append 2 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 139 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 2, client ID: 2199136536800998598, sequence num: 171, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 134 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: j, client ID: 1769720748839593670, sequence num: 134, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 172 Append 9 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 171 Append 0 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 181 Append 1 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 135
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 139 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 135 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 134 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: g, client ID: 3507021557023121440, sequence num: 181, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 141 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 130 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 139 Append 4 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 134 Append 5 j {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 141 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 130 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 0, client ID: 4217985405542925169, sequence num: 139, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: -, client ID: 501921243248122353, sequence num: 172, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 141 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 130 Append 6 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 141, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: n, client ID: 3929044425438857535, sequence num: 142
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 142 Append 3 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: n, client ID: 1347532576216071615, sequence num: 130, err: OK
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: Z, client ID: 1347532576216071615, sequence num: 131
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 131 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: h, client ID: 4217985405542925169, sequence num: 140
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 140 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 172 Append 0 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 182 Append 1 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: T, client ID: 3507021557023121440, sequence num: 182, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 103 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 103 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 103 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: X, client ID: 2199136536800998598, sequence num: 172, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 135 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 142 Append 3 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 173 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 131 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 173, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 135 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 140 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 142 Append 3 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 103, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 135, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: C, client ID: 3106988376836154902, sequence num: 104
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 104 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: X, client ID: 1769720748839593670, sequence num: 136
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 136 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 131 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 140 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: n, client ID: 3929044425438857535, sequence num: 142, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: Z, client ID: 1347532576216071615, sequence num: 131, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: h, client ID: 4217985405542925169, sequence num: 140, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: U, client ID: 3929044425438857535, sequence num: 143
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 143 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: J, client ID: 4217985405542925169, sequence num: 141
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 141 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: g, client ID: 1347532576216071615, sequence num: 132
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 132 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 135 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 142 Append 3 n {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 131 Append 6 Z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 140 Append 4 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 173, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 104 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: C, client ID: 3106988376836154902, sequence num: 104, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: u, client ID: 3507021557023121440, sequence num: 183, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 104 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: c, client ID: 3106988376836154902, sequence num: 105
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 105 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 6, client ID: 501921243248122353, sequence num: 174, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 136 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 104 Append 2 C {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 143 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: U, client ID: 3929044425438857535, sequence num: 143, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: t, client ID: 3929044425438857535, sequence num: 144
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 144 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 141 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 132 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 183 Append 1 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 173 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 174 Append 9 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: X, client ID: 1769720748839593670, sequence num: 136, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: v, client ID: 1769720748839593670, sequence num: 137
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 137 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: J, client ID: 4217985405542925169, sequence num: 141, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 136 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 142
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 142 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: g, client ID: 1347532576216071615, sequence num: 132, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 143 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 136 Append 5 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: u, client ID: 1347532576216071615, sequence num: 133
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 133 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 6, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 950138385126478438: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:05 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 143 Append 3 U {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 141 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 141 Append 4 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: 9, client ID: 3507021557023121440, sequence num: 184, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 132 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: 0, client ID: 501921243248122353, sequence num: 175, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: -, client ID: 2199136536800998598, sequence num: 174, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 105 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: c, client ID: 3106988376836154902, sequence num: 105, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 7, client ID: 3106988376836154902, sequence num: 106
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 106 Append 2 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 105 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 144 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 137 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: v, client ID: 1769720748839593670, sequence num: 137, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 138
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 138 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 184 Append 1 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 174 Append 0 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 175 Append 9 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 144 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 137 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 142 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 133 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: t, client ID: 3929044425438857535, sequence num: 144, err: OK
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: y, client ID: 3929044425438857535, sequence num: 145
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 145 Append 3 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 142 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 133 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: u, client ID: 1347532576216071615, sequence num: 133, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 134
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 134 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 176, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 142, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 143
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 143 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 105 Append 2 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: X, client ID: 501921243248122353, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 132 Append 6 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 144 Append 3 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: Y, client ID: 2199136536800998598, sequence num: 175, err: OK
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:05 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:05 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:05 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 137 Append 5 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 142 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 106 Append 2 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 7, client ID: 3106988376836154902, sequence num: 106, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 6, client ID: 3106988376836154902, sequence num: 107
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 107 Append 2 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 106 Append 2 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 106 Append 2 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 138 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 145 Append 3 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 134 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 138 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 9, client ID: 1347532576216071615, sequence num: 134, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 145 Append 3 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: P, client ID: 1347532576216071615, sequence num: 135
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 134 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 143 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 135 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 107 Append 2 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Y, client ID: 1769720748839593670, sequence num: 138, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 107 Append 2 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 6, client ID: 3106988376836154902, sequence num: 107, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: P, client ID: 1769720748839593670, sequence num: 139
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: y, client ID: 3929044425438857535, sequence num: 145, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 108
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 108 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 143 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 5, client ID: 4217985405542925169, sequence num: 143, err: OK
2025/01/07 12:56:05 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 144
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 144 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 107 Append 2 6 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: u, client ID: 3929044425438857535, sequence num: 146
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 146 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 139 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 175 Append 0 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 176 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: X, client ID: 501921243248122353, sequence num: 177, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 185 Append 1 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 177 Append 9 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: K, client ID: 3507021557023121440, sequence num: 185, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: I, client ID: 501921243248122353, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: I, client ID: 501921243248122353, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 108 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 108 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 108 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 108, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186
2025/01/07 12:56:05 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 176 Append 0 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 309167909479931851: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 133 Append 6 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 138 Append 5 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 145 Append 3 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 134 Append 6 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 143 Append 4 5 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: e, client ID: 2199136536800998598, sequence num: 176, err: OK
2025/01/07 12:56:05 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:05 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:05 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:6 CN:3 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 135 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: O, client ID: 3106988376836154902, sequence num: 109
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 144 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: P, client ID: 1347532576216071615, sequence num: 135, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: a, client ID: 1347532576216071615, sequence num: 136
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 136 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 146 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 139 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: P, client ID: 1769720748839593670, sequence num: 139, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: _, client ID: 1769720748839593670, sequence num: 140
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 140 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 144, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: y, client ID: 4217985405542925169, sequence num: 145
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 145 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 109 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: u, client ID: 3929044425438857535, sequence num: 146, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: p, client ID: 3929044425438857535, sequence num: 147
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 147 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: I, client ID: 501921243248122353, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: I, client ID: 501921243248122353, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:05 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: I, client ID: 501921243248122353, sequence num: 178
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 135 Append 6 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 144 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 146 Append 3 u {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 139 Append 5 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:05 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:05 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 136 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 140 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: _, client ID: 1769720748839593670, sequence num: 140, err: OK
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: g, client ID: 1769720748839593670, sequence num: 141
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 141 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 136 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 140 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 145 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 147 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 136 Append 6 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 140 Append 5 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: a, client ID: 1347532576216071615, sequence num: 136, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 145 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 137
2025/01/07 12:56:05 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 137 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 109 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: O, client ID: 3106988376836154902, sequence num: 109, err: OK
2025/01/07 12:56:05 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 109 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 147 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 145 Append 4 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:05 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 147 Append 3 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 950138385126478438: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: X, client ID: 3507021557023121440, sequence num: 186, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 177, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: I, client ID: 501921243248122353, sequence num: 178, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: p, client ID: 3929044425438857535, sequence num: 147, err: OK
2025/01/07 12:56:06 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: E, client ID: 3106988376836154902, sequence num: 110
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 110 Append 2 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: W, client ID: 501921243248122353, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 177 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 186 Append 1 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 178 Append 9 I {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 7, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 109 Append 2 O {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: h, client ID: 3929044425438857535, sequence num: 148
2025/01/07 12:56:06 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 141 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 141 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 110 Append 2 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: E, client ID: 3106988376836154902, sequence num: 110, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 137 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 137 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 110 Append 2 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 110 Append 2 E {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: B, client ID: 3106988376836154902, sequence num: 111
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 111 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: y, client ID: 4217985405542925169, sequence num: 145, err: OK
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 148 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 146
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 146 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 3, client ID: 1347532576216071615, sequence num: 137, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: M, client ID: 1347532576216071615, sequence num: 138
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 138 Append 6 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: g, client ID: 1769720748839593670, sequence num: 141, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 142
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 142 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 148 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: h, client ID: 3929044425438857535, sequence num: 148, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 149
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 149 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 148 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 111 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: B, client ID: 3106988376836154902, sequence num: 111, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: V, client ID: 2199136536800998598, sequence num: 178, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: G, client ID: 3507021557023121440, sequence num: 187, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 111 Append 2 B {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: W, client ID: 501921243248122353, sequence num: 179, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 141 Append 5 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 137 Append 6 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 148 Append 3 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 146 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 138 Append 6 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: M, client ID: 1347532576216071615, sequence num: 138, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 139
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 139 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 146 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 138 Append 6 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 142 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 149 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 146 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 138 Append 6 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 142 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 149 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: P, client ID: 3106988376836154902, sequence num: 112
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 112 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 146, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: p, client ID: 4217985405542925169, sequence num: 147
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 147 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 142 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 149 Append 3 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: 0, client ID: 3929044425438857535, sequence num: 149, err: OK
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: q, client ID: 3929044425438857535, sequence num: 150
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 150 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 187 Append 1 G {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 178 Append 0 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 142, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 143
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 143 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: K, client ID: 501921243248122353, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 179 Append 9 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: K, client ID: 501921243248122353, sequence num: 180, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 181
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 181
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: p, client ID: 3507021557023121440, sequence num: 188, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 188 Append 1 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 139 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 139 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 147 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 150 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 180 Append 9 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 179 Append 0 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: q, client ID: 3929044425438857535, sequence num: 150, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 147 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 150 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 143 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 143 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 139 Append 6 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 147 Append 4 p {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 150 Append 3 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 143 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 950138385126478438: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 143, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: 1, client ID: 1347532576216071615, sequence num: 139, err: OK
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: X, client ID: 1347532576216071615, sequence num: 140
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 140 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 112 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: P, client ID: 3106988376836154902, sequence num: 112, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 112 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: A, client ID: 3106988376836154902, sequence num: 113
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 113 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 112 Append 2 P {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: p, client ID: 4217985405542925169, sequence num: 147, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: w, client ID: 1769720748839593670, sequence num: 144
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 144 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: V, client ID: 4217985405542925169, sequence num: 148
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 148 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 151
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 151 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: _, client ID: 2199136536800998598, sequence num: 179, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: R, client ID: 501921243248122353, sequence num: 181
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 8, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 140 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 144 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: w, client ID: 1769720748839593670, sequence num: 144, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 140 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 144 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 148 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 151 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: X, client ID: 1347532576216071615, sequence num: 140, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 148 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 151 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 7, client ID: 2199136536800998598, sequence num: 180, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: f, client ID: 3507021557023121440, sequence num: 189, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: R, client ID: 501921243248122353, sequence num: 181, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 151, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: V, client ID: 4217985405542925169, sequence num: 148, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: a, client ID: 1769720748839593670, sequence num: 145
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 145 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 189 Append 1 f {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 180 Append 0 7 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 181 Append 9 R {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 152
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 152 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: M, client ID: 4217985405542925169, sequence num: 149
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 149 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: y, client ID: 501921243248122353, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: h, client ID: 1347532576216071615, sequence num: 141
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 141 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 140 Append 6 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 144 Append 5 w {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 148 Append 4 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 151 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 113 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: A, client ID: 3106988376836154902, sequence num: 113, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: y, client ID: 3106988376836154902, sequence num: 114
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 114 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 145 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 152 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: Q, client ID: 3929044425438857535, sequence num: 152, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: k, client ID: 3929044425438857535, sequence num: 153
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 153 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 113 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: a, client ID: 1769720748839593670, sequence num: 145, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 149 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 145 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 141 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 145 Append 5 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: M, client ID: 4217985405542925169, sequence num: 149, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 152 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 149 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 141 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 114 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: y, client ID: 3106988376836154902, sequence num: 114, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: A, client ID: 3106988376836154902, sequence num: 115
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 115 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: M, client ID: 3507021557023121440, sequence num: 190, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 113 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 146
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 146 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: T, client ID: 2199136536800998598, sequence num: 181, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: h, client ID: 1347532576216071615, sequence num: 141, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 152 Append 3 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: J, client ID: 1347532576216071615, sequence num: 142
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 142 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 149 Append 4 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 181 Append 0 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 190 Append 1 M {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 182 Append 9 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: q, client ID: 4217985405542925169, sequence num: 150
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 150 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 114 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 115 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: y, client ID: 501921243248122353, sequence num: 182, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 114 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: a, client ID: 501921243248122353, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 115 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: A, client ID: 3106988376836154902, sequence num: 115, err: OK
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 153 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 146 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 142 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 115 Append 2 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: X, client ID: 3106988376836154902, sequence num: 116
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 116 Append 2 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 141 Append 6 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 153 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 153 Append 3 k {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 146 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 146 Append 5 9 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 142 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 116 Append 2 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: X, client ID: 3106988376836154902, sequence num: 116, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: Y, client ID: 3106988376836154902, sequence num: 117
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 117 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: h, client ID: 3507021557023121440, sequence num: 191, err: OK
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: a, client ID: 501921243248122353, sequence num: 183, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: d, client ID: 2199136536800998598, sequence num: 182, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 142 Append 6 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 150 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: q, client ID: 4217985405542925169, sequence num: 150, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: S, client ID: 4217985405542925169, sequence num: 151
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 151 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 183 Append 9 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 191 Append 1 h {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 182 Append 0 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 9, client ID: 1769720748839593670, sequence num: 146, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: V, client ID: 1769720748839593670, sequence num: 147
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 147 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 150 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 150 Append 4 q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: J, client ID: 1347532576216071615, sequence num: 142, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: y, client ID: 1347532576216071615, sequence num: 143
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 143 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 116 Append 2 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 116 Append 2 X {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: k, client ID: 3929044425438857535, sequence num: 153, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: m, client ID: 3929044425438857535, sequence num: 154
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 154 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: t, client ID: 501921243248122353, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 117 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: Y, client ID: 3106988376836154902, sequence num: 117, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: i, client ID: 3106988376836154902, sequence num: 118
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 118 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 117 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 117 Append 2 Y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 151 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 147 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 151 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 147 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 143 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 154 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 151 Append 4 S {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 147 Append 5 V {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 143 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 154 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 143 Append 6 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: y, client ID: 1347532576216071615, sequence num: 143, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: K, client ID: 1347532576216071615, sequence num: 144
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 118 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: i, client ID: 3106988376836154902, sequence num: 118, err: OK
2025/01/07 12:56:06 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 119
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 119 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 118 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: t, client ID: 501921243248122353, sequence num: 184, err: OK
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 144 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 154 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: m, client ID: 3929044425438857535, sequence num: 154, err: OK
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: H, client ID: 501921243248122353, sequence num: 185
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: H, client ID: 501921243248122353, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 119 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: H, client ID: 501921243248122353, sequence num: 185
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 2, client ID: 3106988376836154902, sequence num: 119, err: OK
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: H, client ID: 501921243248122353, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 118 Append 2 i {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 192 Append 1 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 184 Append 9 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 119 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: W, client ID: 3507021557023121440, sequence num: 192, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: H, client ID: 501921243248122353, sequence num: 185
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: x, client ID: 2199136536800998598, sequence num: 183, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 309167909479931851: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 183 Append 0 x {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: V, client ID: 1769720748839593670, sequence num: 147, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: 1, client ID: 1769720748839593670, sequence num: 148
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 119 Append 2 2 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 950138385126478438: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 9, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: 4, client ID: 3106988376836154902, sequence num: 120
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 120 Append 2 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 148 Append 5 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:06 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: g, client ID: 2199136536800998598, sequence num: 184, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: H, client ID: 501921243248122353, sequence num: 185, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 120 Append 2 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: 4, client ID: 3106988376836154902, sequence num: 120, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: T, client ID: 3106988376836154902, sequence num: 121
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 121 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 120 Append 2 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 120 Append 2 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: S101-0 SN:5 CN:3 rejects Op due to state=MovingIn (C=3166596512325037039 Id=17) MovingIn: from group: 100, MovingOut: to group 0
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: D, client ID: 3929044425438857535, sequence num: 155
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 155 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: S, client ID: 4217985405542925169, sequence num: 151, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: m, client ID: 4217985405542925169, sequence num: 152
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 152 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: S102-0 SN:6 CN:4 rejects Op due to state=MovingIn (C=1418637628418551783 Id=19) MovingIn: from group: 101, MovingOut: to group 0
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 144 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 148 Append 5 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 155 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 152 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 185 Append 9 H {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 184 Append 0 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 144 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 144 Append 6 K {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 148 Append 5 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 155 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 152 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 121 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 121 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 148 Append 5 1 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 155 Append 3 D {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 152 Append 4 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: K, client ID: 1347532576216071615, sequence num: 144, err: OK
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: s, client ID: 1347532576216071615, sequence num: 145
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 145 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: D, client ID: 3929044425438857535, sequence num: 155, err: OK
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: -, client ID: 3929044425438857535, sequence num: 156
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 156 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: m, client ID: 4217985405542925169, sequence num: 152, err: OK
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: W, client ID: 4217985405542925169, sequence num: 153
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 153 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: 1, client ID: 1769720748839593670, sequence num: 148, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: c, client ID: 1769720748839593670, sequence num: 149
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 149 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 121 Append 2 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: T, client ID: 3106988376836154902, sequence num: 121, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: a, client ID: 3106988376836154902, sequence num: 122
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 122 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: N, client ID: 501921243248122353, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 122 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 122 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: a, client ID: 3106988376836154902, sequence num: 122, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 145 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 156 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: -, client ID: 3929044425438857535, sequence num: 156, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: m, client ID: 3929044425438857535, sequence num: 157
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 157 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 145 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 156 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 153 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 149 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 122 Append 2 a {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: t, client ID: 3106988376836154902, sequence num: 123
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 123 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: s, client ID: 1347532576216071615, sequence num: 145, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 153 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 149 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: c, client ID: 1769720748839593670, sequence num: 149, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: W, client ID: 4217985405542925169, sequence num: 153, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 154
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 154 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 145 Append 6 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 156 Append 3 - {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 153 Append 4 W {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 149 Append 5 c {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: _, client ID: 1347532576216071615, sequence num: 146
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 146 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 150
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 150 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: J, client ID: 3507021557023121440, sequence num: 193, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 4, client ID: 2199136536800998598, sequence num: 185, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: N, client ID: 501921243248122353, sequence num: 186, err: OK
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 123 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: t, client ID: 3106988376836154902, sequence num: 123, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: y, client ID: 3106988376836154902, sequence num: 124
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 123 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 124 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 123 Append 2 t {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 124 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: y, client ID: 3106988376836154902, sequence num: 124, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: v, client ID: 3106988376836154902, sequence num: 125
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 125 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 193 Append 1 J {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 186 Append 9 N {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 124 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: s, client ID: 501921243248122353, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 124 Append 2 y {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 185 Append 0 4 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 157 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 154 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: 3, client ID: 4217985405542925169, sequence num: 154, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: m, client ID: 3929044425438857535, sequence num: 157, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 146 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 150 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: Q, client ID: 1769720748839593670, sequence num: 150, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: _, client ID: 1347532576216071615, sequence num: 146, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 4, value: A, client ID: 4217985405542925169, sequence num: 155
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{4217985405542925169 155 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 3, value: z, client ID: 3929044425438857535, sequence num: 158
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3929044425438857535 158 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 5, value: e, client ID: 1769720748839593670, sequence num: 151
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1769720748839593670 151 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append request: key: 6, value: T, client ID: 1347532576216071615, sequence num: 147
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{1347532576216071615 147 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 157 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 154 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 146 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 150 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: 0, client ID: 2199136536800998598, sequence num: 186, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: l, client ID: 3507021557023121440, sequence num: 194, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 194 Append 1 l {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 186 Append 0 0 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 125 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 125 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 125 Append 2 v {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: v, client ID: 3106988376836154902, sequence num: 125, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{3929044425438857535 157 Append 3 m {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{4217985405542925169 154 Append 4 3 {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 146 Append 6 _ {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S101-0 CN:3 Append request: key: 2, value: g, client ID: 3106988376836154902, sequence num: 126
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{3106988376836154902 126 Append 2 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 187 Append 9 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: s, client ID: 501921243248122353, sequence num: 187, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 0 waitUntilAppliedOrTimeout: op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 188, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 188, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 9, value: T, client ID: 501921243248122353, sequence num: 188
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 150 Append 5 Q {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 950138385126478438: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append request: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 1 waitUntilAppliedOrTimeout: op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S100-1 CN:3 Append reply: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195, err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{4217985405542925169 155 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{3929044425438857535 158 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{4217985405542925169 155 Append 4 A {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{3929044425438857535 158 Append 3 z {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1769720748839593670 151 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S102-2 applies client op: &{1347532576216071615 147 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1769720748839593670 151 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 ShardKV.engineStart(): S102-1 applies client op: &{1347532576216071615 147 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 4, value: A, client ID: 4217985405542925169, sequence num: 155, err: OK
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1769720748839593670 151 Append 5 e {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:06 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 10, OpType:Query applied !!!
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:06 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:06 ShardKV.PutAppend: S100-2 CN:3 Append request: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195
2025/01/07 12:56:06 ShardKV.waitUntilAppliedOrTimeout: Server 2 waitUntilAppliedOrTimeout: op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 5, value: e, client ID: 1769720748839593670, sequence num: 151, err: OK
2025/01/07 12:56:06 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:06 ShardKV.engineStart(): S102-0 applies client op: &{1347532576216071615 147 Append 6 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 6, value: T, client ID: 1347532576216071615, sequence num: 147, err: OK
2025/01/07 12:56:06 ShardKV.PutAppend: S102-0 CN:4 Append reply: key: 3, value: z, client ID: 3929044425438857535, sequence num: 158, err: OK
2025/01/07 12:56:06 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.engineStart(): S101-2 applies client op: &{3106988376836154902 126 Append 2 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.engineStart(): S101-0 applies client op: &{3106988376836154902 126 Append 2 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:06 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:06 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:06 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:06 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:06 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:06 ShardKV.engineStart(): S101-1 applies client op: &{3106988376836154902 126 Append 2 g {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:06 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.PutAppend: S101-0 CN:3 Append reply: key: 2, value: g, client ID: 3106988376836154902, sequence num: 126, err: OK
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.engineStart(): S100-2 applies client op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-2 applies client op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 9, value: T, client ID: 501921243248122353, sequence num: 188, err: OK
2025/01/07 12:56:07 ShardKV.engineStart(): S100-1 applies client op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-1 applies client op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-1 applies client op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-2 applies client op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 0, value: s, client ID: 2199136536800998598, sequence num: 187, err: OK
2025/01/07 12:56:07 ShardKV.PutAppend: S100-2 CN:3 Append reply: key: 1, value: d, client ID: 3507021557023121440, sequence num: 195, err: OK
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:07 ShardKV.engineStart(): S100-0 applies client op: &{2199136536800998598 187 Append 0 s {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-0 applies client op: &{501921243248122353 188 Append 9 T {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.engineStart(): S100-0 applies client op: &{3507021557023121440 195 Append 1 d {Num:0,Shards:[0 0 0 0 0 0 0 0 0 0],Groups:map[]} 0 0 map[] map[]}
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 950138385126478438: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:07 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 309167909479931851: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:07 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 11, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 950138385126478438: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 12, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 309167909479931851: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:07 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 950138385126478438: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:07 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:07 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:07 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 13, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:07 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 950138385126478438: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 14, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:07 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:07 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:07 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:07 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 950138385126478438: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:07 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:07 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:07 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:07 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:07 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:07 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 309167909479931851: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 15, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 950138385126478438: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:08 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 16, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 950138385126478438: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 17, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 950138385126478438: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 309167909479931851: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 18, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 950138385126478438: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:08 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:08 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:08 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 19, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:08 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 950138385126478438: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 309167909479931851: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:08 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:08 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:08 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:08 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:08 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:08 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:08 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:08 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:08 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:08 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 20, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 21, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 309167909479931851: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:09 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 22, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 23, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 309167909479931851: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 24, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 25, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:09 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:09 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:09 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 26, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 950138385126478438: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:09 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:09 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:09 ShardCtrler.applier: clerkid 309167909479931851: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:09 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:09 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:09 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:09 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:09 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:09 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:09 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 950138385126478438: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 27, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:10 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 950138385126478438: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 309167909479931851: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:10 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:10 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:10 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:10 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 28, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:10 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 950138385126478438: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 29, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:10 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:10 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:10 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:10 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:10 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:10 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:10 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:10 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:10 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 950138385126478438: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 30, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:10 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 309167909479931851: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:10 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:10 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:11 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:11 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:11 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 31, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 950138385126478438: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 309167909479931851: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:11 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 32, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 950138385126478438: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:11 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:11 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:11 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:11 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:11 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:11 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:11 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:11 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:11 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 33, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 950138385126478438: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:11 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:11 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:11 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 309167909479931851: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 950138385126478438: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:12 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:12 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 34, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:12 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 35, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 950138385126478438: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 36, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 950138385126478438: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 309167909479931851: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:12 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:12 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 950138385126478438: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:12 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 37, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:12 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:12 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:12 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 309167909479931851: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 38, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardCtrler.applier: clerkid 950138385126478438: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:12 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:12 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:12 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:12 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:12 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:12 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:12 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:12 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:13 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:13 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 39, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 950138385126478438: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:13 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:13 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 309167909479931851: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:13 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 950138385126478438: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:13 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 40, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 950138385126478438: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:13 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 41, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:13 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 309167909479931851: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:13 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:13 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:13 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:13 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 950138385126478438: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:13 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:13 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:13 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:13 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:13 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:13 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:13 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:13 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:13 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 42, OpType:Query applied !!!
2025/01/07 12:56:13 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:13 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 950138385126478438: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 43, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 950138385126478438: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 309167909479931851: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:14 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:14 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:14 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 950138385126478438: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 44, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 45, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 950138385126478438: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:14 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:14 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 309167909479931851: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:14 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:14 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:14 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 46, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:14 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:14 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:14 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:14 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:14 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:14 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 950138385126478438: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 47, OpType:Query applied !!!
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:14 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:14 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:14 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 309167909479931851: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:15 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:15 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 950138385126478438: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 48, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 950138385126478438: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 49, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:15 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 309167909479931851: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:15 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:15 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:15 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 950138385126478438: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 50, OpType:Query applied !!!
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:15 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:15 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:15 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:15 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:15 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:15 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:15 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:15 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:16 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 950138385126478438: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 309167909479931851: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:16 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 51, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 950138385126478438: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 309167909479931851: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 52, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 950138385126478438: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 950138385126478438: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 309167909479931851: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:16 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 53, OpType:Query applied !!!
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:16 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:16 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:16 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:16 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:16 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:16 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:16 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 950138385126478438: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:17 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:17 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:17 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 309167909479931851: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:17 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 54, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:17 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:17 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 950138385126478438: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:17 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:17 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 309167909479931851: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 950138385126478438: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 55, OpType:Query applied !!!
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:17 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:17 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:17 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:17 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:17 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:17 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:17 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:17 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:17 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:17 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:17 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:17 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:17 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 950138385126478438: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:18 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 950138385126478438: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 309167909479931851: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:18 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:18 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 56, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:18 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 950138385126478438: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 309167909479931851: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 57, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:18 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:18 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:18 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 65, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 950138385126478438: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 61, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:18 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:18 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 66, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:18 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:18 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:18 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:18 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 950138385126478438: commandid: 65, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:18 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:18 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:18 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:18 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 62, OpType:Query applied !!!
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 58, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:19 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:19 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 309167909479931851: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:19 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:19 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 950138385126478438: commandid: 66, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 65, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4301202469260886139: commandid: 67, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S101-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 2373344903785462391: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 2531728017954887139: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S102-0 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:19 ShardKV.ticker(): S101-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4581448034336950792: commandid: 63, OpType:Query applied !!!
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 2099545878162586440: commandid: 59, OpType:Query applied !!!
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 309167909479931851: commandid: 60, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19
2025/01/07 12:56:19 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:6 CN:3 rejects Op due to state=MovingOut (C=1418637628418551783 Id=19) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 8, value: n, client ID: 1418637628418551783, sequence num: 19, err: ErrWrongGroup
2025/01/07 12:56:19 ShardKV.ticker(): S100-1 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append request: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17
2025/01/07 12:56:19 ShardKV.waitUntilAppliedOrTimeout: S100-0 SN:5 CN:3 rejects Op due to state=MovingOut (C=3166596512325037039 Id=17) MovingIn: from group: 0, MovingOut: to group 101
2025/01/07 12:56:19 ShardKV.PutAppend: S100-0 CN:3 Append reply: key: 7, value: Q, client ID: 3166596512325037039, sequence num: 17, err: ErrWrongGroup
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:19 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 is leader: false !
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4048489057596664073: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 1372193025150224271: commandid: 64, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S100-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.ticker(): S101-2 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-2 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-2 is leader: true !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-2 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.migrator() S102-0 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-0 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-0 is leader: true !
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-0 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-0 is leader: false !
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-0 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-2 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-2 is leader: false !
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=5) to G101
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101 Servers([server-101-0 server-101-1 server-101-2])
2025/01/07 12:56:19 ShardKV.migrator() S100-1 CN:3 RCN:4 sends shard (SN=6) to G101
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S100-1 is leader: false !
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 950138385126478438: commandid: 67, OpType:Query applied !!!
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 4521633387143323372: commandid: 66, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S102-2 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:19 ShardKV.ticker(): S100-0 CN: 3 , RCN: 4 is going to reconfigure to nextConfig (NCN=4)
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=6) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.isEligibleToUpdateShard: G101-0 kv.reconfigureToConfigNum=4, args.reconfigureToConfigNum=4, kv.config.Num=3, isEligibleToUpdateShard=false
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-0 faild to InstallShard (RCN=4 SN=5) due to:ErrNotApplied
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=5) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-0 failed err: ErrNotApplied
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-1 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-0 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-0 is leader: true !
2025/01/07 12:56:19 ShardKV.migrator() S102-1 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-1 is leader: false !
2025/01/07 12:56:19 ShardKV.migrator() S102-2 CN:4 RCN:5 need receive shard (SN=6) from G101
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 CN: 4 is reconfiguring to config (RCN=5)
2025/01/07 12:56:19 ShardKV.migrator(): S102-2 is leader: false !
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-1 failed err: ErrWrongLeader
2025/01/07 12:56:19 ShardKV.InstallShard(): S101-2 rejects InstallShard due to not being the leader
2025/01/07 12:56:19 ShardKV.sendShard(): S100-1 CN: 3 sends shard (SN=6) to G101-server-101-2 failed err: ErrWrongLeader
2025/01/07 12:56:19 MemoryConfigStateMachine.Query: len(cf.Configs):34
2025/01/07 12:56:19 ShardCtrler.applier: clerkid 3421051394438066630: commandid: 65, OpType:Query applied !!!
2025/01/07 12:56:19 ShardKV.ticker(): S102-1 CN: 4 , RCN: 5 is going to reconfigure to nextConfig (NCN=5)
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=5) from G100
2025/01/07 12:56:19 ShardKV.migrator() S101-1 CN:3 RCN:4 need receive shard (SN=6) from G100
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 CN: 3 is reconfiguring to config (RCN=4)
2025/01/07 12:56:19 ShardKV.migrator(): S101-1 is leader: false !
panic: test timed out after 30s
	running tests:
		TestConcurrent3_5B (30s)

goroutine 44897 [running]:
testing.(*M).startAlarm.func1()
	/usr/local/go/src/testing/testing.go:2373 +0x385
created by time.goFunc
	/usr/local/go/src/time/sleep.go:215 +0x2d

goroutine 1 [chan receive]:
testing.(*T).Run(0xc0000b8b60, {0x691d9c?, 0x0?}, 0x6a8fe0)
	/usr/local/go/src/testing/testing.go:1751 +0x3ab
testing.runTests.func1(0xc0000b8b60)
	/usr/local/go/src/testing/testing.go:2168 +0x37
testing.tRunner(0xc0000b8b60, 0xc0000dfc70)
	/usr/local/go/src/testing/testing.go:1690 +0xf4
testing.runTests(0xc0000b03f0, {0x8793c0, 0xe, 0xe}, {0x471ad0?, 0x47173a?, 0x87e260?})
	/usr/local/go/src/testing/testing.go:2166 +0x43d
testing.(*M).Run(0xc0000ba140)
	/usr/local/go/src/testing/testing.go:2034 +0x64a
main.main()
	_testmain.go:71 +0x9b

goroutine 18 [chan receive]:
6.5840/shardkv.TestConcurrent3_5B(0xc0000b8d00)
	/home/ubuntu/my_6.5840/src/shardkv/test_test.go:604 +0x5dd
testing.tRunner(0xc0000b8d00, 0x6a8fe0)
	/usr/local/go/src/testing/testing.go:1690 +0xf4
created by testing.(*T).Run in goroutine 1
	/usr/local/go/src/testing/testing.go:1743 +0x390

goroutine 19 [select]:
6.5840/labrpc.MakeNetwork.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:160 +0xea
created by 6.5840/labrpc.MakeNetwork in goroutine 18
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:158 +0x196

goroutine 20 [sync.Mutex.Lock]:
sync.runtime_SemacquireMutex(0x0?, 0x30?, 0x477d32?)
	/usr/local/go/src/runtime/sema.go:95 +0x25
sync.(*Mutex).lockSlow(0xc000112120)
	/usr/local/go/src/sync/mutex.go:173 +0x15d
sync.(*Mutex).Lock(...)
	/usr/local/go/src/sync/mutex.go:92
6.5840/raft.(*Raft).ticker(0xc000112120)
	/home/ubuntu/my_6.5840/src/raft/raft.go:459 +0x5a
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 21 [sync.Mutex.Lock]:
sync.runtime_SemacquireMutex(0xc00003ef08?, 0xe0?, 0x475285?)
	/usr/local/go/src/runtime/sema.go:95 +0x25
sync.(*Mutex).lockSlow(0xc000112120)
	/usr/local/go/src/sync/mutex.go:173 +0x15d
sync.(*Mutex).Lock(0xc0000c36d0?)
	/usr/local/go/src/sync/mutex.go:92 +0x32
sync.(*Cond).Wait(0xc000112120?)
	/usr/local/go/src/sync/cond.go:72 +0x97
6.5840/raft.(*Raft).applyLog(0xc000112120)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 22 [chan receive]:
6.5840/shardctrler.(*ShardCtrler).applier(0xc0000c4240)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:70 +0x87
created by 6.5840/shardctrler.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:62 +0x28a

goroutine 23 [sync.Mutex.Lock]:
sync.runtime_SemacquireMutex(0x0?, 0x30?, 0x477d32?)
	/usr/local/go/src/runtime/sema.go:95 +0x25
sync.(*Mutex).lockSlow(0xc000112240)
	/usr/local/go/src/sync/mutex.go:173 +0x15d
sync.(*Mutex).Lock(...)
	/usr/local/go/src/sync/mutex.go:92
6.5840/raft.(*Raft).ticker(0xc000112240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:459 +0x5a
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 24 [sync.Mutex.Lock]:
sync.runtime_SemacquireMutex(0xc000038008?, 0xe0?, 0x475285?)
	/usr/local/go/src/runtime/sema.go:95 +0x25
sync.(*Mutex).lockSlow(0xc000112240)
	/usr/local/go/src/sync/mutex.go:173 +0x15d
sync.(*Mutex).Lock(0xc0000c3b90?)
	/usr/local/go/src/sync/mutex.go:92 +0x32
sync.(*Cond).Wait(0xc000112240?)
	/usr/local/go/src/sync/cond.go:72 +0x97
6.5840/raft.(*Raft).applyLog(0xc000112240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 25 [chan receive]:
6.5840/shardctrler.(*ShardCtrler).applier(0xc0000c46c0)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:70 +0x87
created by 6.5840/shardctrler.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:62 +0x28a

goroutine 26 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc000112360)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 27 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0000c3d50, 0x15a)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000112360?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000112360)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 28 [chan receive]:
6.5840/shardctrler.(*ShardCtrler).applier(0xc0000c4900)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:70 +0x87
created by 6.5840/shardctrler.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:62 +0x28a

goroutine 30 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0001125a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8084 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144a08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 12400 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002c39e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 36 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134190, 0x2b)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002bb3f0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0001126c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 37 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bd908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4721 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000564210, 0x1f)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002d7d40?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00038bd40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 42 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134350, 0x2c)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002bbd90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0001127e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 43 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bdb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24073 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc00056dc20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 48 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134510, 0xa)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000142e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000112a20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 49 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24075 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0005d8288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 8083 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000522f90, 0x2)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0003a5e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00038ad80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 54 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001346d0, 0xa)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00013de90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000112b40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 55 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4722 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24008 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc0006cd7a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 44900 [runnable]:
encoding/gob.(*Decoder).compileDec(0xc0002e4a20, 0x10, 0xc0001353c0)
	/usr/local/go/src/encoding/gob/decode.go:1152 +0x16a
encoding/gob.(*Decoder).getDecEnginePtr(0xc0002e4a20, 0x10, 0xc0001353c0)
	/usr/local/go/src/encoding/gob/decode.go:1192 +0x14a
encoding/gob.(*Decoder).decodeValue(0xc0002e4a20, 0x10, {0x64c560?, 0xc000014600?, 0xc0002e4a38?})
	/usr/local/go/src/encoding/gob/decode.go:1237 +0xfa
encoding/gob.(*Decoder).recvType(0xc0002e4a20, 0x40)
	/usr/local/go/src/encoding/gob/decoder.go:70 +0xf9
encoding/gob.(*Decoder).decodeTypeSequence(0xc0002e4a20, 0x0)
	/usr/local/go/src/encoding/gob/decoder.go:168 +0x76
encoding/gob.(*Decoder).DecodeValue(0xc0002e4a20, {0xc000135340?, 0xc000266f38?, 0xc000715b20?})
	/usr/local/go/src/encoding/gob/decoder.go:229 +0x168
encoding/gob.(*Decoder).Decode(0xc0002e4a20, {0xc000135340?, 0xc000266f38?})
	/usr/local/go/src/encoding/gob/decoder.go:206 +0x12f
6.5840/labgob.(*LabDecoder).Decode(0xc000715c88, {0xc000135340, 0xc000266f38})
	/home/ubuntu/my_6.5840/src/labgob/labgob.go:55 +0x4e
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc000132630}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000462700, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:505 +0x20c
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc000132630}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000462700, 0xc3, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44899
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 24077 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc0005d8288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 60 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134890, 0xa)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00014ee90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000112c60)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 61 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24011 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc000177188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 66 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134a50, 0x13)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000506580?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000112d80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 67 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144788)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44752 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0000e4460, {0x6922ac?, 0xc0005032c0?}, {0x6372c0, 0xc0001f1c80}, {0x63b540, 0xc0001ec2b8})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/raft.(*Raft).sendAppendEntries(...)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1026
6.5840/raft.(*Raft).sendEntries(0xc000112360, 0x0, 0xc0001f1c80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:721 +0xc8
created by 6.5840/raft.(*Raft).broadcastHeartBeat in goroutine 44681
	/home/ubuntu/my_6.5840/src/raft/raft.go:854 +0x105

goroutine 24010 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000177188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 72 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc000112ea0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8060 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000017408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44839 [runnable]:
6.5840/raft.(*Raft).sendEntries(0xc000112360, 0x0, 0xc0001ad940)
	/home/ubuntu/my_6.5840/src/raft/raft.go:720 +0x45
created by 6.5840/raft.(*Raft).broadcastHeartBeat in goroutine 26
	/home/ubuntu/my_6.5840/src/raft/raft.go:854 +0x105

goroutine 44769 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc00016a000, 0xc0006e67e0)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc0006dbb18?}, {0x68e34b, 0x4}, {0xc0006dbd20, 0x3, 0xc0006dbb48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc0001ec008?}, {0xc0006dbd20?, 0x688940?, 0xc000291c38?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc00077bab0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0006fc0e0, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc00077bab0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0006fc0e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44720
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 4727 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000565390, 0x1e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000268e70?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000236900)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 78 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc000112fc0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19779 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc000309c00, {0x692929?, 0xc0002b1270?}, {0x637040, 0xc0002b1270}, {0x64bb40, 0xc00036a460})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000438870, 0xc0002b1270)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc000145b88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24009 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003f3b10, 0x5e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0005ece90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006cd7a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14895 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44525 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc000c84830}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364460, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 24056 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc00037b908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 8071 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000471990, 0x2)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000209690?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0001297a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 2562 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0001ab1c0, {0x692929?, 0xc0004a75e0?}, {0x637040, 0xc0004a75e0}, {0x64bb40, 0xc0004f0150})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0003889c0, 0xc0004a75e0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*Clerk).PutAppend(0xc0004a0700, {0x698ef1, 0x1}, {0xc000358040, 0x1}, {0x68e667, 0x6})
	/home/ubuntu/my_6.5840/src/shardkv/client.go:134 +0x219
6.5840/shardkv.(*Clerk).Append(...)
	/home/ubuntu/my_6.5840/src/shardkv/client.go:142
6.5840/shardkv.TestConcurrent3_5B.func1(0x7, 0xc0004a0700)
	/home/ubuntu/my_6.5840/src/shardkv/test_test.go:572 +0x135
created by 6.5840/shardkv.TestConcurrent3_5B in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/test_test.go:579 +0x31b

goroutine 12370 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004c96d0, 0x6)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000397560?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000397560)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17148 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176c88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19791 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037a788)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9428 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bd688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4575 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001f0310, 0x1e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0005eee90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00038aa20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19802 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000776e90, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00061be90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00077e240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24057 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070d300, {0x692929?, 0xc000349ea0?}, {0x637040, 0xc000349ea0}, {0x64bb40, 0xc000696310})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000163770, 0xc000349ea0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037b908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 9326 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0006522d0, 0x17)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00067ce90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00026e000)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17223 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002c2b40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19766 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037b188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 17147 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004cfa10, 0xd)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002e3c30?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0009839e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24110 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc00056d440)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 8016 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016f08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4697 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 8113 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002378c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8066 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000017688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24104 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc00056cc60)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 4576 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000145908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 12371 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029ef08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19788 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0003c6400, {0x692929?, 0x13?}, {0x637040, 0xc0003e8af0}, {0x64bb40, 0xc0006973b0})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0001bc030, 0xc0003e8af0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037a008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24015 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0006d0f50, 0x5d)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0004afe90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006c4a20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 12376 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003f26d0, 0x7)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0005c6e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0003978c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4696 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001f1d50, 0x1d)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00038b440?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00038b440)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9364 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000653190, 0x18)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000676e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00026e5a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 2665 [sleep]:
time.Sleep(0x5f5e100)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*Clerk).PutAppend(0xc0004a0080, {0x698ef2, 0x1}, {0xc0003ebea8, 0x1}, {0x68e667, 0x6})
	/home/ubuntu/my_6.5840/src/shardkv/client.go:132 +0x1c5
6.5840/shardkv.(*Clerk).Append(...)
	/home/ubuntu/my_6.5840/src/shardkv/client.go:142
6.5840/shardkv.TestConcurrent3_5B.func1(0x8, 0xc0004a0080)
	/home/ubuntu/my_6.5840/src/shardkv/test_test.go:572 +0x135
created by 6.5840/shardkv.TestConcurrent3_5B in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/test_test.go:579 +0x31b

goroutine 24061 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc00037bb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 14907 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000014110, 0x14)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000416840?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000412d80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17141 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004cea90, 0xe)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00039ee70?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000412000)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24045 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000331d10, 0x56)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000632e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006c5b00)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9371 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029e508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4734 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016a08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 8053 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000252850, 0xb)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002c9e40?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0003b17a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24107 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc00029fb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 24053 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000330090, 0x5e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0008bee90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006c5440)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19796 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00070bc90, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000203e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006e1d40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19744 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000145b88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19743 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0006fe510, 0x26)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0005e9970?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006e06c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19809 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037af08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 14971 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 14894 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000522b10, 0x3)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000292690?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000383e60)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19812 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070d460, {0x692929?, 0xc0003e8640?}, {0x637040, 0xc0003e8640}, {0x64bb40, 0xc000697490})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000779140, 0xc0003e8640)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037af08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24106 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029fb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19889 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004ce390, 0x22)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0003b72c0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002ccc60)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14964 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000523a90, 0x3)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00028ee90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002366c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9362 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc000414f20, {0x692929?, 0xc0002dcff0?}, {0x637040, 0xc0002dcff0}, {0x64bb40, 0xc00036a2a0})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0000b2810, 0xc0002dcff0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00029e008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 14935 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0003b0d80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24049 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc000177408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 12394 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002c30e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17229 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002c2ea0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9330 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000392510, 0x1c)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00017a9c0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000383b00)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 44837 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc0000a5b20}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc00041c000, 0x33b, 0x400}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 24105 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000777650, 0x62)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000710e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00056cc60)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19806 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070cd80, {0x692929?, 0xc0003e81e0?}, {0x637040, 0xc0003e81e0}, {0x64bb40, 0xc000697420})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000778300, 0xc0003e81e0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037ac88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 8015 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001ad590, 0xe)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00017c160?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0003b0240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 12377 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029f188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9365 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029e288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9382 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000454a90, 0x17)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000302580?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000382120)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24101 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc00029f908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 19808 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000782090, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00061ae90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00077e5a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 12343 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016788)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44677 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc00045aa50, 0xc0006e6ee0)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc000887b18?}, {0x68e34b, 0x4}, {0xc000887d20, 0x3, 0xc000887b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc0001ecd60?}, {0xc000887d20?, 0x10?, 0x10?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc000987f20}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0003647e0, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc000987f20}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0003647e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44676
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 12382 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003f3690, 0x6)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0004dee90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000397d40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 19771 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000381290, 0x22)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0003b78c0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002cb8c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24108 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc00029fb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 24114 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc0005d8008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 24060 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037bb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9309 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bc008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9327 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029e008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19772 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037b408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44720 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc00077bab0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0006fc0e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 24047 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc00029f688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 44660 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc00045aaa0, 0xc0006e7650)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc00009bb18?}, {0x68e34b, 0x4}, {0xc00009bd20, 0x3, 0xc00009bb48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc0001ecec0?}, {0xc00009bd20?, 0x688940?, 0xc00013fc38?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc0007ed200}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d4e00, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc0007ed200}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d4e00, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44600
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 12386 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0003c70a0, {0x692929?, 0x13?}, {0x637040, 0xc000251bd0}, {0x64bb40, 0xc000b05e30})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000388fc0, 0xc000251bd0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00029f408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 14908 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bd408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9308 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000565250, 0x1e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0006a0cc0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0003830e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14965 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24058 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc0006c57a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 12359 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00033af90, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002d5760?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000982480)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8065 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004707d0, 0x2)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0003a9690?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000128360)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9383 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029ea08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 8059 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000253710, 0x2)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000371690?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0003b1c20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24076 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc0005d8288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 12388 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0002c27e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 12348 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004c8510, 0x12)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0004a6160?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000397200)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24063 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070dbe0, {0x692929?, 0xc000349d10?}, {0x637040, 0xc000349d10}, {0x64bb40, 0xc0004f0700})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc00020ee40, 0xc000349d10)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037bb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24109 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0001b73e0, {0x692929?, 0xc00045a460?}, {0x637040, 0xc00045a460}, {0x64bb40, 0xc0006e6b60})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0003cc2d0, 0xc00045a460)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00029fb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24111 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00034a650, 0x68)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000713e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00056d440)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 9331 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0000bd188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19765 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000380450, 0x23)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000580060?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002ca6c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24112 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc0005d8008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24048 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc00029f688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 24046 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029f688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44899 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc000132630}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000462700, 0xc3, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 9376 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003d4f10, 0x16)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0001e3ce0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00026efc0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24115 [sleep]:
time.Sleep(0x5f5e100)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).ticker(0xc0005d8008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:405 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 44675 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc00045aa00, 0xc0004f19d0)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc000219b18?}, {0x68e34b, 0x4}, {0xc000219d20, 0x3, 0xc000219b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc0001ecbb8?}, {0xc000219d20?, 0x10?, 0x10?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc000278470}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364700, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc000278470}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364700, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44674
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 15074 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176a08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4633 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000134fd0, 0x1c)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00038d130?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00046e240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24012 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc000177188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 24052 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc0006c5440)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 17218 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176f08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 14977 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000176788)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24102 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc00029f908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 9388 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000455c10, 0x16)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000303a20?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000383d40)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14929 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0004137a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4733 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000652590, 0x1e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002a2790?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000237680)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14970 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001f1050, 0x13)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000482370?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006cc360)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4634 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144f08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24013 [sleep]:
time.Sleep(0x5f5e100)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).ticker(0xc000177188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:405 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 19785 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037a008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4639 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003f2490, 0x1b)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00038c0b0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00046ed80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4640 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000145188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44831 [runnable]:
encoding/gob.(*encBuffer).WriteString(...)
	/usr/local/go/src/encoding/gob/encode.go:60
encoding/gob.(*Encoder).encodeInterface(0xc000232960, 0xc000232998, {0x6487e0?, 0xc0006f1970?, 0x5f0234?})
	/usr/local/go/src/encoding/gob/encode.go:409 +0x58b
encoding/gob.encOpFor.func5(0x668ba0?, 0xc000782240, {0x6487e0?, 0xc0006f1970?, 0x6f6fd8?})
	/usr/local/go/src/encoding/gob/encode.go:554 +0xcf
encoding/gob.(*Encoder).encodeStruct(0xc000232960, 0xc000232998, 0xc0000b11b8, {0x668ba0?, 0xc0006f1960?, 0x96?})
	/usr/local/go/src/encoding/gob/encode.go:328 +0x2be
encoding/gob.encOpFor.func4(0x63b640?, 0xc000782200, {0x668ba0?, 0xc0006f1960?, 0x0?})
	/usr/local/go/src/encoding/gob/encode.go:546 +0x6e
encoding/gob.(*Encoder).encodeArray(0xc000782180?, 0xc0003cdce0?, {0x63b640?, 0xc0003fa0c0?, 0x46d537?}, 0xc0003c16e0, 0x0, 0x5c9, 0x0)
	/usr/local/go/src/encoding/gob/encode.go:351 +0x4ba
encoding/gob.encOpFor.func1(0x63b640?, 0xc000782180, {0x63b640?, 0xc0003fa0c0?, 0xc0000b3ec0?})
	/usr/local/go/src/encoding/gob/encode.go:516 +0x139
encoding/gob.(*Encoder).encodeSingle(0xc0003d5ac0?, 0x0?, 0x6f6fd8?, {0x63b640?, 0xc0003fa0c0?, 0x407b0b?})
	/usr/local/go/src/encoding/gob/encode.go:301 +0x1f1
encoding/gob.(*Encoder).encode(0xc000232960, 0xc000232998, {0x63b640?, 0xc0003fa0c0?, 0xc0003d5ac0?}, 0xc0003d5ac0)
	/usr/local/go/src/encoding/gob/encode.go:668 +0x1c8
encoding/gob.(*Encoder).EncodeValue(0xc000232960, {0x63b640?, 0xc0003fa0c0?, 0x63b640?})
	/usr/local/go/src/encoding/gob/encoder.go:251 +0x405
encoding/gob.(*Encoder).Encode(0x63b640?, {0x63b640?, 0xc0003fa0c0?})
	/usr/local/go/src/encoding/gob/encoder.go:176 +0x74
6.5840/labgob.(*LabEncoder).Encode(0xc00033cda0, {0x63b640, 0xc0003fa0c0})
	/home/ubuntu/my_6.5840/src/labgob/labgob.go:34 +0x3f
6.5840/raft.(*Raft).persist(0xc000112120)
	/home/ubuntu/my_6.5840/src/raft/raft.go:170 +0xce
6.5840/raft.(*Raft).AppendEntries(0xc000112120, 0xc000471d80, 0xc0003ddf80)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1105 +0x4c5
reflect.Value.call({0xc0000e8500?, 0xc0000a65f0?, 0xc0006d7b18?}, {0x68e34b, 0x4}, {0xc0006d7d20, 0x3, 0xc0006d7b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e8500?, 0xc0000a65f0?, 0xc00033cba8?}, {0xc0006d7d20?, 0x10?, 0x10?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3980, {0x6922b1, 0xd}, {{0x63cea0, 0xc0000a5ae0}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc0000c0c00, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0990, {{0x63cea0, 0xc0000a5ae0}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc0000c0c00, 0x301, 0x400}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44830
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 19784 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0006ffc50, 0x24)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002fc630?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006e0ea0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24016 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000177408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 4661 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003f3650, 0x1b)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00038d080?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00046f560)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4662 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000145408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19800 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070c680, {0x692929?, 0xc0003e8370?}, {0x637040, 0xc0003e8370}, {0x64bb40, 0xc000838000})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0001f8f30, 0xc0003e8370)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037aa08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 4667 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001ac710, 0x1e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00046f9e0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00046f9e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 4668 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000145688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19893 [runnable]:
6.5840/shardctrler.(*Clerk).Command(0xc0007cae70, 0xc0002dde50)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:71 +0x6f
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037b688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24098 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc00056c240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 24103 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0001b6ba0, {0x692929?, 0xc00045aaf0?}, {0x637040, 0xc00045aaf0}, {0x64bb40, 0xc0006e6000})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000326de0, 0xc00045aaf0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00029f908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 19803 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037ac88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24044 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc0006c5b00)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 44600 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc0007ed200}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d4e00, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 14941 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00034d010, 0x3)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000125690?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0009827e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 15073 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00034ac90, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0001a5970?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002c3c20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14976 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003d4390, 0x11)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000303550?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006ccfc0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24100 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029f908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 12342 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001f0cd0, 0x11)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0004a62c0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000396a20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 24014 [sleep]:
time.Sleep(0x1c9c380)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/raft.(*Raft).ticker(0xc0006c4a20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:498 +0x26
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:556 +0x3c9

goroutine 44838 [runnable]:
encoding/gob.(*encoderState).update(0xc0001ad780?, 0xc000153cc8?)
	/usr/local/go/src/encoding/gob/encode.go:147 +0x23
encoding/gob.encInt(0x67c660?, 0xc0001ad780, {0x63d060?, 0xc000419940?, 0x7fb5cb12f548?})
	/usr/local/go/src/encoding/gob/encode.go:190 +0x85
encoding/gob.(*Encoder).encodeStruct(0xc0000babe0, 0xc00007cd80, 0xc0000b0fc0, {0x67c660?, 0xc000419900?, 0x637040?})
	/usr/local/go/src/encoding/gob/encode.go:328 +0x2be
encoding/gob.encOpFor.func4(0x67c660?, 0xc0001ad740, {0x67c660?, 0xc000419900?, 0xc000316c60?})
	/usr/local/go/src/encoding/gob/encode.go:546 +0x6e
encoding/gob.(*Encoder).encodeStruct(0xc0000babe0, 0xc00007cd80, 0xc000011b90, {0x655fc0?, 0xc000419900?, 0x407b0b?})
	/usr/local/go/src/encoding/gob/encode.go:328 +0x2be
encoding/gob.(*Encoder).encode(0xc0000babe0, 0xc00007cd80, {0x655fc0?, 0xc000419900?, 0xc0000c3680?}, 0xc0000c3680)
	/usr/local/go/src/encoding/gob/encode.go:666 +0x1a5
encoding/gob.(*Encoder).encodeInterface(0xc0000babe0, 0xc0000bac18, {0x6487e0?, 0xc000852770?, 0x5f0234?})
	/usr/local/go/src/encoding/gob/encode.go:419 +0x86b
encoding/gob.encOpFor.func5(0x668ba0?, 0xc0001ad640, {0x6487e0?, 0xc000852770?, 0x6f6fd8?})
	/usr/local/go/src/encoding/gob/encode.go:554 +0xcf
encoding/gob.(*Encoder).encodeStruct(0xc0000babe0, 0xc0000bac18, 0xc0000b11b8, {0x668ba0?, 0xc000852760?, 0x96?})
	/usr/local/go/src/encoding/gob/encode.go:328 +0x2be
encoding/gob.encOpFor.func4(0x63b640?, 0xc0001ad600, {0x668ba0?, 0xc000852760?, 0x0?})
	/usr/local/go/src/encoding/gob/encode.go:546 +0x6e
encoding/gob.(*Encoder).encodeArray(0xc0001ad540?, 0xc0003cdce0?, {0x63b640?, 0xc0002830c8?, 0x46d537?}, 0xc0003c16e0, 0x0, 0x5c9, 0x0)
	/usr/local/go/src/encoding/gob/encode.go:351 +0x4ba
encoding/gob.encOpFor.func1(0x63b640?, 0xc0001ad540, {0x63b640?, 0xc0002830c8?, 0xc0000b3ec0?})
	/usr/local/go/src/encoding/gob/encode.go:516 +0x139
encoding/gob.(*Encoder).encodeSingle(0xc0003d5ac0?, 0x0?, 0x6f6fd8?, {0x63b640?, 0xc0002830c8?, 0x407b0b?})
	/usr/local/go/src/encoding/gob/encode.go:301 +0x1f1
encoding/gob.(*Encoder).encode(0xc0000babe0, 0xc0000bac18, {0x63b640?, 0xc0002830c8?, 0xc0003d5ac0?}, 0xc0003d5ac0)
	/usr/local/go/src/encoding/gob/encode.go:668 +0x1c8
encoding/gob.(*Encoder).EncodeValue(0xc0000babe0, {0x63b640?, 0xc0002830c8?, 0x63b640?})
	/usr/local/go/src/encoding/gob/encoder.go:251 +0x405
encoding/gob.(*Encoder).Encode(0x63b640?, {0x63b640?, 0xc0002830c8?})
	/usr/local/go/src/encoding/gob/encoder.go:176 +0x74
6.5840/labgob.(*LabEncoder).Encode(0xc000368d50, {0x63b640, 0xc0002830c8})
	/home/ubuntu/my_6.5840/src/labgob/labgob.go:34 +0x3f
6.5840/raft.(*Raft).persist(0xc000112240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:170 +0xce
6.5840/raft.(*Raft).AppendEntries(0xc000112240, 0xc0001ad1c0, 0xc0003f98f0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1105 +0x4c5
reflect.Value.call({0xc0000e8500?, 0xc0000a67c0?, 0xc000317b18?}, {0x68e34b, 0x4}, {0xc000317d20, 0x3, 0xc000317b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e8500?, 0xc0000a67c0?, 0xc000368b40?}, {0xc000317d20?, 0x407ba5?, 0x4118d1?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3c40, {0x6922b1, 0xd}, {{0x63cea0, 0xc0000a5b20}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc00041c000, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b09d8, {{0x63cea0, 0xc0000a5b20}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc00041c000, 0x33b, 0x400}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44837
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 24059 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000330ed0, 0x56)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0006c57a0?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006c57a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 14942 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037a288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 17142 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029ec88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44526 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc00045a910, 0xc0000d9110)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc000193b18?}, {0x68e34b, 0x4}, {0xc000193d20, 0x3, 0xc000193b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc0001ec6f0?}, {0xc000193d20?, 0x688940?, 0xc000208c38?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc000c84830}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364460, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc000c84830}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364460, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44525
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 24062 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc00037bb88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 19890 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037b688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 7966 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000017908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24074 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00034b590, 0x5e)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000589e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00056dc20)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17217 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000392c90, 0xf)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002e3600?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002c26c0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8010 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000016c88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19797 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037aa08)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 12360 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000144c88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9377 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00029e788)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 9370 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0003d40d0, 0x18)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00042ce90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00026e900)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8009 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0001ac490, 0xc)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0002c9760?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000113560)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 8054 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000017188)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 19790 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc00070ab10, 0x24)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0005e9600?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0006e17a0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 44840 [runnable]:
6.5840/raft.(*Raft).sendEntries(0xc000112360, 0x1, 0xc0001ad980)
	/home/ubuntu/my_6.5840/src/raft/raft.go:720 +0x45
created by 6.5840/raft.(*Raft).broadcastHeartBeat in goroutine 26
	/home/ubuntu/my_6.5840/src/raft/raft.go:854 +0x105

goroutine 9320 [chan send]:
6.5840/raft.(*Raft).applyLog(0xc0004139e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1182 +0x405
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 44849 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0000e4480, {0x6922ac?, 0xc0007e93a0?}, {0x6372c0, 0xc0001f1cc0}, {0x63b540, 0xc000368b30})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/raft.(*Raft).sendAppendEntries(...)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1026
6.5840/raft.(*Raft).sendEntries(0xc000112360, 0x1, 0xc0001f1cc0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:721 +0xc8
created by 6.5840/raft.(*Raft).broadcastHeartBeat in goroutine 44681
	/home/ubuntu/my_6.5840/src/raft/raft.go:854 +0x105

goroutine 44730 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc0007ec8f0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d47e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 44674 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc000278470}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc000364700, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 24051 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00070cb20, {0x692929?, 0xc00045a640?}, {0x637040, 0xc00045a640}, {0x64bb40, 0xc0006e6d90})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0006c9e00, 0xc00045a640)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc000177408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24050 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).migrator(0xc000177408)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:463 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:359 +0x545

goroutine 17235 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0004c9c90, 0x15)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc0004bae90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002c3680)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17236 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000177688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24055 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc00037b908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 24054 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037b908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 17239 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc00049a9c0, {0x692929?, 0xc0002b01e0?}, {0x637040, 0xc0002b01e0}, {0x64bb40, 0xc0007dca80})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000341830, 0xc0002b01e0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc000177688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 17241 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000135210, 0x12)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000714e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000240120)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17242 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000177908)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 44898 [runnable]:
6.5840/labrpc.(*Network).processReq.func4()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:312
created by time.goFunc
	/usr/local/go/src/time/sleep.go:215 +0x2d

goroutine 17247 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc0000c3e50, 0x15)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00088be90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc0002407e0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17248 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc000177b88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 17251 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc000309360, {0x692929?, 0xc0003bee10?}, {0x637040, 0xc0003bee10}, {0x64bb40, 0xc000b05dc0})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc000479e90, 0xc0003bee10)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc000177b88)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 44816 [runnable]:
6.5840/labrpc.(*Network).processReq.func4()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:312
created by time.goFunc
	/usr/local/go/src/time/sleep.go:215 +0x2d

goroutine 17253 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000623110, 0x13)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc00050fe90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc000240ea0)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17254 [chan receive]:
6.5840/shardkv.(*ShardKV).engineStart(0xc00037a508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:575 +0x72
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:354 +0x4c8

goroutine 24099 [sync.Cond.Wait]:
sync.runtime_notifyListWait(0xc000776690, 0x55)
	/usr/local/go/src/runtime/sema.go:587 +0x159
sync.(*Cond).Wait(0xc000711e90?)
	/usr/local/go/src/sync/cond.go:71 +0x85
6.5840/raft.(*Raft).applyLog(0xc00056c240)
	/home/ubuntu/my_6.5840/src/raft/raft.go:1149 +0x1ad
created by 6.5840/raft.Make in goroutine 18
	/home/ubuntu/my_6.5840/src/raft/raft.go:558 +0x405

goroutine 17257 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc0007ee3e0, {0x692929?, 0xc0002ec410?}, {0x637040, 0xc0002ec410}, {0x64bb40, 0xc000b05ea0})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc00020eed0, 0xc0002ec410)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00037a508)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24097 [chan receive]:
6.5840/labrpc.(*ClientEnd).Call(0xc000474da0, {0x692929?, 0xc00045a5a0?}, {0x637040, 0xc00045a5a0}, {0x64bb40, 0xc0006e6d20})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:119 +0x226
6.5840/shardctrler.(*Clerk).Command(0xc0001ee1e0, 0xc00045a5a0)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:73 +0xc5
6.5840/shardctrler.(*Clerk).Query(...)
	/home/ubuntu/my_6.5840/src/shardctrler/client.go:60
6.5840/shardkv.(*ShardKV).ticker(0xc00029f688)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:388 +0xe9
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24078 [sleep]:
time.Sleep(0x5f5e100)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).ticker(0xc0005d8288)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:405 +0x31
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:361 +0x585

goroutine 24113 [sleep]:
time.Sleep(0xee6b280)
	/usr/local/go/src/runtime/time.go:300 +0xf2
6.5840/shardkv.(*ShardKV).noOpTicker(0xc0005d8008)
	/home/ubuntu/my_6.5840/src/shardkv/server.go:55 +0x30
created by 6.5840/shardkv.StartServer in goroutine 18
	/home/ubuntu/my_6.5840/src/shardkv/server.go:356 +0x505

goroutine 44731 [select]:
6.5840/shardctrler.(*ShardCtrler).Command(0xc0000c4900, 0xc000349ef0, 0xc000696bd0)
	/home/ubuntu/my_6.5840/src/shardctrler/server.go:160 +0x21c
reflect.Value.call({0xc0000e83c0?, 0xc0000a6820?, 0xc000559b18?}, {0x68e34b, 0x4}, {0xc000559d20, 0x3, 0xc000559b48?})
	/usr/local/go/src/reflect/value.go:581 +0xca6
reflect.Value.Call({0xc0000e83c0?, 0xc0000a6820?, 0xc00033cea8?}, {0xc000559d20?, 0x688940?, 0xc0004d7c38?})
	/usr/local/go/src/reflect/value.go:365 +0xb9
6.5840/labrpc.(*Service).dispatch(0xc0000c3d80, {0x692935, 0x7}, {{0x63cea0, 0xc0007ec8f0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d47e0, ...}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:514 +0x365
6.5840/labrpc.(*Server).dispatch(0xc0000b0a20, {{0x63cea0, 0xc0007ec8f0}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0005d47e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:438 +0x1e5
6.5840/labrpc.(*Network).processReq.func1()
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:247 +0x3f
created by 6.5840/labrpc.(*Network).processReq in goroutine 44730
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:246 +0x1d0

goroutine 44676 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc000987f20}, {0x692929, 0x13}, {0x6f6fd8, 0x637040}, {0xc0003647e0, 0xc4, 0xe0}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58

goroutine 44830 [select]:
6.5840/labrpc.(*Network).processReq(0xc0000e8320, {{0x63cea0, 0xc0000a5ae0}, {0x6922ac, 0x12}, {0x6f6fd8, 0x6372c0}, {0xc0000c0c00, 0x301, 0x400}, ...})
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:258 +0x3e8
created by 6.5840/labrpc.MakeNetwork.func1 in goroutine 19
	/home/ubuntu/my_6.5840/src/labrpc/labrpc.go:164 +0x58
exit status 2
FAIL	6.5840/shardkv	30.237s
